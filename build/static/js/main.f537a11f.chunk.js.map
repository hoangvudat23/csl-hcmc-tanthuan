{"version":3,"sources":["theme/GlobalStyles.js","theme/typography.js","theme/index.js","layouts/MainLayout/NavBar/NavItem.js","layouts/MainLayout/NavBar/index.js","layouts/MainLayout/TopBar.js","layouts/MainLayout/index.js","layouts/Page.js","views/Errors/NotFoundView.js","views/GridEditor/EditorMap/EditorBrush.js","redux/actions.js","views/GridEditor/EditorMap/EditorMap.js","views/GridEditor/EditorMenu/TypesEditor/index.js","views/GridEditor/EditorMenu/GridProps/GridMaker/gridCreator.js","views/GridEditor/EditorMenu/GridProps/GridMaker/index.js","views/GridEditor/EditorMenu/GridProps/CommitGrid/index.js","views/GridEditor/EditorMenu/GridProps/CenterMapButton/CenterMapButton.js","views/GridEditor/EditorMenu/GridProps/index.js","views/GridEditor/EditorMenu/index.js","views/GridEditor/index.js","views/CityScopeJS/CityIO/utils.js","views/CityScopeJS/CityIO/cityIO.js","views/CityIOviewer/CityIOdeckGLmap/legoio.png","views/CityIOviewer/CityIOdeckGLmap/SelectedTable/index.js","views/CityIOviewer/CityIOdeckGLmap/index.js","views/CityIOviewer/CityIOlist.js","views/CityIOviewer/SplashScreen/GetGITdate.js","views/CityIOviewer/SplashScreen/index.js","views/CityIOviewer/index.js","redux/initialState.js","views/CityScopeJS/CityIO/LoadingSpinner/index.js","redux/reducer.js","redux/store.js","utils/utils.js","views/CityScopeJS/MenuContainer/EditMenu/TypeInfo.js","views/CityScopeJS/MenuContainer/EditMenu/index.js","views/CityScopeJS/MenuContainer/TogglesMenu/ABMSubmenu/styles.js","views/CityScopeJS/MenuContainer/TogglesMenu/ABMSubmenu/ABMLegend.js","views/CityScopeJS/MenuContainer/TogglesMenu/ABMSubmenu/index.js","views/CityScopeJS/MenuContainer/TogglesMenu/ShadowSubmenu/styles.js","views/CityScopeJS/MenuContainer/TogglesMenu/ShadowSubmenu/index.js","views/CityScopeJS/MenuContainer/TogglesMenu/AccessSubmenu/index.js","views/CityScopeJS/MenuContainer/TogglesMenu/index.js","views/CityScopeJS/MenuContainer/ChooseScenario/index.js","views/CityScopeJS/MenuContainer/index.js","views/CityScopeJS/DeckglMap/components/PaintBrush/PaintBrush.js","views/CityScopeJS/DeckglMap/components/CellMeta.js","views/CityScopeJS/DeckglMap/components/PaintBrush/index.js","views/CityScopeJS/DeckglMap/components/AnimationComponent.js","views/CityScopeJS/DeckglMap/deckglLayers/AccessLayer.js","views/CityScopeJS/DeckglMap/deckglLayers/AggregatedTripsLayer.js","views/CityScopeJS/DeckglMap/deckglLayers/ABMLayer.js","views/CityScopeJS/DeckglMap/deckglLayers/GridLayer.js","views/CityScopeJS/DeckglMap/deckglLayers/TextualLayer.js","views/CityScopeJS/DeckglMap/deckglLayers/GeojsonLayer.js","views/CityScopeJS/DeckglMap/index.js","views/CityScopeJS/VisContainer/Radar/index.js","views/CityScopeJS/VisContainer/BarChart/index.js","views/CityScopeJS/VisContainer/AreaCalc/index.js","views/CityScopeJS/VisContainer/index.js","views/CityScopeJS/CSjsMain.js","views/CityScopeJS/index.js","views/ProjectionMapping/CityIO/index.js","views/ProjectionMapping/Keystone/PrjDeckGLMap/deckglLayers/AccessLayer.js","views/ProjectionMapping/Keystone/PrjDeckGLMap/deckglLayers/AggregatedTripsLayer.js","views/ProjectionMapping/Keystone/PrjDeckGLMap/deckglLayers/ABMLayer.js","views/ProjectionMapping/Keystone/PrjDeckGLMap/deckglLayers/GridLayer.js","views/ProjectionMapping/Keystone/PrjDeckGLMap/index.js","views/ProjectionMapping/Keystone/Components/util.ts","views/ProjectionMapping/Keystone/Components/anchor.tsx","views/ProjectionMapping/Keystone/Components/Keystoner.tsx","views/ProjectionMapping/Keystone/Components/deleteLocalStorage.js","views/ProjectionMapping/Keystone/index.js","Components/TableNameInput.js","views/ProjectionMapping/UIWebsocket/index.js","views/ProjectionMapping/index.js","views/CityScopeJS/VisContainer/index_custom.js","views/CityScopeJS/CSjsMainCustom.js","views/CityScopeJS/indexMapCenter.js","views/CityScopeJS/indexChartSidebar.js","views/CityScopeJS/indexOptionsMenu.js","routes.js","App.js","redux/Provider.js","index.js"],"names":["useStyles","makeStyles","createStyles","boxSizing","margin","padding","html","height","width","body","backgroundColor","a","textDecoration","GlobalStyles","typography","fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","h1","fontWeight","letterSpacing","h2","h3","h4","h5","h6","overline","theme","createMuiTheme","zIndex","appBar","palette","background","default","paper","dark","primary","main","light","secondary","text","colors","grey","shape","borderRadius","overrides","MuiListItem","root","boxShadow","button","MuiOutlinedInput","notchedOutline","borderColor","MuiAppBar","colorPrimary","color","MuiDivider","opacity","MuiCard","MuiButton","item","display","paddingTop","paddingBottom","justifyContent","textTransform","icon","marginRight","spacing","title","active","fontWeightBold","NavItem","className","href","Icon","rest","classes","ListItem","clsx","disableGutters","Button","activeClassName","component","RouterLink","to","size","items","MapIcon","BarChartIcon","FormatShapesIcon","mobileDrawer","top","NavBar","openNavDrawer","onMobileNavOpen","content","Box","flexDirection","p","List","map","style","onClick","flexGrow","Card","elevation","CardContent","position","Fab","Typography","align","variant","Date","getFullYear","Drawer","anchor","open","defaultProps","onMobileClose","TopBar","AppBar","Toolbar","IconButton","name","overflow","flex","MainLayout","useState","navMenuState","setNavMenuState","Page","forwardRef","ref","children","Helmet","image","marginTop","maxWidth","NotFoundView","Container","SelectionTarget","props","mousePos","selectedType","divSize","colorTrans","mouseX","clientX","mouseY","clientY","border","mouseDown","pointerEvents","left","GET_CITYIO_DATA","getCityioData","data","type","LISTEN_TO_MAP_EVENTS","LISTEN_TO_ABM_SLIDERS","listenToSlidersEvents","LISTEN_TO_ABM_MODE","LISTEN_TO_ACCESS_TOGGLE","MENU_INTERACTION","listenToMenuUI","LISTEN_TO_EDIT_MENU","listenToEditMenu","SET_READY_STATE","setReadyState","SET_LOADING_STATE","setLoadingState","SET_SCENARIO_NAMES","setScenarioNames","ADD_LOADING_MODULES","addLoadingModules","REMOVE_LOADING_MODULES","removeLoadingModules","SET_CURRENT_VIEW_OPTION","SET_UI_WEBSOCKET_DATA","SET_UI_WEBSOCKET_READY","LISTEN_TO_GRID_CREATOR","listenToGridCreator","LISTEN_TO_ROW_EDIT","listenToRowEdits","LISTEN_TO_TYPES_LIST","LISTEN_TO_BASE_MAP_CENTER","listenToBaseMapCenter","_hexToRgb","hex","result","exec","parseInt","settings","gridTransparent","BaseMap","_toggleOrthoView","viewState","orthographic","menu","includes","_onViewStateChange","setState","componentDidUpdate","prevProps","mapCenter","state","latitude","latCenter","longitude","lonCenter","pitch","bearing","_mulipleObjPicked","e","dim","pickingRadius","x","y","deckGL","pickObjects","_handleGridcellEditing","interactive","multiSelectedObj","forEach","selected","thisCellProps","object","properties","selectedCellsState","_renderSelectionTarget","_handleKeyUp","keyDownState","_handleKeyDown","nativeEvent","key","draggingWhileEditing","initialViewState","dirLightSettings","timestamp","UTC","intensity","_shadow","this","_rightClickViewRotate","_setViewStateToTableHeader","GEOGRID","header","zoom","document","getElementById","addEventListener","evt","preventDefault","layers","push","GeoJsonLayer","id","stroked","filled","wireframe","createdGrid","visible","pickable","extruded","lineWidthScale","lineWidthMinPixels","getElevation","d","getFillColor","event","cellInfo","rightButton","onDrag","onDragStart","onDragEnd","updateTriggers","transitions","scenarioGeojson","fill","getLineWidth","onKeyDown","onKeyUp","onMouseMove","onMouseUp","onMouseDown","deck","onViewStateChange","_renderLayers","controller","touchZoom","touchRotate","dragPan","dragRotate","keyboard","reuseMaps","mapboxApiAccessToken","process","mapStyle","sat","preventStyleDiffing","Component","mapDispatchToProps","connect","ROW_EDIT","BASE_MAP_CENTER","GRID_CREATED","TypesEditor","React","columns","field","lookup","No","Web","TUI","LanduseTypesList","typesArray","Object","keys","description","LBCS","JSON","stringify","NAICS","TypeCode","IDSColor","RGB","createtypesArray","types","dispatch","useDispatch","selectedRow","setSelectedRow","rowColor","setRowColor","useEffect","Grid","container","xs","s","m","l","xl","options","paging","search","selection","rowStyle","rowData","tableData","onRowClick","row","editable","onRowAdd","newData","Promise","resolve","setTimeout","prevState","onRowUpdate","oldData","indexOf","onRowDelete","console","log","splice","deg_to_rad","deg","Math","PI","rad_to_deg","rad","randomProperty","obj","length","random","gridCreator","gridProps","typesList","top_left_lon","parseFloat","top_left_lat","rotation","userPrj","projection","cell_size","cellSize","nrows","ncols","webMercator","proj4","defs","top_left_lon_lat","lon","lat","Ad","la1","lo1","bearing_rad","la2","asin","sin","cos","top_right_lon_lat","atan2","top_left_xy","top_right_xy","dydx","theta","atan","cosTheta","sinTheta","x_unRot","y_unRot","i","j","x_rot","y_rot","x_rot_trans","y_rot_trans","dxdCol","dydCol","dxdRow","dydRow","gridPnts","geojsonFeatureCollection","features","rndType","geojsonPolygon","geometry","coordinates","polygon_xy","polygon_ll","v","ll","scenario","find","el","rgbArr","split","stroke","geojson","convertScenarioToWGS84","GridMaker","reduxState","useSelector","grid","TYPES_LIST","handleGridCreation","startIcon","makeGEOGRIDobject","struct","geoJsonFeatures","GEOGRID_object","newTypesList","oldType","parse","CommitGrid","reqResonse","setReqResonse","hasGrid","postGridToCityIO","URL","DATA","GEOGRIDstruct","GEOGRIDDATA_object","element","makeGEOGRIDDATAobject","tableName","toLowerCase","table_url","globalSettings","cityIO","baseURL","new_table_grid","GEOGRIDDATA","axios","method","url","headers","Accept","then","response","cityscopeJSendpoint","status","Link","reqResonseUI","catch","error","dataStr","encodeURIComponent","downloadAnchorNode","createElement","setAttribute","appendChild","click","remove","downloadObjectAsJson","CenterMapButton","GridProps","borderWidth","flexWrap","projectName","tz","formValues","setformValues","handleChangeForm","target","value","noValidate","autoComplete","TextField","InputProps","onChange","textField","label","defaultValue","inputProps","max","min","helperText","EditorMenu","GridEditor","md","maxHeight","EditorMap","getScenarioIndices","get","res","scenarioIndices","filter","str","replace","promises","getScenarioName","all","r","err","getAPICall","CityIO","hashId","setHashId","hashes","setHashes","cityioURL","cityioData","CITYIO","update","newHashId","interval","newHashes","loadingModules","pickedModules","cityIOmodules","module","modules","modulesData","reduce","k","timer","clearTimeout","getModules","SelectedTable","clicked","tableURL","CityIOdeckGLmap","markerInfo","setMarkerInfo","setClicked","setZoom","INIT_VIEW","zHeight","viewport","setViewport","setInitialViewState","isHovering","markersArr","cityIOdata","table","index","RND_1","RND_2","tableHeader","coord","from","TileLayer","minZoom","maxZoom","tileSize","renderSubLayers","tile","bbox","west","south","east","north","BitmapLayer","_imageCoordinateSystem","COORDINATE_SYSTEM","CARTESIAN","bounds","LineLayer","getWidth","getSourcePosition","getTargetPosition","getColor","TextLayer","getPosition","getText","getSize","getAngle","getPixelOffset","getTextAnchor","getAlignmentBaseline","IconLayer","iconAtlas","transitionDuration","transitionInterpolator","FlyToInterpolator","iconMapping","marker","mask","getIcon","sizeScale","views","GlobeView","onHover","Boolean","getCursor","isDragging","onViewportChange","ContextProvider","_MapContext","Provider","CityIOlist","tableList","setTableList","isLoading","setIsLoading","fetchCityIOtables","cityIOlistURL","ListOfTables","tablesArr","requestArr","oldArray","toString","GetGITdate","author","branch","date","sha","link","gitMeta","setGitMeta","fetch","json","commit","divider","SplashScreen","Divider","gutterBottom","CityIOviewer","fixedPosition","LoadingSpinner","LOADING_MODULES","bottom","right","LinearProgress","listOfToggles","toggles","menuInitState","values","showOnInit","initialState","MENU","SCENARIO_NAMES","MAP","SLIDERS","time","ABM","startSimHour","currentSimHour","endSimHour","speed","animationSpeed","ABM_MODE","ACCESS_TOGGLE","SELECTED_TYPE","READY","LOADING","CURRENT_VIEW_OPTION","reducer","action","Set","UI_WEBSOCKET_DATA","UI_WEBSOCKET_READY","reduxDevTools","window","__REDUX_DEVTOOLS_EXTENSION__","store","createStore","rgbToHex","g","b","valToHex","c","hexToRgb","testHex","hexString","test","_proccessGridData","_proccessAccessData","accessData","heatmap","_postMapEditsToCityIO","endPoint","expectUpdateModules","val","expectUpdate","cityIOKeys","getState","has","setSelectedCellsState","deckGLRef","current","_multipleObjPicked","currentDateMidnight","setHours","_setupSunEffects","effectsRef","ambientLight","AmbientLight","dirLight","_SunLight","lightingEffect","LightingEffect","shadowColor","updateSunDirection","thisLocationTime","getTime","directionalLights","getMonth","getDay","getHours","getMinutes","getSeconds","TypeInfo","COLOR_SCALE","hoveredRadial","setHoveredRadial","typeInfo","attr","angle","proportion","use","careateData","colorType","animation","innerRadius","radialRadius","radius","getLabel","showLabels","onValueMouseOver","onSeriesMouseOut","padAngle","selectedIndex","setSelectedIndex","marks","parseTypeInfo","iconsArr","col","rgbCol","typeHasHeightProps","alignItems","typeProps","ListItemAvatar","Avatar","charAt","ListItemText","Collapse","in","Slider","valueLabelDisplay","getAriaLabel","createTypesIcons","marginLeft","subtitle1","subtitle2","ABMLegend","tripsAttr","trips","tripsData","modes","mode","profiles","profile","tripTypeValue","string","legendData","prepareLegendData","ABMSubmenu","sliders","settripTypeValue","FormControl","RadioGroup","aria-label","FormControlLabel","control","Radio","newValue","aria-labelledby","ShadowSubmenu","AccessSubmenu","accessToggle","ACCESS_PROPERTIES","access","startColor","endColor","startTitle","endTitle","ListItemSecondaryAction","Switch","edge","checked","TogglesMenu","handleToggle","menuState","togglesMeta","togglesCompsArray","loadedModules","requireModule","thisToggle","displayName","ABM2","ChooseScenario","chosenScenario","displayUI","loading","setLoading","autoChangeScenario","activeStep","setActiveStep","steps","Stepper","alternativeLabel","nonLinear","Step","StepButton","step","disabled","StepLabel","CircularProgress","MenuContainer","updatedMenuState","myMenuState","setChosenScenario","myChosenScenario","listenChangingOption","scenarioObject","option","PaintBrush","hoveredCells","isInteractiveCell","msg","CellMeta","hoveredObj","PaintBrushContainer","editOn","AnimationComponent","animationFrame","cancelAnimationFrame","_animate","rotateOn","ABMOn","updaters","sunEffects","setViewState","startHour","endHour","t","requestAnimationFrame","bind","AccessLayer","HeatmapLayer","colorRange","radiusPixels","threshold","getWeight","AggregatedTripsLayer","ABMmode","PathLayer","shadowEnabled","getPath","noisePath","path","ABMLayer","zoomLevel","TripsLayer","getTimestamps","timestamps","widthScale","rounded","trailLength","currentTime","GridLayer","setDraggingWhileEditing","setHoveredObj","TextualLayer","textLayerData","infoIteam","info","GeojsonLayer","getLineColor","Map","pitchMap","zoomMap","autoRotate","onlyMap","setKeyDownState","setMousePos","setMouseDown","setAccess","textualData","setTextualData","geojsonData","setGeojsonData","setGEOGRID","setABM","loaded","setLoaded","useRef","shadowsOn","resetViewOn","textual","dataProps","layersKey","AGGREGATED_TRIPS","GRID","ACCESS","TEXTUAL","GEOJSON","layerOrder","layer","effects","scrollZoom","asyncRender","radarSize","Radar","radarData","setRadarData","indicators","f","domains","viz_type","ref_value","domain","createRadarData","polygons","fillOpacity","strokeWidth","axes","labels","textAnchor","tickValues","Array","BarChart","barChartData","setBarChartData","hoveredNode","setHoveredNode","generateData","dataArr","alignContent","xType","stackBy","yDomain","tickLabelAngle","AreaCalc","areaData","setAreaData","geoGridData","calcAreaObj","gridCellData","typeName","LandUseTyp","typeCode","shapeArea","round","ShapeArea","hasOwnProperty","area","radialData","calcAreaForHCM","count","calcArea","labelsRadiusMultiplier","labelsStyle","font","textShadow","VisContainer","CSjsMain","direction","CityScopeJS","setTableName","isDone","setIsdone","location","pre","cityscopePrjName","substring","isReady","PrjDeckGLMap","viewSettings","localStorage","getItem","vs","setItem","solve","require","transformPointsToMatrix","sourcePoints","targetPoints","n","fromX","fromY","toX","toY","h","num","precision","factor","pow","tempNumber","matrixToTransform","matrix","join","vectorToTransform","vector","halfAnchor","styles","cursor","AnchorComponent","translation","onMouseEnter","transform","anchors","defaultMatrix","_setDeltaVal","deltaInitVals","Keystoner","layerTranslateDelta","anchorTranslateDelta","isAnchorDragging","anchorMoving","translateDelta","undefined","transformOrigin","containerTranslate","onAnchorMouseDown","stopPropagation","pageX","pageY","onAnchorMouseMove","vectorIndexToModify","deltaX","deltaY","onAnchorMouseUp","isEditMode","newVector","getBoundingClientRect","ls","removeEventListener","anchorStyle","anchorClassName","DeleteLocalStorage","justify","Keystone","editMode","setEditMode","removeItem","reload","TableNameInput","setSelectedTable","buttonsArr","cityIOtableBaseUrl","geogridUrl","UIWebsocket","socket","WebSocket","SOCKETS","onopen","send","onmessage","setUIWebsocketReady","setUIWebsocketData","isCityIOready","isSocketUIready","selectedTable","mt","CSjsMainCustom","onlyOptionMenu","mapAndChartSidebar","onlyChartSidebar","allowfullscreen","frameborder","scrolling","marginheight","marginwidth","src","CityScopeJSMapCenter","CityScopeJSChartSidebar","CityScopeJSOptionsMenu","routes","App","routing","useRoutes","ThemeProvider","ProviderWrapper","ReactDOM","render","basename"],"mappings":"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","file":"static/js/main.f537a11f.chunk.js","sourcesContent":["import { createStyles, makeStyles } from \"@material-ui/core\";\r\n\r\nconst useStyles = makeStyles(() =>\r\n    createStyles({\r\n        \"@global\": {\r\n            \"*\": {\r\n                boxSizing: \"border-box\",\r\n                margin: 0,\r\n                padding: 0,\r\n            },\r\n            html: {\r\n                \"-webkit-font-smoothing\": \"antialiased\",\r\n                \"-moz-osx-font-smoothing\": \"grayscale\",\r\n                height: \"100%\",\r\n                width: \"100%\",\r\n            },\r\n            body: {\r\n                backgroundColor: \"#18191a\",\r\n                height: \"100%\",\r\n                width: \"100%\",\r\n            },\r\n            a: {\r\n                textDecoration: \"none\",\r\n            },\r\n            \"#root\": {\r\n                height: \"100%\",\r\n                width: \"100%\",\r\n            },\r\n        },\r\n    })\r\n);\r\n\r\nconst GlobalStyles = () => {\r\n    useStyles();\r\n\r\n    return null;\r\n};\r\n\r\nexport default GlobalStyles;\r\n","const typography = {\r\n    fontFamily: `\"Roboto Mono\", sans-serif`,\r\n    fontSize: 12,\r\n    fontWeightLight: 100,\r\n    fontWeightRegular: 500,\r\n    fontWeightMedium: 700,\r\n\r\n    h1: {\r\n        fontWeight: 700,\r\n        fontSize: 45,\r\n        letterSpacing: \"-1px\",\r\n    },\r\n    h2: {\r\n        fontWeight: 800,\r\n        fontSize: 29,\r\n        letterSpacing: \"-0.24px\",\r\n    },\r\n    h3: {\r\n        fontWeight: 700,\r\n        fontSize: 24,\r\n        letterSpacing: \"-0.06px\",\r\n    },\r\n    h4: {\r\n        fontWeight: 500,\r\n        fontSize: 20,\r\n        letterSpacing: \"-0.06px\",\r\n    },\r\n    h5: {\r\n        fontWeight: 500,\r\n        fontSize: 16,\r\n        letterSpacing: \"-0.05px\",\r\n    },\r\n    h6: {\r\n        fontWeight: 500,\r\n        fontSize: 14,\r\n        letterSpacing: \"-0.05px\",\r\n    },\r\n    overline: {\r\n        fontWeight: 500,\r\n    },\r\n};\r\n\r\nexport default typography;\r\n","import { createMuiTheme, colors } from '@material-ui/core'\r\nimport typography from './typography'\r\n\r\nconst theme = createMuiTheme({\r\n  zIndex: {\r\n    appBar: 999,\r\n  },\r\n  palette: {\r\n    background: {\r\n      default: '#ff5278', //255, 82, 120\r\n      paper: '#18191a',\r\n      dark: '#ff5278',\r\n    },\r\n    primary: {\r\n      main: '#FFF',\r\n      light: '#ff5278',\r\n    },\r\n    secondary: {\r\n      main: '#ff5278',\r\n    },\r\n\r\n    text: {\r\n      primary: colors.grey[100],\r\n      secondary: '#ff5278',\r\n    },\r\n  },\r\n\r\n  typography,\r\n  shape: {\r\n    borderRadius: 20,\r\n  },\r\n\r\n  overrides: {\r\n    MuiListItem: {\r\n      root: {\r\n        '&$selected': {\r\n          backgroundColor: '#18191a',\r\n          boxShadow:\r\n            '12px 12px 16px 0 rgba(0,0,0),-8px -8px 12px 0 rgba(40,41,42)',\r\n          '&:hover': {\r\n            backgroundColor: '#ff5278',\r\n          },\r\n        },\r\n      },\r\n      button: {\r\n        '&:hover': {\r\n          backgroundColor: '#ff5278',\r\n        },\r\n      },\r\n    },\r\n\r\n    MuiOutlinedInput: {\r\n      notchedOutline: {\r\n        borderColor: '#ff5278',\r\n      },\r\n    },\r\n    MuiAppBar: {\r\n      colorPrimary: { backgroundColor: '#18191a', color: '#FFF' },\r\n    },\r\n    MuiDivider: {\r\n      root: {\r\n        backgroundColor: '#FFF',\r\n        opacity: 0.1,\r\n      },\r\n    },\r\n    MuiCard: {\r\n      root: {\r\n        boxShadow:\r\n          '12px 12px 16px 0 rgba(0,0,0),-8px -8px 12px 0 rgba(40,41,42)',\r\n      },\r\n    },\r\n    MuiButton: {\r\n      root: {\r\n        boxShadow:\r\n          '12px 12px 16px 0 rgba(0,0,0),-8px -8px 12px 0 rgba(40,41,42)',\r\n        '&:hover': {\r\n          boxShadow: '12px 12px 16px 0  #000,-2px -2px 16px 0  #ff5278',\r\n        },\r\n        // width: \"100%\",\r\n      },\r\n    },\r\n  },\r\n})\r\n\r\nexport default theme\r\n","import React from \"react\";\r\nimport { NavLink as RouterLink } from \"react-router-dom\";\r\nimport clsx from \"clsx\";\r\nimport PropTypes from \"prop-types\";\r\nimport { Button, ListItem, makeStyles } from \"@material-ui/core\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    item: {\r\n        display: \"flex\",\r\n        paddingTop: 0,\r\n        paddingBottom: 0,\r\n    },\r\n    button: {\r\n        color: theme.palette.text.main,\r\n        fontWeight: theme.typography.fontWeightMedium,\r\n        justifyContent: \"flex-start\",\r\n        letterSpacing: 0,\r\n        padding: \"10px 8px\",\r\n        textTransform: \"none\",\r\n        width: \"100%\",\r\n    },\r\n    icon: {\r\n        marginRight: theme.spacing(1),\r\n    },\r\n    title: {\r\n        marginRight: \"auto\",\r\n    },\r\n    active: {\r\n        color: theme.palette.text.secondary,\r\n        \"& $title\": {\r\n            fontWeight: theme.typography.fontWeightBold,\r\n        },\r\n        \"& $icon\": {\r\n            color: theme.palette.text.secondary,\r\n        },\r\n    },\r\n}));\r\n\r\nconst NavItem = ({ className, href, icon: Icon, title, ...rest }) => {\r\n    const classes = useStyles();\r\n\r\n    return (\r\n        <ListItem\r\n            className={clsx(classes.item, className)}\r\n            disableGutters\r\n            {...rest}\r\n        >\r\n            <Button\r\n                activeClassName={classes.active}\r\n                className={classes.button}\r\n                component={RouterLink}\r\n                to={href}\r\n            >\r\n                {Icon && <Icon className={classes.icon} size=\"20\" />}\r\n                <span className={classes.title}>{title}</span>\r\n            </Button>\r\n        </ListItem>\r\n    );\r\n};\r\n\r\nNavItem.propTypes = {\r\n    className: PropTypes.string,\r\n    href: PropTypes.string,\r\n    icon: PropTypes.elementType,\r\n    title: PropTypes.string,\r\n};\r\n\r\nexport default NavItem;\r\n","import PropTypes from 'prop-types'\r\nimport GitHubIcon from '@material-ui/icons/GitHub'\r\nimport FormatShapesIcon from '@material-ui/icons/FormatShapes'\r\nimport {\r\n  Box,\r\n  Drawer,\r\n  Fab,\r\n  List,\r\n  Typography,\r\n  makeStyles,\r\n  Card,\r\n  CardContent,\r\n} from '@material-ui/core'\r\nimport { BarChart as BarChartIcon, Map as MapIcon } from 'react-feather'\r\nimport NavItem from './NavItem'\r\n\r\nconst items = [\r\n  {\r\n    href: '/',\r\n    icon: MapIcon,\r\n    title: 'CityScopeJS',\r\n  },\r\n  {\r\n    href: '/editor',\r\n    icon: BarChartIcon,\r\n    title: 'Grid Editor',\r\n  },\r\n  {\r\n    href: '/projection',\r\n    icon: FormatShapesIcon,\r\n    title: 'Projection Mapping',\r\n  },\r\n]\r\n\r\nconst useStyles = makeStyles(() => ({\r\n  mobileDrawer: {\r\n    width: '30vw',\r\n    top: 48,\r\n    height: 'calc(100% - 48px)',\r\n    boxShadow: '22px 22px 22px 0 rgba(0,0,0)',\r\n  },\r\n}))\r\n\r\nconst NavBar = ({ openNavDrawer, onMobileNavOpen }) => {\r\n  const classes = useStyles()\r\n\r\n  const content = (\r\n    <Box height=\"100%\" display=\"flex\" flexDirection=\"column\" p={3}>\r\n      <List>\r\n        {items.map((item) => (\r\n          <NavItem\r\n            style={{ padding: '2vh' }}\r\n            href={item.href}\r\n            key={item.title}\r\n            title={item.title}\r\n            icon={item.icon}\r\n            onClick={onMobileNavOpen}\r\n          />\r\n        ))}\r\n      </List>\r\n\r\n      <Box flexGrow={1} />\r\n      <Card elevation={5} p={2}>\r\n        <CardContent position={'bottom'}>\r\n          <Fab\r\n            href=\"http://github.com/CityScope/CS_cityscopeJS/\"\r\n            color=\"default\"\r\n            size=\"small\"\r\n          >\r\n            <GitHubIcon />\r\n          </Fab>\r\n          <Box p={2} />\r\n          <Typography align=\"left\" variant=\"h5\">\r\n            MIT CityScope\r\n          </Typography>\r\n          <Typography align=\"left\" variant=\"caption\">\r\n            {new Date().getFullYear()}\r\n          </Typography>\r\n        </CardContent>\r\n      </Card>\r\n    </Box>\r\n  )\r\n\r\n  return (\r\n    <>\r\n      <Drawer\r\n        anchor=\"left\"\r\n        classes={{ paper: classes.mobileDrawer }}\r\n        open={openNavDrawer}\r\n        elevation={10}\r\n        variant=\"persistent\"\r\n      >\r\n        {content}\r\n      </Drawer>\r\n    </>\r\n  )\r\n}\r\n\r\nNavBar.propTypes = {\r\n  onMobileNavOpen: PropTypes.func,\r\n  openNavDrawer: PropTypes.bool,\r\n}\r\n\r\nNavBar.defaultProps = {\r\n  onMobileClose: () => {},\r\n  openNavDrawer: false,\r\n}\r\n\r\nexport default NavBar\r\n","import React from \"react\";\r\nimport { Link as RouterLink } from \"react-router-dom\";\r\nimport clsx from \"clsx\";\r\nimport PropTypes from \"prop-types\";\r\n\r\nimport {\r\n    AppBar,\r\n    IconButton,\r\n    Toolbar,\r\n    Typography,\r\n    makeStyles,\r\n} from \"@material-ui/core\";\r\nimport MenuIcon from \"@material-ui/icons/Menu\";\r\n\r\nconst useStyles = makeStyles(() => ({\r\n    root: {},\r\n}));\r\n\r\nconst TopBar = ({ className, onMobileNavOpen, ...rest }) => {\r\n    const classes = useStyles();\r\n\r\n    return (\r\n        <AppBar\r\n            className={clsx(classes.root, className)}\r\n            elevation={5}\r\n            {...rest}\r\n        >\r\n            <Toolbar variant=\"dense\">\r\n                <IconButton color=\"inherit\" onClick={onMobileNavOpen}>\r\n                    <MenuIcon />\r\n                </IconButton>\r\n                <RouterLink to=\"/\">\r\n                    <Typography\r\n                        className={classes.name}\r\n                        color=\"textPrimary\"\r\n                        variant=\"h5\"\r\n                    >\r\n                        MIT CityScope\r\n                    </Typography>\r\n                </RouterLink>\r\n            </Toolbar>\r\n        </AppBar>\r\n    );\r\n};\r\n\r\nTopBar.propTypes = {\r\n    className: PropTypes.string,\r\n    onMobileNavOpen: PropTypes.func,\r\n};\r\n\r\nexport default TopBar;\r\n","import React, { useState } from 'react'\r\nimport { Outlet } from 'react-router-dom'\r\nimport { makeStyles } from '@material-ui/core'\r\nimport NavBar from './NavBar'\r\nimport TopBar from './TopBar'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    backgroundColor: theme.palette.background,\r\n    display: 'flex',\r\n    height: '100%',\r\n    overflow: 'hidden',\r\n    width: '100%',\r\n  },\r\n\r\n  content: {\r\n    paddingTop: 48,\r\n    flex: '1 1 auto',\r\n    height: '100vh',\r\n    overflow: 'auto',\r\n  },\r\n}))\r\n\r\nconst MainLayout = () => {\r\n  const classes = useStyles()\r\n  const [navMenuState, setNavMenuState] = useState(true)\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <NavBar\r\n        openNavDrawer={!navMenuState}\r\n        onMobileNavOpen={() => setNavMenuState(!navMenuState)}\r\n      />\r\n      <TopBar onMobileNavOpen={() => setNavMenuState(!navMenuState)} />\r\n      <div className={classes.content}>\r\n        <Outlet />\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default MainLayout\r\n","import React, { forwardRef } from \"react\";\r\nimport { Helmet } from \"react-helmet\";\r\nimport PropTypes from \"prop-types\";\r\n\r\nconst Page = forwardRef(({ children, title = \"\", ...rest }, ref) => {\r\n    return (\r\n        <div ref={ref} {...rest}>\r\n            <Helmet>\r\n                <title>\r\n                    CityScopeJS {\">\"} {title}\r\n                </title>\r\n            </Helmet>\r\n            {children}\r\n        </div>\r\n    );\r\n});\r\n\r\nPage.propTypes = {\r\n    children: PropTypes.node.isRequired,\r\n    title: PropTypes.string,\r\n};\r\n\r\nexport default Page;\r\n","import React from \"react\";\r\nimport { Box, Container, Typography, makeStyles } from \"@material-ui/core\";\r\nimport Page from \"../../layouts/Page\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    backgroundColor: theme.palette.background,\r\n    height: \"100%\",\r\n    paddingBottom: theme.spacing(3),\r\n    paddingTop: theme.spacing(3),\r\n  },\r\n  image: {\r\n    marginTop: 50,\r\n    display: \"inline-block\",\r\n    maxWidth: \"100%\",\r\n    width: 560,\r\n  },\r\n}));\r\n\r\nconst NotFoundView = () => {\r\n  const classes = useStyles();\r\n\r\n  return (\r\n    <Page className={classes.root} title=\"404\">\r\n      <Box\r\n        display=\"flex\"\r\n        flexDirection=\"column\"\r\n        height=\"100%\"\r\n        justifyContent=\"center\"\r\n      >\r\n        <Container maxWidth=\"md\">\r\n          <Typography align=\"center\" color=\"textPrimary\" variant=\"h1\">\r\n            404\r\n          </Typography>\r\n          <Typography align=\"center\" color=\"textPrimary\" variant=\"h5\">\r\n            The page you are looking for isnt here\r\n          </Typography>\r\n        </Container>\r\n      </Box>\r\n    </Page>\r\n  );\r\n};\r\n\r\nexport default NotFoundView;\r\n","import React from \"react\";\r\n\r\n/**\r\n * cell selection\r\n * meta div\r\n * @param {*} props\r\n */\r\n\r\nexport default function SelectionTarget(props) {\r\n    if (!props.mousePos) return null;\r\n    const mousePos = props.mousePos;\r\n    const selectedType = props.selectedType;\r\n    const divSize = props.divSize;\r\n\r\n    const colorTrans =\r\n        \"rgba(\" +\r\n        selectedType.color[0] +\r\n        \",\" +\r\n        selectedType.color[1] +\r\n        \",\" +\r\n        selectedType.color[2] +\r\n        \",0.6)\";\r\n    let mouseX = mousePos.clientX - divSize / 2;\r\n    let mouseY = mousePos.clientY - divSize / 2;\r\n    return (\r\n        <div\r\n            style={{\r\n                border: \"2px solid\",\r\n                backgroundColor: props.mouseDown ? colorTrans : \"rgba(0,0,0,0)\",\r\n                borderColor: selectedType.color,\r\n                color: selectedType.color,\r\n                borderRadius: \"15%\",\r\n                position: \"fixed\",\r\n                zIndex: 1,\r\n                pointerEvents: \"none\",\r\n                width: divSize,\r\n                height: divSize,\r\n                left: mouseX,\r\n                top: mouseY,\r\n            }}\r\n        >\r\n            <div\r\n                style={{\r\n                    position: \"relative\",\r\n                    left: divSize + 10,\r\n                    fontSize: \"0.5em\",\r\n                }}\r\n            >\r\n                {selectedType.name}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","/**\r\n * CSjs ACTIONS\r\n */\r\nexport const GET_CITYIO_DATA = 'GET_CITYIO_DATA'\r\nexport function getCityioData(data) {\r\n  return { type: GET_CITYIO_DATA, data }\r\n}\r\n\r\nexport const LISTEN_TO_MAP_EVENTS = 'LISTEN_TO_MAP_EVENTS'\r\nexport function listenToMapEvents(data) {\r\n  return { type: LISTEN_TO_MAP_EVENTS, data }\r\n}\r\n\r\nexport const LISTEN_TO_ABM_SLIDERS = 'LISTEN_TO_ABM_SLIDERS'\r\nexport function listenToSlidersEvents(data) {\r\n  return { type: LISTEN_TO_ABM_SLIDERS, data }\r\n}\r\n\r\nexport const LISTEN_TO_ABM_MODE = 'LISTEN_TO_ABM_MODE'\r\nexport function listenToABMmode(data) {\r\n  return { type: LISTEN_TO_ABM_MODE, data }\r\n}\r\n\r\nexport const LISTEN_TO_ACCESS_TOGGLE = 'LISTEN_TO_ACCESS_TOGGLE'\r\nexport function listenToAccessToggle(data) {\r\n  return { type: LISTEN_TO_ACCESS_TOGGLE, data }\r\n}\r\n\r\nexport const MENU_INTERACTION = 'MENU_INTERACTION'\r\nexport function listenToMenuUI(data) {\r\n  return { type: MENU_INTERACTION, data }\r\n}\r\n\r\nexport const LISTEN_TO_EDIT_MENU = 'LISTEN_TO_EDIT_MENU'\r\nexport function listenToEditMenu(data) {\r\n  return { type: LISTEN_TO_EDIT_MENU, data }\r\n}\r\n\r\nexport const SET_READY_STATE = 'SET_READY_STATE'\r\nexport function setReadyState(data) {\r\n  return { type: SET_READY_STATE, data }\r\n}\r\n\r\nexport const SET_LOADING_STATE = 'SET_LOADING_STATE'\r\nexport function setLoadingState(data) {\r\n  return { type: SET_LOADING_STATE, data }\r\n}\r\n\r\nexport const SET_SCENARIO_NAMES = 'SET_SCENARIO_NAMES'\r\nexport function setScenarioNames(data) {\r\n  return { type: SET_SCENARIO_NAMES, data }\r\n}\r\n\r\nexport const ADD_LOADING_MODULES = 'ADD_LOADING_MODULES'\r\nexport function addLoadingModules(data) {\r\n  return { type: ADD_LOADING_MODULES, data }\r\n}\r\n\r\nexport const REMOVE_LOADING_MODULES = 'REMOVE_LOADING_MODULES'\r\nexport function removeLoadingModules(data) {\r\n  return { type: REMOVE_LOADING_MODULES, data }\r\n}\r\n\r\nexport const SET_CURRENT_VIEW_OPTION = 'SET_CURRENT_VIEW_OPTION'\r\nexport function setCurrentViewOption(data) {\r\n  return { type: SET_CURRENT_VIEW_OPTION, data }\r\n}\r\n\r\n/**\r\n * PROJECTION MAPPING Actions\r\n */\r\n\r\nexport const SET_UI_WEBSOCKET_DATA = 'SET_UI_WEBSOCKET_DATA'\r\nexport function setUIWebsocketData(data) {\r\n  return { type: SET_UI_WEBSOCKET_DATA, data }\r\n}\r\n\r\nexport const SET_UI_WEBSOCKET_READY = 'SET_UI_WEBSOCKET_READY'\r\nexport function setUIWebsocketReady(data) {\r\n  return { type: SET_UI_WEBSOCKET_READY, data }\r\n}\r\n\r\n/**\r\n * Editor Actions\r\n */\r\n\r\nexport const LISTEN_TO_GRID_CREATOR = 'LISTEN_TO_GRID_CREATOR'\r\nexport function listenToGridCreator(data) {\r\n  return { type: LISTEN_TO_GRID_CREATOR, data }\r\n}\r\n\r\nexport const LISTEN_TO_ROW_EDIT = 'LISTEN_TO_ROW_EDIT'\r\nexport function listenToRowEdits(data) {\r\n  return { type: LISTEN_TO_ROW_EDIT, data }\r\n}\r\n\r\nexport const LISTEN_TO_TYPES_LIST = 'LISTEN_TO_TYPES_LIST'\r\nexport function listeonToTypesList(data) {\r\n  return { type: LISTEN_TO_TYPES_LIST, data }\r\n}\r\n\r\nexport const LISTEN_TO_BASE_MAP_CENTER = 'LISTEN_TO_BASE_MAP_CENTER'\r\nexport function listenToBaseMapCenter(data) {\r\n  return { type: LISTEN_TO_BASE_MAP_CENTER, data }\r\n}\r\n","import React, { Component } from \"react\";\r\nimport EditorBrush from \"./EditorBrush\";\r\nimport { connect } from \"react-redux\";\r\nimport { StaticMap } from \"react-map-gl\";\r\nimport DeckGL from \"@deck.gl/react\";\r\nimport \"mapbox-gl/dist/mapbox-gl.css\";\r\nimport { GeoJsonLayer } from \"deck.gl\";\r\nimport settings from \"../../../settings/GridEditorSettings.json\";\r\nimport scenarioGeojson from \"../../../settings/LandUse_0_color.json\";\r\nimport { listenToBaseMapCenter } from \"../../../redux/actions\";\r\n\r\nexport const _hexToRgb = (hex) => {\r\n    var result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\r\n    return result\r\n        ? [\r\n            parseInt(result[1], 16),\r\n            parseInt(result[2], 16),\r\n            parseInt(result[3], 16),\r\n            settings.map.gridTransparent,\r\n        ]\r\n        : null;\r\n};\r\n\r\nclass BaseMap extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            selectedType: null,\r\n            draggingWhileEditing: false,\r\n            selectedCellsState: null,\r\n            pickingRadius: 40,\r\n            viewState: settings.map.initialViewState,\r\n        };\r\n\r\n        this.dirLightSettings = {\r\n            timestamp: Date.UTC(2019, 7, 1, 12),\r\n            color: [255, 255, 255],\r\n            intensity: 1.0,\r\n            _shadow: true,\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        // fix deck view rotate\r\n        this._rightClickViewRotate();\r\n\r\n        // zoom map on CS table location\r\n        this._setViewStateToTableHeader();\r\n    }\r\n\r\n    _toggleOrthoView = (viewState) => {\r\n        viewState.orthographic = this.props.menu.includes(\"RESET_VIEW\")\r\n            ? true\r\n            : false;\r\n    };\r\n\r\n    _onViewStateChange = ({ viewState }) => {\r\n        this.setState({ viewState });\r\n    };\r\n\r\n    componentDidUpdate = (prevProps) => {\r\n        if (this.props.mapCenter !== prevProps.mapCenter)\r\n            this.setState({\r\n                viewState: {\r\n                    ...this.state.viewState,\r\n                    latitude: this.props.mapCenter.latCenter,\r\n                    longitude: this.props.mapCenter.lonCenter,\r\n                    pitch: 0,\r\n                    bearing: 0,\r\n                    orthographic: false,\r\n                },\r\n            });\r\n    };\r\n\r\n    /**\r\n     * resets the camera viewport\r\n     * to cityIO header data\r\n     * https://github.com/uber/deck.gl/blob/master/test/apps/viewport-transitions-flyTo/src/app.js\r\n     */\r\n    _setViewStateToTableHeader() {\r\n        this.setState({\r\n            viewState: {\r\n                ...this.state.viewState,\r\n                latitude: settings.GEOGRID.properties.header.latitude,\r\n                longitude: settings.GEOGRID.properties.header.longitude,\r\n                zoom: 15,\r\n                pitch: 0,\r\n                bearing: 0,\r\n                orthographic: true,\r\n            },\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Description. fix deck issue\r\n     * with rotate right botton\r\n     */\r\n    _rightClickViewRotate() {\r\n        document\r\n            .getElementById(\"deckgl-wrapper\")\r\n            .addEventListener(\"contextmenu\", (evt) => evt.preventDefault());\r\n    }\r\n\r\n    /**\r\n     * Description. uses deck api to\r\n     * collect objects in a region\r\n     * @argument{object} e  picking event\r\n     */\r\n    _mulipleObjPicked = (e) => {\r\n        const dim = this.state.pickingRadius;\r\n        const x = e.x - dim / 2;\r\n        const y = e.y - dim / 2;\r\n        let mulipleObj = this.deckGL.pickObjects({\r\n            x: x,\r\n            y: y,\r\n            width: dim,\r\n            height: dim,\r\n        });\r\n        return mulipleObj;\r\n    };\r\n\r\n    /**\r\n     * Description. allow only to pick cells that are\r\n     *  not of CityScope TUI & that are interactable\r\n     * so to not overlap TUI activity\r\n     */\r\n    _handleGridcellEditing = (e) => {\r\n        if (!this.props.selectedType) return;\r\n        const { height, name, color, interactive } = this.props.selectedType;\r\n        const multiSelectedObj = this._mulipleObjPicked(e);\r\n\r\n        multiSelectedObj.forEach((selected) => {\r\n            let thisCellProps = selected.object.properties;\r\n            thisCellProps.color = _hexToRgb(color);\r\n            thisCellProps.height = parseInt(height);\r\n            thisCellProps.name = name;\r\n            if (interactive !== \"No\") {\r\n                thisCellProps.interactive = interactive;\r\n            } else {\r\n                delete thisCellProps.interactive;\r\n            }\r\n        });\r\n        this.setState({\r\n            selectedCellsState: multiSelectedObj,\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Description.\r\n     * draw target area around mouse\r\n     */\r\n    _renderSelectionTarget = () => {\r\n        return (\r\n            this.props.selectedType && (\r\n                <EditorBrush\r\n                    mousePos={this.state.mousePos}\r\n                    selectedType={this.props.selectedType}\r\n                    divSize={this.state.pickingRadius}\r\n                    mouseDown={this.state.mouseDown}\r\n                />\r\n            )\r\n        );\r\n    };\r\n\r\n    _handleKeyUp = () => {\r\n        this.setState({ keyDownState: null });\r\n    };\r\n\r\n    _handleKeyDown = (e) => {\r\n        // avoid common clicks\r\n        this.setState({ keyDownState: e.nativeEvent.key });\r\n    };\r\n\r\n    /**\r\n     * renders deck gl layers\r\n     */\r\n    _renderLayers() {\r\n        let layers = [];\r\n        layers.push(\r\n            new GeoJsonLayer({\r\n                id: \"GRID\",\r\n                opacity: 0.5,\r\n                stroked: false,\r\n                filled: true,\r\n                wireframe: true,\r\n                data: this.props.createdGrid,\r\n                visible: true,\r\n                pickable: true,\r\n                extruded: true,\r\n                lineWidthScale: 1,\r\n                lineWidthMinPixels: 1,\r\n                getElevation: (d) => d.properties.height,\r\n                getFillColor: (d) => d.properties.color,\r\n\r\n                onClick: (event, cellInfo) => {\r\n                    if (\r\n                        !cellInfo.rightButton &&\r\n                        this.state.keyDownState !== \"Shift\"\r\n                    )\r\n                        this._handleGridcellEditing(event);\r\n                },\r\n\r\n                onDrag: (event, cellInfo) => {\r\n                    if (\r\n                        !cellInfo.rightButton &&\r\n                        this.state.keyDownState !== \"Shift\"\r\n                    )\r\n                        this._handleGridcellEditing(event);\r\n                },\r\n                onDragStart: (event, cellInfo) => {\r\n                    if (\r\n                        !cellInfo.rightButton &&\r\n                        this.state.keyDownState !== \"Shift\"\r\n                    ) {\r\n                        this.setState({ draggingWhileEditing: true });\r\n                    }\r\n                },\r\n                onDragEnd: () => {\r\n                    this.setState({ draggingWhileEditing: false });\r\n                },\r\n                updateTriggers: {\r\n                    getFillColor: this.state.selectedCellsState,\r\n                    getElevation: this.state.selectedCellsState,\r\n                },\r\n                transitions: {\r\n                    getFillColor: 500,\r\n                    getElevation: 500,\r\n                },\r\n            })\r\n        );\r\n\r\n        layers.push(\r\n            new GeoJsonLayer({\r\n                id: 'scenario-geojson-layer',\r\n                data: scenarioGeojson,\r\n                opacity: 1,\r\n                pickable: false,\r\n                stroked: true,\r\n                filled: true,\r\n                extruded: false,\r\n                // lineWidthScale: 2,\r\n                // lineWidthMinPixels: 2,\r\n                getFillColor: d => _hexToRgb(d.properties.fill),\r\n                getLineWidth: 0.5,\r\n                // getFillColor: [163, 155, 8, 200],\r\n                // getLineColor: d => colorToRGBArray(d.properties.color),\r\n                // getRadius: 100,\r\n                // getLineWidth: 2,\r\n                // getElevation: 30\r\n            })\r\n        )\r\n\r\n        return layers;\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div\r\n                className=\"baseMap\"\r\n                onKeyDown={this._handleKeyDown}\r\n                onKeyUp={this._handleKeyUp}\r\n                onMouseMove={(e) =>\r\n                    this.setState({\r\n                        mousePos: e.nativeEvent,\r\n                    })\r\n                }\r\n                onMouseUp={() =>\r\n                    this.setState({\r\n                        mouseDown: false,\r\n                    })\r\n                }\r\n                onMouseDown={() =>\r\n                    this.setState({\r\n                        mouseDown: true,\r\n                    })\r\n                }\r\n            >\r\n                {this._renderSelectionTarget()}\r\n\r\n                <DeckGL\r\n                    // sets the cursor on paint\r\n                    // getCursor={() => \"none\"}\r\n                    ref={(ref) => {\r\n                        // save a reference to the Deck instance\r\n                        this.deckGL = ref && ref.deck;\r\n                    }}\r\n                    viewState={this.state.viewState}\r\n                    onViewStateChange={this._onViewStateChange}\r\n                    layers={this._renderLayers()}\r\n                    controller={{\r\n                        touchZoom: true,\r\n                        touchRotate: true,\r\n                        dragPan: !this.state.draggingWhileEditing,\r\n                        dragRotate: !this.state.draggingWhileEditing,\r\n                        keyboard: false,\r\n                    }}\r\n                >\r\n                    <StaticMap\r\n                        dragRotate={true}\r\n                        reuseMaps={true}\r\n                        mapboxApiAccessToken={\r\n                            process.env.REACT_APP_MAPBOX_TOKEN\r\n                        }\r\n                        mapStyle={settings.map.mapStyle.sat}\r\n                        preventStyleDiffing={true}\r\n                    />\r\n                </DeckGL>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nconst mapDispatchToProps = {\r\n    listenToBaseMapCenter: listenToBaseMapCenter,\r\n};\r\n\r\nconst mapStateToProps = (state) => {\r\n    return {\r\n        selectedType: state.ROW_EDIT,\r\n        mapCenter: state.BASE_MAP_CENTER,\r\n        createdGrid: state.GRID_CREATED,\r\n    };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(BaseMap);\r\n","import MaterialTable from '@material-table/core'\r\nimport React, { useState, useEffect } from 'react'\r\nimport { Grid, Typography } from '@material-ui/core'\r\n\r\nimport {\r\n  listenToRowEdits,\r\n  listeonToTypesList,\r\n  listenToGridCreator,\r\n} from '../../../../redux/actions'\r\nimport { useDispatch } from 'react-redux'\r\nimport settings from '../../../../settings/GridEditorSettings.json'\r\nimport { CloudLightning } from 'react-feather'\r\n\r\nexport default function TypesEditor() {\r\n  const createtypesArray = (LanduseTypesList) => {\r\n    let typesArray = []\r\n    Object.keys(LanduseTypesList).forEach((type) => {\r\n      typesArray.push({\r\n        name: type,\r\n        description: 'description for: ' + type,\r\n        color: LanduseTypesList[type].color,\r\n        height: LanduseTypesList[type].height\r\n          ? LanduseTypesList[type].height\r\n          : 0,\r\n\r\n        LBCS: LanduseTypesList[type].LBCS\r\n          ? JSON.stringify(LanduseTypesList[type].LBCS)\r\n          : null,\r\n        NAICS: LanduseTypesList[type].NAICS\r\n          ? JSON.stringify(LanduseTypesList[type].NAICS)\r\n          : null,\r\n        interactive: LanduseTypesList[type].interactive\r\n          ? LanduseTypesList[type].interactive\r\n          : \"web\",\r\n        TypeCode: LanduseTypesList[type].TypeCode\r\n          ? LanduseTypesList[type].TypeCode\r\n          : null,\r\n        IDSColor: LanduseTypesList[type].IDSColor\r\n          ? LanduseTypesList[type].IDSColor\r\n          : null,\r\n        RGB: LanduseTypesList[type].RGB\r\n          ? LanduseTypesList[type].RGB\r\n          : null,\r\n      })\r\n    })\r\n    return typesArray\r\n  }\r\n\r\n  const [state, setState] = React.useState({\r\n    columns: [\r\n      {\r\n        title: 'Type',\r\n        field: 'name',\r\n      },\r\n      {\r\n        title: 'Description',\r\n        field: 'description',\r\n      },\r\n\r\n      {\r\n        title: 'Height',\r\n        field: 'height',\r\n        type: 'numeric',\r\n      },\r\n      {\r\n        title: 'Interactive',\r\n        field: 'interactive',\r\n        lookup: { No: 'No', Web: 'Web', TUI: 'TUI' },\r\n      },\r\n      {\r\n        title: 'Color',\r\n        field: 'color',\r\n        type: 'string',\r\n      },\r\n      {\r\n        title: 'LBCS',\r\n        field: 'LBCS',\r\n        type: 'string',\r\n      },\r\n      {\r\n        title: 'NAICS',\r\n        field: 'NAICS',\r\n        type: 'string',\r\n      },\r\n    ],\r\n    data: createtypesArray(settings.GEOGRID.properties.types),\r\n  })\r\n\r\n  const dispatch = useDispatch()\r\n  const [selectedRow, setSelectedRow] = useState(null)\r\n  const [rowColor, setRowColor] = useState(null)\r\n\r\n  // redux the type list on every change\r\n  useEffect(() => {\r\n    dispatch(listeonToTypesList(state.data))\r\n  })\r\n\r\n  return (\r\n    <Grid container>\r\n      <Grid item xs={12} s={12} m={12} l={12} xl={12}>\r\n        <MaterialTable\r\n          title={<Typography variant=\"h2\">Types Editor</Typography>}\r\n          columns={state.columns}\r\n          data={state.data}\r\n          options={{\r\n            paging: false,\r\n            search: true,\r\n            selection: false,\r\n            rowStyle: (rowData) => ({\r\n              fontFamily: 'Roboto Mono',\r\n              fontSize: 12,\r\n              backgroundColor:\r\n                selectedRow === rowData.tableData.id ? rowColor : null,\r\n            }),\r\n          }}\r\n          onRowClick={(evt, row) => {\r\n            setSelectedRow(row.tableData.id)\r\n            setRowColor(row.color)\r\n            dispatch(listenToRowEdits(row))\r\n          }}\r\n          editable={{\r\n            onRowAdd: (newData) =>\r\n              new Promise((resolve) => {\r\n                setTimeout(() => {\r\n                  resolve()\r\n                  setState((prevState) => {\r\n                    const data = [...prevState.data]\r\n                    data.push(newData)\r\n                    return { ...prevState, data }\r\n                  })\r\n                }, 200)\r\n              }),\r\n            onRowUpdate: (newData, oldData) =>\r\n              new Promise((resolve) => {\r\n                setTimeout(() => {\r\n                  resolve()\r\n                  if (oldData) {\r\n                    setState((prevState) => {\r\n                      const data = [...prevState.data]\r\n                      data[data.indexOf(oldData)] = newData\r\n\r\n                      return { ...prevState, data }\r\n                    })\r\n                  }\r\n\r\n                  // dispath change to redux\r\n                  dispatch(listenToRowEdits(newData))\r\n                }, 200)\r\n              }),\r\n            onRowDelete: (oldData) =>\r\n              new Promise((resolve) => {\r\n                console.log(oldData)\r\n\r\n                setTimeout(() => {\r\n                  resolve()\r\n                  setState((prevState) => {\r\n                    const data = [...prevState.data]\r\n                    data.splice(data.indexOf(oldData), 1)\r\n                    return { ...prevState, data }\r\n                  })\r\n\r\n                  dispatch(listenToGridCreator(null))\r\n                }, 200)\r\n              }),\r\n          }}\r\n        />\r\n      </Grid>\r\n    </Grid>\r\n  )\r\n}\r\n","import proj4 from \"proj4\";\r\nimport { _hexToRgb } from \"../../../EditorMap/EditorMap\";\r\nimport scenario from '../../../../../settings/LandUse_3.json';\r\nimport { featureCollection, centroid, bbox, tag } from \"@turf/turf\";\r\nfunction deg_to_rad(deg) {\r\n    return (deg * Math.PI) / 180;\r\n}\r\nfunction rad_to_deg(rad) {\r\n    return (rad * 180) / Math.PI;\r\n}\r\n\r\nconst randomProperty = (obj) => {\r\n    var keys = Object.keys(obj);\r\n    return obj[keys[(keys.length * Math.random()) << 0]];\r\n};\r\n\r\nconst convertScenarioToWGS84 = (types) => {\r\n    let features = scenario.features;\r\n    // console.log(types);\r\n    for (let i = 0; i < features.length; i++) {\r\n        var color = types.find((el) => {\r\n            // console.log(el.TypeCode);\r\n            return el.TypeCode === features[i].properties['TypeCode']\r\n        });\r\n        // console.log(features[i].properties['TypeCode']);\r\n        // console.log(color);\r\n        color = color.color\r\n        // if(typeof color !== 'undefined'){\r\n        // }\r\n        if (typeof color == 'undefined') {\r\n            console.log('undefine TypeCode', features[i].properties['TypeCode']);\r\n        }\r\n        let rgbArr = (features[i].properties['RGB']).split(',')\r\n        rgbArr = rgbArr.map(el => parseFloat(el));\r\n        rgbArr.push(220);\r\n\r\n        // let height = 0;\r\n        // if (features[i].properties.Height) {\r\n        //     height = features[i].properties.Height\r\n        //     if (height.includes(\"-\")) {\r\n        //         height = height.split('');\r\n        //         height = height[height.length - 1];\r\n        //     }\r\n        //     height = parseFloat(height);\r\n        // }\r\n\r\n        // features[i].properties.height = height;\r\n        features[i].properties.color = rgbArr;\r\n        // features[i].properties.color = JSON.parse(features[i].properties.color);\r\n        features[i].properties.stroke = '#3f3f3f';\r\n        features[i].properties['stroke-width'] = 0.5;\r\n        features[i].properties['stroke-opacity'] = 1;\r\n        features[i].properties['fill'] = color;\r\n        features[i].properties['fill-opacity'] = 1;\r\n    }\r\n    let geojson = {\r\n        \"type\": \"FeatureCollection\",\r\n        \"features\": features,\r\n    }\r\n    // console.log(geojson);\r\n    console.log(JSON.stringify(geojson));\r\n}\r\n\r\nconst VN2kToWGSMultiLineString = (coordinates, userPrj) => {\r\n    for (let i = 0; i < coordinates.length; i++) {\r\n        for (let j = 0; j < coordinates[i].length; j++) {\r\n            coordinates[i][j] = proj4(userPrj, proj4.defs(\"EPSG:4326\"), coordinates[i][j]);\r\n        }\r\n    }\r\n    return coordinates;\r\n}\r\n\r\nconst joinGridAndPrivateGeojson = (privateGeojson, gridGeojson, types) => {\r\n    // Get grid cell centroids\r\n    let gridCentroids = featureCollection(gridGeojson.features.map(obj => {\r\n        let cellCentroid = centroid(obj)\r\n        cellCentroid.properties = {\r\n            'color': undefined,\r\n        } // Later populated with the sjoin\r\n        return cellCentroid\r\n    }))\r\n\r\n    // Assing landuse to centroid with polygons (Spatial join)\r\n    let gridCentroidsWithLanduse = tag(gridCentroids, privateGeojson, 'color', 'color')\r\n\r\n    // Set each cell properties according to types\r\n    for (let i = 0; i < gridCentroidsWithLanduse.features.length; i++) {\r\n        let obj = gridCentroidsWithLanduse.features[i];\r\n\r\n        // let selected_type;\r\n        // if (obj.properties.name === undefined) {\r\n        //     // Default landuse is Residential (this must change)\r\n        //     selected_type = types.filter(type => type.name === 'Residential')[0]\r\n        // } else {\r\n        //     selected_type = types.filter(type => type.name === obj.properties.name)[0]\r\n        // }\r\n\r\n        // gridGeojson.features[i].properties = {\r\n        //     color: _hexToRgb(selected_type.color),\r\n        //     height: selected_type.height,\r\n        //     name: selected_type.name,\r\n        //     interactive: selected_type.interactive,\r\n        //     id: i,\r\n        // }\r\n\r\n        /* my self */\r\n        gridGeojson.features[i].properties.color = _hexToRgb(obj.properties.color);\r\n    }\r\n}\r\n\r\nexport const gridCreator = (gridProps, typesList) => {\r\n    let top_left_lon = parseFloat(gridProps.longitude);\r\n    let top_left_lat = parseFloat(gridProps.latitude);\r\n    let rotation = parseFloat(gridProps.rotation);\r\n    let userPrj = gridProps.projection;\r\n    let cell_size = parseFloat(gridProps.cellSize);\r\n    let nrows = parseFloat(gridProps.nrows);\r\n    let ncols = parseFloat(gridProps.ncols);\r\n\r\n    const webMercator = proj4.defs(\"EPSG:4326\");\r\n    let EARTH_RADIUS_M = 6.371e6;\r\n    let top_left_lon_lat = { lon: top_left_lon, lat: top_left_lat };\r\n    let bearing = (90 - rotation + 360) % 360;\r\n    let Ad = (cell_size * ncols) / EARTH_RADIUS_M;\r\n    let la1 = deg_to_rad(top_left_lon_lat.lat);\r\n    let lo1 = deg_to_rad(top_left_lon_lat.lon);\r\n    let bearing_rad = deg_to_rad(bearing);\r\n    let la2 = Math.asin(\r\n        Math.sin(la1) * Math.cos(Ad) +\r\n        Math.cos(la1) * Math.sin(Ad) * Math.cos(bearing_rad)\r\n    );\r\n    let lo2 =\r\n        lo1 +\r\n        Math.atan2(\r\n            Math.sin(bearing_rad) * Math.sin(Ad) * Math.cos(la1),\r\n            Math.cos(Ad) - Math.sin(la1) * Math.sin(la2)\r\n        );\r\n    let top_right_lon_lat = { lon: rad_to_deg(lo2), lat: rad_to_deg(la2) };\r\n    let top_left_xy = proj4(webMercator, userPrj, [\r\n        top_left_lon_lat.lon,\r\n        top_left_lon_lat.lat,\r\n    ]);\r\n\r\n    let top_right_xy = proj4(webMercator, userPrj, [\r\n        top_right_lon_lat.lon,\r\n        top_right_lon_lat.lat,\r\n    ]);\r\n\r\n    let dydx =\r\n        (top_right_xy[1] - top_left_xy[1]) / (top_right_xy[0] - top_left_xy[0]);\r\n    let theta = Math.atan(dydx);\r\n    let cosTheta = Math.cos(theta);\r\n    let sinTheta = Math.sin(theta);\r\n    // create rotate matrix\r\n    let x_unRot = [];\r\n    let y_unRot = [];\r\n    for (let i = 0; i < nrows; i++) {\r\n        for (let j = 0; j < ncols; j++) {\r\n            x_unRot.push(j * cell_size);\r\n            y_unRot.push(-i * cell_size);\r\n        }\r\n    }\r\n\r\n    let x_rot = [];\r\n    let y_rot = [];\r\n    for (let i = 0; i < x_unRot.length; i++) {\r\n        x_rot.push(x_unRot[i] * cosTheta - y_unRot[i] * sinTheta);\r\n        y_rot.push(x_unRot[i] * sinTheta + y_unRot[i] * cosTheta);\r\n    }\r\n\r\n    let x_rot_trans = [];\r\n    let y_rot_trans = [];\r\n    for (let i = 0; i < x_rot.length; i++) {\r\n        x_rot_trans.push(top_left_xy[0] + x_rot[i]);\r\n        y_rot_trans.push(top_left_xy[1] + y_rot[i]);\r\n    }\r\n\r\n    var dxdCol = x_rot_trans[1] - x_rot_trans[0];\r\n    var dydCol = y_rot_trans[1] - y_rot_trans[0];\r\n    var dxdRow = x_rot_trans[ncols] - x_rot_trans[0];\r\n    var dydRow = y_rot_trans[ncols] - y_rot_trans[0];\r\n\r\n    let gridPnts = [];\r\n    let geojsonFeatureCollection = {\r\n        type: \"FeatureCollection\",\r\n        // polygons go here\r\n        features: [],\r\n    };\r\n\r\n    // get a list of types that is updated based on\r\n    // the current redux state of the types list table\r\n    let types = typesList;\r\n\r\n    for (let i = 0; i < x_rot_trans.length; i++) {\r\n        let rndType = randomProperty(types);\r\n        let geojsonPolygon = {\r\n            type: \"Feature\",\r\n            geometry: {\r\n                type: \"Polygon\",\r\n                coordinates: null,\r\n            },\r\n            properties: {\r\n                color: _hexToRgb(rndType.color),\r\n                height: rndType.height,\r\n                name: rndType.name,\r\n                interactive: rndType.interactive,\r\n                id: i,\r\n            },\r\n        };\r\n\r\n        var polygon_xy = [\r\n            [x_rot_trans[i], y_rot_trans[i]],\r\n            [x_rot_trans[i] + dxdRow, y_rot_trans[i] + dydRow],\r\n            [\r\n                x_rot_trans[i] + dxdRow + dxdCol,\r\n                y_rot_trans[i] + dydRow + dydCol,\r\n            ],\r\n            [x_rot_trans[i] + dxdCol, y_rot_trans[i] + dydCol],\r\n            [x_rot_trans[i], y_rot_trans[i]],\r\n        ];\r\n\r\n        var polygon_ll = [];\r\n        for (var v = 0; v < 5; v++) {\r\n            let ll = proj4(userPrj, webMercator, polygon_xy[v]);\r\n\r\n            polygon_ll.push(ll);\r\n        }\r\n\r\n        geojsonPolygon.geometry.coordinates = [polygon_ll];\r\n        gridPnts.push(geojsonPolygon);\r\n    }\r\n    geojsonFeatureCollection.features = gridPnts;\r\n    // joinGridAndPrivateGeojson(scenario, geojsonFeatureCollection, types);\r\n    convertScenarioToWGS84(types);\r\n    return geojsonFeatureCollection;\r\n};\r\n","import React from \"react\";\r\nimport AppsIcon from \"@material-ui/icons/Apps\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport { gridCreator } from \"./gridCreator\";\r\nimport { listenToGridCreator } from \"../../../../../redux/actions\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { useSelector } from \"react-redux\";\r\n\r\nexport default function GridMaker(props) {\r\n    const dispatch = useDispatch();\r\n    const reduxState = useSelector((state) => state);\r\n\r\n    const handleGridCreation = () => {\r\n        let grid = gridCreator(props.gridProps, reduxState.TYPES_LIST);\r\n        dispatch(listenToGridCreator(grid));\r\n    };\r\n\r\n    return (\r\n        <Button\r\n            onClick={() => {\r\n                handleGridCreation();\r\n            }}\r\n            variant=\"outlined\"\r\n            color=\"default\"\r\n            startIcon={<AppsIcon />}\r\n        >\r\n            Create Grid\r\n        </Button>\r\n    );\r\n}\r\n","import React from 'react'\r\nimport Button from '@material-ui/core/Button'\r\nimport CloudUploadIcon from '@material-ui/icons/CloudUpload'\r\nimport CloudDownloadIcon from '@material-ui/icons/CloudDownload'\r\nimport axios from 'axios'\r\nimport settings from '../../../../../settings/GridEditorSettings.json'\r\nimport globalSettings from '../../../../../settings/settings.json'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport { useSelector } from 'react-redux'\r\nimport Link from '@material-ui/core/Link'\r\nimport scenario from '../../../../../settings/LandUse_3_color.json'\r\n\r\nconst reqResonseUI = (response, tableName) => {\r\n  let cityscopeJSendpoint =\r\n    'https://cityscope.media.mit.edu/CS_cityscopeJS/?cityscope=' + tableName\r\n  // create the feedback text\r\n  let resText = (\r\n    <Typography color=\"textPrimary\" variant=\"caption\">\r\n      CityIO is {response.data.status}. Grid deployed to{' '}\r\n      <Link color=\"textSecondary\" href={cityscopeJSendpoint}>\r\n        {cityscopeJSendpoint}\r\n      </Link>\r\n    </Typography>\r\n  )\r\n\r\n  return resText\r\n}\r\n\r\n/**\r\n *\r\n * @param {typesList} typesList List of types form table editor\r\n *\r\n */\r\nconst makeGEOGRIDobject = (struct, typesList, geoJsonFeatures, gridProps) => {\r\n  let GEOGRID_object = struct\r\n\r\n  // take types list and prepare to csJS format\r\n  let newTypesList = {}\r\n\r\n  typesList.forEach((oldType) => {\r\n    newTypesList[oldType.name] = oldType\r\n    //material-table creates strings for these items\r\n    // so in first \"Commit to cityIO\", these must be turned into\r\n    // Json objects. On Second commit, these are already objects,\r\n    // hence the two conditions below\r\n\r\n    newTypesList[oldType.name].LBCS =\r\n      typeof oldType.LBCS == 'string' ? JSON.parse(oldType.LBCS) : oldType.LBCS\r\n    newTypesList[oldType.name].NAICS =\r\n      typeof oldType.NAICS == 'string'\r\n        ? JSON.parse(oldType.NAICS)\r\n        : oldType.NAICS\r\n  })\r\n\r\n  GEOGRID_object.properties.types = newTypesList\r\n\r\n  // inject table props to grid\r\n  GEOGRID_object.properties.header = gridProps\r\n  GEOGRID_object.properties.header.longitude = parseFloat(\r\n    GEOGRID_object.properties.header.longitude,\r\n  )\r\n  GEOGRID_object.properties.header.latitude = parseFloat(\r\n    GEOGRID_object.properties.header.latitude,\r\n  )\r\n  GEOGRID_object.properties.header.rotation = parseFloat(\r\n    GEOGRID_object.properties.header.rotation,\r\n  )\r\n  GEOGRID_object.properties.header.nrows = parseFloat(\r\n    GEOGRID_object.properties.header.nrows,\r\n  )\r\n  GEOGRID_object.properties.header.ncols = parseFloat(\r\n    GEOGRID_object.properties.header.ncols,\r\n  )\r\n  GEOGRID_object.properties.header.cellSize = parseFloat(\r\n    GEOGRID_object.properties.header.cellSize,\r\n  )\r\n\r\n  // lastly get the grid features\r\n  GEOGRID_object.features = geoJsonFeatures\r\n  return GEOGRID_object\r\n}\r\n\r\n/**\r\n *\r\n * @param {typesList} typesList List of types form table editor\r\n *\r\n */\r\nconst makeGEOGRIDDATAobject = (geoJsonFeatures) => {\r\n  let GEOGRIDDATA_object = []\r\n  geoJsonFeatures.forEach((element) => {\r\n    GEOGRIDDATA_object.push(element.properties)\r\n  })\r\n  return GEOGRIDDATA_object\r\n}\r\n\r\nexport default function CommitGrid(props) {\r\n  const [reqResonse, setReqResonse] = React.useState(null)\r\n\r\n  const reduxState = useSelector((state) => state)\r\n  const hasGrid = reduxState.GRID_CREATED\r\n\r\n  const downloadObjectAsJson = () => {\r\n    let GEOGRIDstruct = settings.GEOGRID\r\n\r\n    let typesList = reduxState.TYPES_LIST\r\n    let geoJsonFeatures = reduxState.GRID_CREATED.features\r\n    let gridProps = props.gridProps\r\n    let GEOGRID_object = makeGEOGRIDobject(\r\n      GEOGRIDstruct,\r\n      typesList,\r\n      geoJsonFeatures,\r\n      gridProps,\r\n    )\r\n    var dataStr =\r\n      'data:text/json;charset=utf-8,' +\r\n      encodeURIComponent(JSON.stringify(GEOGRID_object))\r\n    var downloadAnchorNode = document.createElement('a')\r\n    downloadAnchorNode.setAttribute('href', dataStr)\r\n    downloadAnchorNode.setAttribute('download', 'grid.json')\r\n    document.body.appendChild(downloadAnchorNode) // required for firefox\r\n    downloadAnchorNode.click()\r\n    downloadAnchorNode.remove()\r\n  }\r\n\r\n  const postGridToCityIO = () => {\r\n    let GEOGRIDstruct = settings.GEOGRID\r\n    let typesList = reduxState.TYPES_LIST\r\n    // let geoJsonFeatures = reduxState.GRID_CREATED.features\r\n    let geoJsonFeatures = scenario.features\r\n    let gridProps = props.gridProps\r\n    // take grid struct from settings\r\n    // console.log('GEOGRIDstruct', GEOGRIDstruct);\r\n    // console.log('typesList', typesList);\r\n    // console.log('geoJsonFeatures', geoJsonFeatures);\r\n    // console.log('gridProps', gridProps);\r\n    let GEOGRID_object = makeGEOGRIDobject(\r\n      GEOGRIDstruct,\r\n      typesList,\r\n      geoJsonFeatures,\r\n      gridProps,\r\n    )\r\n\r\n    let GEOGRIDDATA_object = makeGEOGRIDDATAobject(geoJsonFeatures)\r\n    let tableName = GEOGRID_object.properties.header.tableName.toLowerCase()\r\n\r\n    const geoGridOptions = (URL, DATA) => {\r\n      return {\r\n        method: 'post',\r\n        url: URL,\r\n        data: DATA,\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          Accept: 'application/json',\r\n        },\r\n      }\r\n    }\r\n\r\n    const table_url = `${globalSettings.cityIO.baseURL}${tableName}/`\r\n    const new_table_grid = {\r\n      GEOGRID: GEOGRID_object,\r\n      GEOGRIDDATA: GEOGRIDDATA_object,\r\n    }\r\n\r\n    axios(geoGridOptions(table_url, new_table_grid))\r\n      .then(function (response) {\r\n        setReqResonse(reqResonseUI(response, tableName))\r\n      })\r\n      .catch((error) => console.log(`ERROR: ${error}`))\r\n  }\r\n\r\n  return (\r\n    <>\r\n      {hasGrid && (\r\n        <>\r\n          <Button\r\n            onClick={() => {\r\n              postGridToCityIO()\r\n            }}\r\n            variant=\"outlined\"\r\n            color=\"default\"\r\n            startIcon={<CloudUploadIcon />}\r\n          >\r\n            Commit Grid to cityIO\r\n          </Button>\r\n\r\n          <Button\r\n            onClick={() => {\r\n              // ! download as json\r\n              downloadObjectAsJson()\r\n            }}\r\n            variant=\"outlined\"\r\n            color=\"default\"\r\n            startIcon={<CloudDownloadIcon />}\r\n          >\r\n            Download JSON\r\n          </Button>\r\n\r\n          <div style={{ width: '100%' }}> {reqResonse}</div>\r\n        </>\r\n      )}\r\n    </>\r\n  )\r\n}\r\n","import React from \"react\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport CenterFocusStrongIcon from \"@material-ui/icons/CenterFocusStrong\";\r\nimport { useDispatch } from \"react-redux\";\r\n\r\nimport { listenToBaseMapCenter } from \"../../../../../redux/actions\";\r\n\r\nexport default function CenterMapButton(props) {\r\n    const dispatch = useDispatch();\r\n\r\n    return (\r\n        <Button\r\n            onClick={() => {\r\n                dispatch(\r\n                    listenToBaseMapCenter({\r\n                        latCenter: parseFloat(props.mapCenter[0]),\r\n                        lonCenter: parseFloat(props.mapCenter[1]),\r\n                    })\r\n                );\r\n            }}\r\n            variant=\"outlined\"\r\n            color=\"default\"\r\n            startIcon={<CenterFocusStrongIcon />}\r\n            style={{ fontSize: \"12px\" }}\r\n        >\r\n            Center Map\r\n        </Button>\r\n    );\r\n}\r\n","import React from \"react\";\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport GridMaker from \"./GridMaker\";\r\nimport CommitGrid from \"./CommitGrid\";\r\nimport CenterMapButton from \"./CenterMapButton/CenterMapButton\";\r\nimport settings from \"../../../../settings/GridEditorSettings.json\";\r\n\r\n\r\nexport default function GridProps() {\r\n    const useStyles = makeStyles((theme) => ({\r\n        notchedOutline: {\r\n            borderWidth: \"1px\",\r\n            borderColor: theme.palette.text.secondary,\r\n        },\r\n        root: {\r\n            \"& .MuiTextField-root\": {\r\n                margin: theme.spacing(1),\r\n                flexWrap: \"wrap\",\r\n            },\r\n            \"& > *\": {\r\n                margin: theme.spacing(1),\r\n            },\r\n        },\r\n    }));\r\n\r\n    const [formValues, setformValues] = React.useState({\r\n        // tableName: \"CityScopeJS\",\r\n        tableName: settings.map.projectName,\r\n        latitude: settings.GEOGRID.properties.header.latitude,\r\n        longitude: settings.GEOGRID.properties.header.longitude,\r\n        tz:settings.GEOGRID.properties.header.tz, \r\n        nrows: settings.GEOGRID.properties.header.nrows,\r\n        ncols: settings.GEOGRID.properties.header.nrows,\r\n        rotation: settings.GEOGRID.properties.header.rotation,\r\n        cellSize: settings.GEOGRID.properties.header.cellSize,\r\n        projection: settings.GEOGRID.properties.header.projection,\r\n    });\r\n\r\n    const handleChangeForm = (event) => {\r\n        const { id, value } = event.target;\r\n        setformValues({ ...formValues, [id]: value });\r\n    };\r\n\r\n    const classes = useStyles();\r\n\r\n    //  get all data\r\n    // https://stackoverflow.com/questions/56641235/react-how-to-get-values-from-material-ui-textfield-components\r\n    return (\r\n        <form className={classes.root} noValidate autoComplete=\"off\">\r\n            <Typography variant=\"h2\">Grid Properties</Typography>\r\n            <div className={classes.root}>\r\n                <TextField\r\n                    InputProps={{\r\n                        classes: {\r\n                            notchedOutline: classes.notchedOutline,\r\n                        },\r\n                    }}\r\n                    onChange={(event) => handleChangeForm(event)}\r\n                    variant=\"outlined\"\r\n                    className={classes.textField}\r\n                    id=\"tableName\"\r\n                    label=\"CityScope Project Name\"\r\n                    defaultValue={formValues.tableName}\r\n                />\r\n            </div>\r\n            <div className={classes.root}>\r\n                <TextField\r\n                    InputProps={{\r\n                        classes: {\r\n                            notchedOutline: classes.notchedOutline,\r\n                        },\r\n                    }}\r\n                    onChange={(event) => handleChangeForm(event)}\r\n                    variant=\"outlined\"\r\n                    className={classes.textField}\r\n                    id=\"latitude\"\r\n                    label=\"Latitude\"\r\n                    defaultValue={formValues.latitude}\r\n                    type=\"number\"\r\n                />\r\n\r\n                <TextField\r\n                    InputProps={{\r\n                        classes: {\r\n                            notchedOutline: classes.notchedOutline,\r\n                        },\r\n                    }}\r\n                    onChange={(event) => handleChangeForm(event)}\r\n                    variant=\"outlined\"\r\n                    className={classes.textField}\r\n                    id=\"longitude\"\r\n                    label=\"Longitude\"\r\n                    defaultValue={formValues.longitude}\r\n                    type=\"number\"\r\n                />\r\n                <TextField\r\n                    InputProps={{\r\n                        classes: {\r\n                            notchedOutline: classes.notchedOutline,\r\n                        },\r\n                    }}\r\n                    onChange={(event) => handleChangeForm(event)}\r\n                    variant=\"outlined\"\r\n                    className={classes.textField}\r\n                    id=\"tz\"\r\n                    label=\"Time Zone (GMT)\"\r\n                    defaultValue={formValues.tz}\r\n                    type=\"number\"\r\n                />\r\n            </div>\r\n            <div className={classes.root}>\r\n                <CenterMapButton\r\n                    mapCenter={[formValues.latitude, formValues.longitude]}\r\n                />\r\n            </div>\r\n            <div className={classes.root}>\r\n                <TextField\r\n                    onChange={(event) => handleChangeForm(event)}\r\n                    variant=\"outlined\"\r\n                    className={classes.textField}\r\n                    id=\"nrows\"\r\n                    label=\"Rows\"\r\n                    defaultValue={formValues.nrows}\r\n                    type=\"number\"\r\n                    InputProps={{\r\n                        classes: {\r\n                            notchedOutline: classes.notchedOutline,\r\n                        },\r\n                        inputProps: {\r\n                            max: 100,\r\n                            min: 0,\r\n                        },\r\n                    }}\r\n                />\r\n\r\n                <TextField\r\n                    onChange={(event) => handleChangeForm(event)}\r\n                    variant=\"outlined\"\r\n                    className={classes.textField}\r\n                    id=\"ncols\"\r\n                    label=\"Columns\"\r\n                    defaultValue={formValues.ncols}\r\n                    type=\"number\"\r\n                    InputProps={{\r\n                        classes: {\r\n                            notchedOutline: classes.notchedOutline,\r\n                        },\r\n                        inputProps: {\r\n                            max: 100,\r\n                            min: 0,\r\n                        },\r\n                    }}\r\n                />\r\n\r\n                <TextField\r\n                    onChange={(event) => handleChangeForm(event)}\r\n                    variant=\"outlined\"\r\n                    className={classes.textField}\r\n                    id=\"rotation\"\r\n                    label=\"Rotation (deg)\"\r\n                    defaultValue={formValues.rotation}\r\n                    type=\"number\"\r\n                    InputProps={{\r\n                        classes: {\r\n                            notchedOutline: classes.notchedOutline,\r\n                        },\r\n                        inputProps: {\r\n                            max: 360,\r\n                            min: 0,\r\n                        },\r\n                    }}\r\n                />\r\n\r\n                <TextField\r\n                    onChange={(event) => handleChangeForm(event)}\r\n                    variant=\"outlined\"\r\n                    className={classes.textField}\r\n                    id=\"cellSize\"\r\n                    label=\"Cell Size (m^2)\"\r\n                    defaultValue={formValues.cellSize}\r\n                    type=\"number\"\r\n                    InputProps={{\r\n                        classes: {\r\n                            notchedOutline: classes.notchedOutline,\r\n                        },\r\n                        inputProps: {\r\n                            max: 1000,\r\n                            min: 0,\r\n                        },\r\n                    }}\r\n                />\r\n            </div>\r\n            <div className={classes.root}>\r\n                <TextField\r\n                    InputProps={{\r\n                        classes: {\r\n                            notchedOutline: classes.notchedOutline,\r\n                        },\r\n                    }}\r\n                    onChange={(event) => handleChangeForm(event)}\r\n                    variant=\"outlined\"\r\n                    id=\"projection\"\r\n                    label=\"Projection\"\r\n                    defaultValue={formValues.projection}\r\n                    type=\"string\"\r\n                    helperText=\"Default projection should work for most CityScope cases. Find specific projections at: https://epsg.io/\"\r\n                />\r\n            </div>\r\n            <div className={classes.root}>\r\n                <GridMaker gridProps={formValues} />\r\n                <CommitGrid gridProps={formValues} />\r\n            </div>\r\n        </form>\r\n    );\r\n}\r\n","// // export default EditMenuMain;\r\n\r\nimport TypesEditor from './TypesEditor'\r\nimport GridProps from './GridProps'\r\nimport List from '@material-ui/core/List'\r\nimport ListItem from '@material-ui/core/ListItem'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\nexport default function EditorMenu() {\r\n  return (\r\n    <List>\r\n      <ListItem>\r\n        <Typography variant=\"h1\">CityScope Grid Editor</Typography>\r\n      </ListItem>\r\n      <ListItem>\r\n        <Typography>\r\n          This tool is for creating CityScope projects with virtual editable\r\n          girds, types, and props, and deploy them to cityIO.\r\n        </Typography>\r\n      </ListItem>\r\n      <ListItem>\r\n        <GridProps />\r\n      </ListItem>\r\n      <ListItem>\r\n        <TypesEditor />\r\n      </ListItem>\r\n    </List>\r\n  )\r\n}\r\n","import EditorMap from \"./EditorMap/EditorMap\";\r\nimport EditorMenu from \"./EditorMenu\";\r\nimport {\r\n    makeStyles,\r\n    Grid,\r\n    Card,\r\n    CardContent,\r\n    Container,\r\n} from \"@material-ui/core\";\r\nimport Page from \"../../layouts/Page\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    root: {\r\n        margin: \"auto\",\r\n        height: \"100%\",\r\n        paddingBottom: theme.spacing(3),\r\n        paddingTop: theme.spacing(3),\r\n    },\r\n}));\r\n\r\nexport default function GridEditor() {\r\n    const classes = useStyles();\r\n\r\n    return (\r\n        <Page className={classes.root} title=\"Editor\">\r\n            <Container maxWidth={false}>\r\n                <>\r\n                    <Grid container spacing={5}>\r\n                        <Grid item xs={12} l={6} md={6} xl={4}>\r\n                            <Card\r\n                                elevation={15}\r\n                                style={{\r\n                                    maxHeight: \"85vh\",\r\n                                    overflow: \"auto\",\r\n                                }}\r\n                            >\r\n                                <CardContent>\r\n                                    <EditorMenu />\r\n                                </CardContent>\r\n                            </Card>\r\n                        </Grid>\r\n                        <Grid item xs={12} l={6} md={6} xl={8}>\r\n                            <Card\r\n                                elevation={15}\r\n                                style={{\r\n                                    height: \"85vh\",\r\n                                    width: \"100%\",\r\n                                    position: \"relative\",\r\n                                }}\r\n                            >\r\n                                <CardContent>\r\n                                    <EditorMap />\r\n                                </CardContent>\r\n                            </Card>\r\n                        </Grid>\r\n                    </Grid>\r\n                </>\r\n            </Container>\r\n        </Page>\r\n    );\r\n}\r\n","import axios from \"axios\";\r\nimport settings from \"../../../settings/settings.json\";\r\n\r\nexport const getScenarioIndices = (\r\n    tableName,\r\n    setScenarioNames,\r\n    setLoadingState\r\n) => {\r\n    var url = `${settings.cityIO.baseURL}${tableName}/meta/hashes`;\r\n    axios\r\n        .get(url)\r\n        .then((res) => {\r\n            const metaDataKeys = Object.keys(res.data);\r\n            const scenarioIndices = metaDataKeys\r\n                .filter((str) => str.includes(\"scenarios\"))\r\n                .map((str) => parseInt(str.replace(\"scenarios\", \"\")));\r\n            const promises = [];\r\n            for (const id of scenarioIndices) {\r\n                promises.push(getScenarioName(tableName, id));\r\n            }\r\n            Promise.all(promises)\r\n                .then((res) => {\r\n                    setScenarioNames(\r\n                        res.map((r) => ({\r\n                            name: r.data.name,\r\n                            id: r.data.id,\r\n                        }))\r\n                    );\r\n                    setLoadingState && setLoadingState(false);\r\n                })\r\n                .catch((err) =>\r\n                    console.log(\"error getting scenario names\", err)\r\n                );\r\n        })\r\n        .catch((err) => {\r\n            console.log(\"Error getting scenarios\", err);\r\n        });\r\n};\r\n\r\nexport const getScenarioName = (tableName, id) => {\r\n    const url =\r\n\t\t`${settings.cityIO.baseURL}${tableName}/scenarios${id}/info/`;\r\n    return axios.get(url);\r\n};\r\n","import { useEffect, useState } from \"react\";\r\nimport axios from \"axios\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport {\r\n    getCityioData,\r\n    setReadyState,\r\n    setLoadingState,\r\n    setScenarioNames,\r\n    addLoadingModules,\r\n    removeLoadingModules,\r\n} from \"../../../redux/actions\";\r\nimport settings from \"../../../settings/settings.json\";\r\nimport { getScenarioIndices } from \"./utils\";\r\n\r\nconst getAPICall = async (URL) => {\r\n    try {\r\n        // ! should add 'retry' here\r\n        // ! https://stackoverflow.com/questions/56074531/how-to-retry-5xx-requests-using-axios\r\n        const response = await axios.get(URL);\r\n        return response.data;\r\n    } catch (err) {\r\n        console.log(err);\r\n    }\r\n};\r\n\r\nexport default function CityIO(props) {\r\n    const { tableName } = props;\r\n    const [hashId, setHashId] = useState(null);\r\n    const [hashes, setHashes] = useState({});\r\n    const cityioURL = `${settings.cityIO.baseURL}${tableName}/`;\r\n    const cityioData = useSelector((state) => state.CITYIO);\r\n    console.log('cityioData',cityioData);\r\n\r\n    const dispatch = useDispatch();\r\n\r\n    /**\r\n     * start fetching API hashes to check for new data\r\n     */\r\n    useEffect(() => {\r\n        const timer = setTimeout(update, settings.cityIO.interval);\r\n        console.log(\"reading cityIO every\" + settings.cityIO.interval + \"ms\");\r\n        return () => clearTimeout(timer);\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, []);\r\n\r\n    async function update() {\r\n        // recursively get hashes\r\n        const newHashId = await getAPICall(cityioURL + \"meta/id/\");\r\n        if (hashId !== newHashId) {\r\n            setHashId(newHashId);\r\n        }\r\n        setTimeout(update, settings.cityIO.interval);\r\n    }\r\n\r\n    async function getModules() {\r\n        const newHashes = await getAPICall(cityioURL + \"meta/hashes/\");\r\n        const promises = [];\r\n        const loadingModules = [];\r\n        const pickedModules = settings.cityIO.cityIOmodules.map((x) => x.name);\r\n        // for each of the modules in settings, add api call to promises\r\n        pickedModules.forEach((module) => {\r\n            if (hashes[module] !== newHashes[module]) {\r\n                promises.push(getAPICall(`${cityioURL}${module}/`));\r\n                loadingModules.push(module);\r\n            } else {\r\n                promises.push(null);\r\n            }\r\n        });\r\n        dispatch(addLoadingModules(loadingModules));\r\n        const modules = await Promise.all(promises);\r\n        setHashes(newHashes);\r\n\r\n        // update cityio object with modules data\r\n        const modulesData = pickedModules.reduce((obj, k, i) => {\r\n            if (modules[i]) {\r\n                console.log(`updating ${k}`);\r\n                return { ...obj, [k]: modules[i] };\r\n            } else {\r\n                return obj;\r\n            }\r\n        }, cityioData);\r\n        modulesData.tableName = tableName;\r\n\r\n        dispatch(removeLoadingModules(loadingModules));\r\n\r\n        // send to cityio\r\n        dispatch(getCityioData(modulesData));\r\n        console.log(\"done updating from cityIO\");\r\n\r\n        // initializes rendering of Menu and Map containers\r\n        dispatch(setReadyState(true));\r\n        dispatch(setLoadingState(false));\r\n    }\r\n\r\n    useEffect(() => {\r\n        //! only update if hashId changes\r\n        if (!hashId) {\r\n            return;\r\n        }\r\n        // reset the state of loading flag\r\n        dispatch(setLoadingState(true));\r\n        // set Scenario Names and Ids\r\n        getScenarioIndices(tableName, (data) =>\r\n            dispatch(setScenarioNames(data))\r\n        );\r\n        getModules();\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [hashId]);\r\n\r\n    return null;\r\n}\r\n","export default __webpack_public_path__ + \"static/media/legoio.148c5ab6.png\";","import { Typography, Link, Card, CardContent } from '@material-ui/core'\r\n\r\nexport default function SelectedTable(props) {\r\n  const clicked = props.clicked\r\n  const cityscopeJSendpoint =\r\n    'https://cityscope.media.mit.edu/CS_cityscopeJS/?cityscope='\r\n\r\n\t// 'http://localhost:3000/CS_cityscopeJS/?cityscope='\r\n\t\r\nconsole.log(clicked.object);\r\n\r\n  return (\r\n    <Card\r\n      elevation={15}\r\n      style={{\r\n        position: 'relative',\r\n        zIndex: 100,\r\n      }}\r\n    >\r\n      <CardContent>\r\n        <Typography variant=\"h2\" color=\"textPrimary\">\r\n          CityScope {clicked.object.tableName}\r\n        </Typography>\r\n        <Typography>\r\n          <Link\r\n            color={'secondary'}\r\n            href={cityscopeJSendpoint + clicked.object.tableName.toLowerCase()}\r\n          >\r\n            Go to project\r\n          </Link>{' '}\r\n          or{' '}\r\n          <Link\r\n            target={'blank'}\r\n            color={'secondary'}\r\n            href={clicked.object.tableURL}\r\n          >\r\n            view raw data on cityIO.\r\n          </Link>\r\n        </Typography>\r\n      </CardContent>\r\n    </Card>\r\n  )\r\n}\r\n","import { useEffect, useState } from 'react'\r\nimport { _MapContext } from 'react-map-gl'\r\nimport { DeckGL } from '@deck.gl/react'\r\nimport { _GlobeView as GlobeView, COORDINATE_SYSTEM } from '@deck.gl/core'\r\nimport { TileLayer } from '@deck.gl/geo-layers'\r\nimport { FlyToInterpolator } from 'deck.gl'\r\nimport 'mapbox-gl/dist/mapbox-gl.css'\r\nimport { LineLayer, IconLayer, TextLayer, BitmapLayer, GeoJsonLayer } from '@deck.gl/layers'\r\nimport icon from './legoio.png'\r\n\r\nimport SelectedTable from './SelectedTable'\r\n\r\n// * draggable pin https://github.com/visgl/react-map-gl/tree/6.1-release/examples/draggable-markers\r\n\r\nexport default function CityIOdeckGLmap(props) {\r\n  const [markerInfo, setMarkerInfo] = useState([])\r\n  const [clicked, setClicked] = useState()\r\n  const [zoom, setZoom] = useState()\r\n  const INIT_VIEW = {\r\n    longitude: -71.060929,\r\n    latitude: 42.3545259,\r\n    zoom: 1,\r\n    pitch: 0,\r\n    bearing: 0,\r\n    zHeight: 2000000,\r\n  }\r\n\r\n  const [viewport, setViewport] = useState(INIT_VIEW)\r\n  const [initialViewState, setInitialViewState] = useState(viewport)\r\n  // boolean for hovering flag\r\n  let isHovering = false\r\n\r\n  useEffect(() => {\r\n    // set initial zoom level to refelct layers appearance\r\n    setZoom(INIT_VIEW.zoom)\r\n    document\r\n      .getElementById('deckgl-wrapper')\r\n      .addEventListener('contextmenu', (evt) => evt.preventDefault())\r\n  }, [INIT_VIEW.zoom])\r\n\r\n  useEffect(() => {\r\n    let markersArr = []\r\n    props.cityIOdata.forEach((table, index) => {\r\n      const RND_1 = Math.random() * 10\r\n      const RND_2 = Math.random() * 10\r\n      markersArr.push({\r\n        tableURL: table.tableURL,\r\n        tableName: table.tableName,\r\n        index: index,\r\n        tableHeader: table.tableHeader,\r\n        coord: {\r\n          from: [table.tableHeader.longitude, table.tableHeader.latitude],\r\n          to: [\r\n            table.tableHeader.longitude + RND_1,\r\n            table.tableHeader.latitude + RND_2,\r\n            INIT_VIEW.zHeight,\r\n          ],\r\n        },\r\n      })\r\n    })\r\n    setMarkerInfo(markersArr)\r\n  }, [props, INIT_VIEW.zHeight])\r\n\r\n  const layers = [\r\n    new TileLayer({\r\n      data:\r\n        'https://basemaps.cartocdn.com/rastertiles/dark_all/{z}/{x}/{y}.png',\r\n        // 'https://sqhkt-qlqh.tphcm.gov.vn/api/tiles/bandoso/{z}/{x}/{y}',\r\n\r\n      /**\r\n       * \r\n       * TESTS WITH OTHER TILESETS  \r\n       * 'https://api.mapbox.com/v4/mapbox.mapbox-streets-v8/{z}/{x}/{y}.png' +\r\n      '?style=' +\r\n      'mapbox://styles/mapbox/dark-v10' +\r\n      'mapbox://styles/relnox/ck0h5xn701bpr1dqs3he2lecq' +\r\n      'mapbox://styles/relnox/cjs9rb33k2pix1fo833uweyjd' +\r\n      '&access_token=' +\r\n      process.env.REACT_APP_MAPBOX_TOKEN,\r\n\r\n     settings.map.mapStyle.sat,\r\n       'https://c.tile.openstreetmap.org/{z}/{x}/{y}.png',\r\n       */\r\n\r\n      minZoom: 0,\r\n      maxZoom: 19,\r\n      tileSize: 96,\r\n\r\n      renderSubLayers: (props) => {\r\n        const {\r\n          bbox: { west, south, east, north },\r\n        } = props.tile\r\n\r\n        return new BitmapLayer(props, {\r\n          data: null,\r\n          image: props.data,\r\n          _imageCoordinateSystem: COORDINATE_SYSTEM.CARTESIAN,\r\n          bounds: [west, south, east, north],\r\n        })\r\n      },\r\n    }),\r\n\r\n    new LineLayer({\r\n      id: 'LineLayer',\r\n      data: markerInfo,\r\n      pickable: true,\r\n      getWidth: zoom < 2 ? 2 : 0,\r\n      getSourcePosition: (d) => d.coord.from,\r\n      getTargetPosition: (d) => d.coord.to,\r\n      getColor: (d) => [255, 82, 120],\r\n    }),\r\n    new TextLayer({\r\n      id: 'text-layer',\r\n      data: markerInfo,\r\n      pickable: true,\r\n      getPosition: (d) => d.coord.to,\r\n      getText: (d) => d.tableName,\r\n      getColor: [255, 82, 120],\r\n      getSize: zoom < 2 ? 0 : 5,\r\n      getAngle: 0,\r\n      getPixelOffset: [10, 5],\r\n      getTextAnchor: 'start',\r\n      getAlignmentBaseline: 'center',\r\n    }),\r\n    new IconLayer({\r\n      id: 'icon-layer',\r\n      data: markerInfo,\r\n      pickable: true,\r\n      iconAtlas: icon,\r\n      onClick: (d) => {\r\n        setInitialViewState({\r\n          longitude: d.object.coord.to[0],\r\n          latitude: d.object.coord.to[1],\r\n          zoom: 3,\r\n          pitch: 0,\r\n          bearing: 0,\r\n          transitionDuration: 1000,\r\n          transitionInterpolator: new FlyToInterpolator(),\r\n        })\r\n\r\n        setClicked(d)\r\n      },\r\n      iconMapping: {\r\n        marker: { x: 0, y: 0, width: 768, height: 768, mask: false },\r\n      },\r\n      getIcon: (d) => 'marker',\r\n      sizeScale: 1,\r\n      getSize: zoom < 5 ? 30 : 15,\r\n      getPosition: (d) => [d.coord.to[0], d.coord.to[1], INIT_VIEW.zHeight],\r\n    }),\r\n  ]\r\n\r\n  return (\r\n    <>\r\n      {clicked && clicked.object && <SelectedTable clicked={clicked} />}\r\n\r\n      <DeckGL\r\n        views={new GlobeView()}\r\n        onHover={({ object }) => (isHovering = Boolean(object))}\r\n        getCursor={({ isDragging }) =>\r\n          isDragging ? 'grabbing' : isHovering ? 'crosshair' : 'grab'\r\n        }\r\n        layers={layers}\r\n        controller={true}\r\n        initialViewState={initialViewState}\r\n        onViewportChange={setViewport}\r\n        onViewStateChange={(d) => setZoom(d.viewState.zoom)}\r\n        ContextProvider={_MapContext.Provider}\r\n      ></DeckGL>\r\n    </>\r\n  )\r\n}\r\n","import { useEffect, useState } from 'react'\r\nimport CityIOdeckGLmap from './CityIOdeckGLmap/index'\r\n\r\nimport axios from 'axios'\r\nimport settings from '../../settings/settings.json'\r\n\r\nexport default function CityIOlist() {\r\n  const [tableList, setTableList] = useState([])\r\n  const [isLoading, setIsLoading] = useState(true)\r\n  const fetchCityIOtables = async () => {\r\n    // ! https://stackoverflow.com/questions/37213783/waiting-for-all-promises-called-in-a-loop-to-finish\r\n    const cityIOlistURL = settings.cityIO.ListOfTables\r\n    // get all URLs\r\n    const tablesArr = await axios.get(cityIOlistURL)\r\n    // create array of all requests\r\n    const requestArr = tablesArr.data.map(async (tableName) => {\r\n      // const tableName = urlStr.split('/').pop()\r\n\t  const url = `${settings.cityIO.baseURL}${tableName}/`;\r\n      return axios\r\n        .get(`${url}GEOGRID/properties/header/`)\r\n        .then((res) =>\r\n          setTableList((oldArray) => [\r\n            ...oldArray,\r\n            { tableURL: url, tableName: tableName, tableHeader: res.data },\r\n          ]),\r\n        )\r\n        .catch((error) => console.log(error.toString()))\r\n    })\r\n\r\n    Promise.all(requestArr).then(() => {\r\n      return\r\n    })\r\n  }\r\n\r\n  useEffect(() => {\r\n    fetchCityIOtables().then(setIsLoading(false))\r\n  }, [])\r\n\r\n  return <>{!isLoading && <CityIOdeckGLmap cityIOdata={tableList} />}</>\r\n}\r\n","import React, { useState, useEffect } from 'react'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\nexport default function GetGITdate() {\r\n  const [gitMeta, setGitMeta] = useState({\r\n    author: '',\r\n    branch: '',\r\n    date: '',\r\n    sha: '',\r\n    link: '',\r\n  })\r\n\r\n  const URL =\r\n    'https://api.github.com/repos/CityScope/CS_cityscopeJS/branches/master'\r\n\r\n  const fetchGitHub = () =>\r\n    fetch(URL)\r\n      .then((response) => {\r\n        response.json().then((json) => {\r\n          setGitMeta({\r\n            author: json.commit.commit.author.name,\r\n            date: json.commit.commit.author.date,\r\n            sha: json.commit.sha,\r\n          })\r\n        })\r\n      })\r\n      .catch((error) => {\r\n        console.log(error)\r\n      })\r\n  // run only once\r\n  useEffect(() => {\r\n    fetchGitHub()\r\n  }, [])\r\n\r\n  const gitMetaComp = (\r\n    <>\r\n      <Typography color={'primary'} variant={'h5'}>\r\n        CityScopeJS Development Tracking\r\n      </Typography>\r\n      <Typography color={'primary'}>\r\n        Author: {JSON.parse(JSON.stringify(gitMeta.author))}\r\n      </Typography>\r\n      <Typography color={'primary'}>\r\n        Date: {JSON.parse(JSON.stringify(gitMeta.date))}\r\n      </Typography>\r\n      <Typography color={'primary'}>\r\n        Hash: {JSON.parse(JSON.stringify(gitMeta.sha))}\r\n      </Typography>\r\n    </>\r\n  )\r\n\r\n  return gitMetaComp\r\n}\r\n","import {\r\n  Divider,\r\n  Typography,\r\n  makeStyles,\r\n  Card,\r\n  CardContent,\r\n  Link,\r\n} from '@material-ui/core'\r\nimport GitHubIcon from '@material-ui/icons/GitHub'\r\nimport GetGITdate from './GetGITdate'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  divider: {\r\n    margin: theme.spacing(2),\r\n  },\r\n}))\r\nexport default function SplashScreen() {\r\n  const classes = useStyles()\r\n\r\n  return (\r\n    <>\r\n      <Card elevation={15}>\r\n        <CardContent>\r\n          <Typography color=\"textPrimary\" variant=\"h1\">\r\n            MIT CityScope\r\n          </Typography>\r\n\r\n          <Divider className={classes.divider} light />\r\n\r\n          <Typography color=\"textPrimary\" variant=\"h4\">\r\n            MIT CityScope is an open-source urban modeling and simulation\r\n            platform. CityScope allows users to examine different design\r\n            alternatives, and observe their impact through multiple layers of\r\n            urban analytics modules, such as traffic models, ABM simulation,\r\n            urban access, economy, storm-water, noise and more.\r\n          </Typography>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      <Divider className={classes.divider} light />\r\n\r\n      <Card elevation={15}>\r\n        <CardContent position={'bottom'}>\r\n          <Typography color=\"textPrimary\" gutterBottom>\r\n            MIT CityScopeJS open-source project is developed by MIT, the City\r\n            Science Network, and contributers from all over the world.\r\n          </Typography>\r\n\r\n          <Typography>\r\n            <Link\r\n              color={'secondary'}\r\n              href={'https://github.com/CityScope'}\r\n              target={'blank'}\r\n            >\r\n              <GitHubIcon fontSize={'small'} /> Join the CityScope open-source\r\n              development\r\n            </Link>\r\n          </Typography>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      <Divider className={classes.divider} light />\r\n\r\n      <Card elevation={15}>\r\n        <CardContent position={'bottom'}>\r\n          <Typography color=\"textPrimary\" gutterBottom>\r\n            Map view is provided via CityIO, CityScope server.\r\n          </Typography>\r\n          <Typography>\r\n            <Link\r\n              color={'secondary'}\r\n              href={'https://github.com/CityScope/CS_CityIO'}\r\n              target={'blank'}\r\n            >\r\n              <GitHubIcon fontSize={'small'} />{' '}\r\n              https://github.com/CityScope/CS_CityIO\r\n            </Link>\r\n          </Typography>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      <Divider className={classes.divider} light />\r\n\r\n      <Card elevation={15}>\r\n        <CardContent position={'bottom'}>\r\n          <GetGITdate />\r\n        </CardContent>\r\n      </Card>\r\n    </>\r\n  )\r\n}\r\n","import { makeStyles, Container } from '@material-ui/core'\r\nimport CityIOlist from './CityIOlist'\r\nimport Page from '../../layouts/Page'\r\nimport SplashScreen from './SplashScreen'\r\n\r\nexport default function CityIOviewer() {\r\n  const useStyles = makeStyles((theme) => ({\r\n    root: {\r\n      '& > *': {\r\n        margin: 'auto',\r\n        height: '100%',\r\n        padding: theme.spacing(3),\r\n      },\r\n    },\r\n    fixedPosition: {\r\n      position: 'relative',\r\n      zIndex: 100,\r\n    },\r\n  }))\r\n\r\n  const classes = useStyles()\r\n  return (\r\n    <>\r\n      <Page className={classes.root} title=\"CityScope Projects List\">\r\n        <div\r\n          style={{\r\n            height: '50vh',\r\n            width: '100%',\r\n            position: 'relative',\r\n          }}\r\n        >\r\n          <CityIOlist />\r\n        </div>\r\n\r\n        <Container className={classes.fixedPosition}>\r\n          <SplashScreen />\r\n        </Container>\r\n      </Page>\r\n    </>\r\n  )\r\n}\r\n","import settings from \"../settings/settings.json\";\r\n\r\n/**\r\n * ! INIT STATE\r\n */\r\nconst listOfToggles = Object.keys(settings.menu.toggles);\r\nlet menuInitState = [];\r\nfor (let i = 0; i < listOfToggles.length; i++) {\r\n    if (Object.values(settings.menu.toggles)[i].showOnInit) {\r\n        menuInitState.push(listOfToggles[i]);\r\n    }\r\n}\r\n\r\nconst initialState = {\r\n    MENU: menuInitState,\r\n    CITYIO: {},\r\n    SCENARIO_NAMES: [],\r\n    MAP: {},\r\n    LOADING_MODULES: [],\r\n    SLIDERS: {\r\n        time: [\r\n            settings.map.layers.ABM.startSimHour,\r\n            settings.map.layers.ABM.currentSimHour,\r\n            settings.map.layers.ABM.endSimHour,\r\n        ],\r\n        speed: settings.map.layers.ABM.animationSpeed,\r\n    },\r\n    ABM_MODE: \"mode\",\r\n    ACCESS_TOGGLE: 0,\r\n    SELECTED_TYPE: null,\r\n    READY: false,\r\n    LOADING: false,\r\n    CURRENT_VIEW_OPTION: \"\",\r\n    /**\r\n     * ! EDITOR INIT STATE\r\n     */\r\n\r\n    ROW_EDIT: null,\r\n    BASE_MAP_CENTER: {\r\n        latCenter: null,\r\n        lonCenter: null,\r\n    },\r\n    TYPES_LIST: null,\r\n    GRID_CREATED: null,\r\n};\r\n\r\nexport default initialState;\r\n","import React from \"react\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { Typography, Box } from \"@material-ui/core\";\r\nimport LinearProgress from \"@material-ui/core/LinearProgress\";\r\n\r\n\r\nconst LoadingSpinner = () => {\r\n    const [loadingModules] = useSelector((state) => [state.LOADING_MODULES]);\r\n\r\n    return (\r\n        <>\r\n            {loadingModules.map((module, index) => {\r\n                return (\r\n                    <Box\r\n                        position=\"fixed\"\r\n                        bottom={index * 50}\r\n                        right=\"2vw\"\r\n                        width=\"10vw\"\r\n                        zIndex=\"101\"\r\n                        margin=\"0\"\r\n                        key={module}\r\n                    >\r\n                        <LinearProgress color={'secondary'} />\r\n                        <Typography\r\n                            variant=\"h6\"\r\n                            color=\"primary\"\r\n                            style={{ marginRight: \"10px\" }}\r\n                        >\r\n                            {module}\r\n                        </Typography>\r\n                    </Box>\r\n                );\r\n            })}\r\n        </>\r\n    );\r\n};\r\n\r\nexport default LoadingSpinner;\r\n","import {\r\n  GET_CITYIO_DATA,\r\n  MENU_INTERACTION,\r\n  LISTEN_TO_MAP_EVENTS,\r\n  LISTEN_TO_ABM_SLIDERS,\r\n  LISTEN_TO_EDIT_MENU,\r\n  SET_READY_STATE,\r\n  SET_LOADING_STATE,\r\n  SET_SCENARIO_NAMES,\r\n  LISTEN_TO_ACCESS_TOGGLE,\r\n  LISTEN_TO_ROW_EDIT,\r\n  LISTEN_TO_TYPES_LIST,\r\n  LISTEN_TO_GRID_CREATOR,\r\n  LISTEN_TO_BASE_MAP_CENTER,\r\n  LISTEN_TO_ABM_MODE,\r\n  ADD_LOADING_MODULES,\r\n  REMOVE_LOADING_MODULES,\r\n  SET_UI_WEBSOCKET_DATA,\r\n  SET_UI_WEBSOCKET_READY,\r\n  SET_CURRENT_VIEW_OPTION\r\n} from './actions'\r\nimport initialState from './initialState'\r\n\r\n/**\r\n * REDUCER\r\n */\r\nexport default function reducer(state = initialState, action) {\r\n  switch (action.type) {\r\n    case GET_CITYIO_DATA:\r\n      return { ...state, CITYIO: action.data }\r\n    case MENU_INTERACTION:\r\n      return { ...state, MENU: action.data }\r\n    case LISTEN_TO_MAP_EVENTS:\r\n      return { ...state, MAP: action.data }\r\n    case LISTEN_TO_ABM_SLIDERS:\r\n      return { ...state, SLIDERS: action.data }\r\n    case LISTEN_TO_ABM_MODE:\r\n      return { ...state, ABM_MODE: action.data }\r\n    case LISTEN_TO_ACCESS_TOGGLE:\r\n      return { ...state, ACCESS_TOGGLE: action.data }\r\n    case LISTEN_TO_EDIT_MENU:\r\n      return { ...state, SELECTED_TYPE: action.data }\r\n    case SET_READY_STATE:\r\n      return { ...state, READY: action.data }\r\n    case SET_LOADING_STATE:\r\n      return { ...state, LOADING: action.data }\r\n    case SET_SCENARIO_NAMES:\r\n      return { ...state, SCENARIO_NAMES: action.data }\r\n    case ADD_LOADING_MODULES:\r\n      return {\r\n        ...state,\r\n        LOADING_MODULES: [\r\n          ...new Set([...state.LOADING_MODULES, ...action.data]),\r\n        ],\r\n      }\r\n    case REMOVE_LOADING_MODULES:\r\n      return {\r\n        ...state,\r\n        LOADING_MODULES: state.LOADING_MODULES.filter(\r\n          (x) => !action.data.includes(x),\r\n        ),\r\n      }\r\n\r\n    /**\r\n     * PROJECTION MAPPING Actions\r\n     */\r\n    case SET_UI_WEBSOCKET_DATA:\r\n      return { ...state, UI_WEBSOCKET_DATA: action.data }\r\n\r\n    case SET_UI_WEBSOCKET_READY:\r\n      return { ...state, UI_WEBSOCKET_READY: action.data }\r\n\r\n    /**\r\n     * Editor Actions\r\n     */\r\n\r\n    case LISTEN_TO_ROW_EDIT:\r\n      return { ...state, ROW_EDIT: action.data }\r\n\r\n    case LISTEN_TO_TYPES_LIST:\r\n      return { ...state, TYPES_LIST: action.data }\r\n\r\n    case LISTEN_TO_GRID_CREATOR:\r\n      return { ...state, GRID_CREATED: action.data }\r\n\r\n    case LISTEN_TO_BASE_MAP_CENTER:\r\n      return { ...state, BASE_MAP_CENTER: action.data }\r\n    case SET_CURRENT_VIEW_OPTION:\r\n      console.log('action.data',action.data);\r\n      return { ...state, CURRENT_VIEW_OPTION: action.data }\r\n    default:\r\n      return state\r\n  }\r\n}\r\n","import { createStore } from \"redux\";\r\nimport reducer from \"./reducer\";\r\n\r\nconst reduxDevTools =\r\n    window.__REDUX_DEVTOOLS_EXTENSION__ &&\r\n    window.__REDUX_DEVTOOLS_EXTENSION__();\r\n\r\nconst configureStore = () => {\r\n    const store = createStore(reducer, reduxDevTools);\r\n\r\n    if (process.env.NODE_ENV !== \"production\") {\r\n        if (module.hot) {\r\n            module.hot.accept(\"./reducer\", () => {\r\n                store.replaceReducer(reducer);\r\n            });\r\n        }\r\n    }\r\n\r\n    return store;\r\n};\r\n\r\nconst store = configureStore();\r\n\r\nexport default store;\r\n","import axios from 'axios'\r\nimport { addLoadingModules } from '../redux/actions'\r\nimport store from '../redux/store'\r\nimport settings from '../settings/settings.json'\r\nimport { LightingEffect, AmbientLight, _SunLight } from '@deck.gl/core'\r\n\r\n/**\r\n * conver rgb to hex\r\n */\r\nexport function rgbToHex(r, g, b) {\r\n  function valToHex(c) {\r\n    var hex = c.toString(16)\r\n    return hex.length === 1 ? '0' + hex : hex\r\n  }\r\n  return '#' + valToHex(r) + valToHex(g) + valToHex(b)\r\n}\r\n\r\n/**\r\n * conver hex to rgb array\r\n */\r\nexport function hexToRgb(hex) {\r\n  var result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex)\r\n  return result\r\n    ? [\r\n        parseInt(result[1], 16),\r\n        parseInt(result[2], 16),\r\n        parseInt(result[3], 16),\r\n      ]\r\n    : null\r\n}\r\n\r\n/**\r\n *\r\n * @param {string} hexString test if vaild 3->6 HEX color\r\n */\r\nexport const testHex = (hexString) => {\r\n  let isHex = /^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/i.test(hexString)\r\n  return isHex\r\n}\r\n\r\n/**\r\n * Description. gets `props` with geojson\r\n * and procces the interactive area\r\n */\r\nexport const _proccessGridData = (cityioData) => {\r\n  // get the static grid\r\n  const GEOGRID = cityioData.GEOGRID\r\n  // if GEOGRRIDDATA exist and is the same length as our grid\r\n  if (\r\n    cityioData.GEOGRIDDATA &&\r\n    cityioData.GEOGRIDDATA.length === cityioData.GEOGRID.features.length\r\n  ) {\r\n    // get the grid data\r\n    const GEOGRIDDATA = cityioData.GEOGRIDDATA\r\n    // update GEOGRID features from GEOGRIDDATA on cityio\r\n    for (let i = 0; i < GEOGRID.features.length; i++) {\r\n      GEOGRID.features[i].properties = GEOGRIDDATA[i]\r\n\r\n      // inject id\r\n      GEOGRID.features[i].properties.id = i\r\n    }\r\n  }\r\n  const newGrid = JSON.parse(JSON.stringify(GEOGRID))\r\n  return newGrid\r\n}\r\n\r\n/**\r\n * Description. gets `props` with geojson\r\n * and procces the access layer data\r\n */\r\nexport const _proccessAccessData = (accessData) => {\r\n  // get colors from settings\r\n  let coordinates = accessData.features.map((d) => d.geometry.coordinates)\r\n  let values = accessData.features.map((d) => d.properties)\r\n  let heatmap = []\r\n  for (let i = 0; i < coordinates.length; i++) {\r\n    heatmap.push({\r\n      coordinates: coordinates[i],\r\n      values: values[i],\r\n    })\r\n  }\r\n  return heatmap\r\n}\r\n\r\n/**\r\n * checks if edits are done (toggled off)\r\n * than returns a redux state\r\n * with grid edits payload\r\n */\r\nexport const _postMapEditsToCityIO = (data, tableName, endPoint) => {\r\n  const expectUpdateModules = new Set(\r\n    settings.cityIO.cityIOmodules\r\n      .filter((val) => val.expectUpdate)\r\n      .map((val) => val.name),\r\n  )\r\n  const cityIOKeys = new Set(Object.keys(store.getState().CITYIO))\r\n\r\n  const loadingModules = [...cityIOKeys].filter((i) =>\r\n    expectUpdateModules.has(i),\r\n  )\r\n\r\n  let postURL = settings.cityIO.baseURL + tableName + endPoint\r\n\r\n  const options = {\r\n    method: 'post',\r\n    url: postURL,\r\n    data: data,\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      Accept: 'application/json',\r\n    },\r\n  }\r\n  axios(options)\r\n    .then((res) => {\r\n      if (res.data.status === 'ok') {\r\n        store.dispatch(addLoadingModules(loadingModules))\r\n      }\r\n    })\r\n    .catch((error) => {\r\n      console.log('ERROR:', error)\r\n    })\r\n}\r\n\r\n// /**\r\n//  * Description. uses deck api to\r\n//  * collect objects in a region\r\n//  * @argument{object} e  picking event\r\n//  */\r\nexport const _multipleObjPicked = (e, pickingRadius, deckGLRef) => {\r\n  const dim = pickingRadius\r\n  const x = e.x - dim / 2\r\n  const y = e.y - dim / 2\r\n  let multipleObj = deckGLRef.current.pickObjects({\r\n    x: x,\r\n    y: y,\r\n    width: dim,\r\n    height: dim,\r\n  })\r\n  return multipleObj\r\n}\r\n\r\n// /**\r\n//  * Description. allow only to pick cells that are\r\n//  *  not of CityScope TUI & that are interactable\r\n//  * so to not overlap TUI activity\r\n//  */\r\nexport const _handleGridcellEditing = (\r\n  e,\r\n  selectedType,\r\n  setSelectedCellsState,\r\n  pickingRadius,\r\n  deckGLRef,\r\n) => {\r\n  const { height, color, name } = selectedType\r\n  const multiSelectedObj = _multipleObjPicked(e, pickingRadius, deckGLRef)\r\n  multiSelectedObj.forEach((selected) => {\r\n    const thisCellProps = selected.object.properties\r\n    if (thisCellProps && thisCellProps.interactive) {\r\n      thisCellProps.color = testHex(color) ? hexToRgb(color) : color\r\n      thisCellProps.height = height\r\n      thisCellProps.name = name\r\n    }\r\n  })\r\n  setSelectedCellsState(multiSelectedObj)\r\n}\r\n\r\nvar currentDateMidnight = new Date()\r\n// set initial midnight to GMT 0\r\ncurrentDateMidnight.setHours(0, 0, 0, 0)\r\n\r\nexport const _setupSunEffects = (effectsRef, tableHeader) => {\r\n  // get time zone from the tz value if exist\r\n  if (tableHeader.tz) {\r\n    currentDateMidnight.setHours(tableHeader.tz, 0, 0, 0)\r\n  }\r\n  const ambientLight = new AmbientLight({\r\n    color: [255, 255, 255],\r\n    intensity: 0.85,\r\n  })\r\n  const dirLight = new _SunLight({\r\n    timestamp: 0,\r\n    color: [255, 255, 255],\r\n    intensity: 1.0,\r\n    _shadow: true,\r\n  })\r\n  const lightingEffect = new LightingEffect({ ambientLight, dirLight })\r\n  lightingEffect.shadowColor = [0, 0, 0, 0.5]\r\n  effectsRef.current = [lightingEffect]\r\n}\r\n\r\nexport const updateSunDirection = (time, effectsRef) => {\r\n  const thisLocationTime = currentDateMidnight.getTime() + time * 1000\r\n  var date = new Date(thisLocationTime)\r\n\r\n  effectsRef.current[0].directionalLights[0].timestamp = Date.UTC(\r\n    date.getFullYear(),\r\n    date.getMonth(),\r\n    date.getDay(),\r\n    date.getHours(),\r\n    date.getMinutes(),\r\n    date.getSeconds(),\r\n  )\r\n}\r\n","import React, { useState } from \"react\";\r\nimport { RadialChart, Hint } from \"react-vis\";\r\nimport { Typography } from \"@material-ui/core\";\r\n\r\nexport default function TypeInfo(props) {\r\n    const COLOR_SCALE = [\"#85C4C8\", \"#C22E00\", \"#1E96BE\", \"#EC9370\", \"#F6D18A\"];\r\n\r\n    const radialRadius = 50;\r\n    const [hoveredRadial, setHoveredRadial] = useState(false);\r\n\r\n    // method to create data for radial chart\r\n    const careateData = () => {\r\n        // array for data\r\n        let data = [];\r\n        // check type info: if string, parse, else object\r\n        let info = props.typeInfo;\r\n        // get the type data\r\n        info.forEach((attr, index) => {\r\n            data.push({\r\n                angle: attr.proportion,\r\n                label: JSON.stringify(attr.use),\r\n                color: COLOR_SCALE[index],\r\n            });\r\n        });\r\n\r\n        return data;\r\n    };\r\n\r\n    const data = careateData();\r\n\r\n    /*\r\n    const boxStyle = { height: \"10px\", width: \"10px\" };\r\n\r\n    function buildValue(hoveredCell) {\r\n        const { radius, angle, angle0 } = hoveredCell;\r\n        const truedAngle = (angle + angle0) / 2;\r\n        return {\r\n            x: radius * Math.cos(truedAngle),\r\n            y: radius * Math.sin(truedAngle),\r\n        };\r\n    }\r\n    */\r\n\r\n    return (\r\n        <>\r\n            <RadialChart\r\n                colorType=\"literal\"\r\n                animation={true}\r\n                className={\"donut-chart-example\"}\r\n                innerRadius={radialRadius / 2 - radialRadius / 5}\r\n                radius={radialRadius / 2}\r\n                getLabel={(d) => d.label}\r\n                showLabels={false}\r\n                getAngle={(d) => d.angle}\r\n                data={data}\r\n                onValueMouseOver={(evt) => {\r\n                    setHoveredRadial(evt);\r\n                }}\r\n                onSeriesMouseOut={() => setHoveredRadial(false)}\r\n                width={radialRadius}\r\n                height={radialRadius}\r\n                padAngle={0.1}\r\n            >\r\n                {hoveredRadial !== false && (\r\n                    <Hint value={hoveredRadial}>\r\n                        <div\r\n                            style={{\r\n                                background: \"rgba(0,0,0,0.8)\",\r\n                                fontSize: 10,\r\n                            }}\r\n                        >\r\n                            <Typography variant={\"caption\"} gutterBottom>\r\n                                {hoveredRadial.label}\r\n                            </Typography>\r\n                        </div>\r\n                    </Hint>\r\n                )}\r\n            </RadialChart>\r\n        </>\r\n    );\r\n}\r\n","import React from \"react\";\r\nimport Slider from \"@material-ui/core/Slider\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport List from \"@material-ui/core/List\";\r\nimport {\r\n    Collapse,\r\n    Typography,\r\n    CardContent,\r\n    Box,\r\n    Avatar,\r\n    ListItemAvatar,\r\n    ListItem,\r\n    ListItemText,\r\n    Grid,\r\n    Card,\r\n} from \"@material-ui/core\";\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport { listenToEditMenu } from \"../../../../redux/actions\";\r\nimport { connect } from \"react-redux\";\r\nimport { testHex, hexToRgb } from \"../../../../utils/utils\";\r\nimport TypeInfo from \"./TypeInfo\";\r\n\r\nfunction EditMenu(props) {\r\n    const [selectedIndex, setSelectedIndex] = React.useState(null);\r\n    const dispatch = useDispatch();\r\n    let selectedType = useSelector((state) => state.SELECTED_TYPE);\r\n    const height = selectedType ? selectedType.height : null;\r\n\r\n    const marks = [\r\n        { value: 0, label: \"min\" },\r\n        { value: 100, label: \"max\" },\r\n    ];\r\n\r\n    const handleListItemClick = (event, name, typeProps) => {\r\n        // ! injects the type name into the attributes themselves\r\n        typeProps.name = name;\r\n        setSelectedIndex(name);\r\n        dispatch(listenToEditMenu(typeProps));\r\n    };\r\n\r\n    const parseTypeInfo = (typeInfo) => {\r\n        //! check type info: if string, parse, else object\r\n        let info =\r\n            typeof typeInfo == \"string\" ? JSON.parse(typeInfo) : typeInfo;\r\n        return info;\r\n    };\r\n\r\n    // create the types themselves\r\n    const createTypesIcons = (LanduseTypesList) => {\r\n        let iconsArr = [];\r\n        Object.keys(LanduseTypesList).forEach((type, index) => {\r\n            // get type description if exist\r\n            let description = LanduseTypesList[type].description\r\n                ? LanduseTypesList[type].description\r\n                : null;\r\n\r\n            let col = LanduseTypesList[type].color;\r\n            // get the LBCS/NAICS types info\r\n            let LBCS = parseTypeInfo(\r\n                props.cityioData.GEOGRID.properties.types[type].LBCS\r\n            );\r\n            let NAICS = parseTypeInfo(\r\n                props.cityioData.GEOGRID.properties.types[type].NAICS\r\n            );\r\n\r\n            if (testHex(col)) {\r\n                col = hexToRgb(col);\r\n            }\r\n            let rgbCol = \"rgb(\" + col[0] + \",\" + col[1] + \",\" + col[2] + \")\";\r\n            const selected = selectedIndex === type;\r\n            let typeHasHeightProps = false;\r\n            if (LanduseTypesList[type].height) {\r\n                typeHasHeightProps = true;\r\n            }\r\n\r\n            iconsArr.push(\r\n                <div key={Math.random()}>\r\n                    <ListItem\r\n                        alignItems=\"flex-start\"\r\n                        button\r\n                        variant=\"raised\"\r\n                        selected={selected}\r\n                        onClick={(event) =>\r\n                            handleListItemClick(\r\n                                event,\r\n                                type,\r\n                                LanduseTypesList[type]\r\n                            )\r\n                        }\r\n                    >\r\n                        <ListItemAvatar>\r\n                            <Avatar\r\n                                style={{\r\n                                    backgroundColor: rgbCol,\r\n                                    color: \"black\",\r\n                                }}\r\n                            >\r\n                                {type.charAt(0)}\r\n                            </Avatar>\r\n                        </ListItemAvatar>\r\n\r\n                        <ListItemText primary={type} />\r\n                    </ListItem>\r\n\r\n                    <Collapse in={selected}>\r\n                        <Box spacing={1} p={1} m={1}>\r\n                            <Card elevation={15}>\r\n                                <CardContent>\r\n                                    <Typography variant=\"h5\">\r\n                                        Type Information\r\n                                    </Typography>\r\n\r\n                                    {description && (\r\n                                        <Typography variant=\"caption\">\r\n                                            {description}\r\n                                        </Typography>\r\n                                    )}\r\n                                    <Box spacing={1} p={1} m={1} />\r\n                                    <Grid container spacing={3}>\r\n                                        <Grid\r\n                                            item\r\n                                            xs={6}\r\n                                            l={6}\r\n                                            md={6}\r\n                                            xl={6}\r\n                                            container\r\n                                        >\r\n                                            {LBCS && (\r\n                                                <>\r\n                                                    <Typography variant=\"caption\">\r\n                                                        LBCS\r\n                                                    </Typography>\r\n\r\n                                                    <TypeInfo typeInfo={LBCS} />\r\n                                                </>\r\n                                            )}\r\n                                        </Grid>\r\n                                        <Grid\r\n                                            item\r\n                                            xs={6}\r\n                                            l={6}\r\n                                            md={6}\r\n                                            xl={6}\r\n                                            container\r\n                                        >\r\n                                            {NAICS && (\r\n                                                <>\r\n                                                    <Typography variant=\"caption\">\r\n                                                        NAICS\r\n                                                    </Typography>\r\n                                                    <TypeInfo\r\n                                                        typeInfo={NAICS}\r\n                                                    />\r\n                                                </>\r\n                                            )}\r\n                                        </Grid>\r\n\r\n                                        {typeHasHeightProps && (\r\n                                            <>\r\n                                                <Grid\r\n                                                    item\r\n                                                    xs={10}\r\n                                                    l={10}\r\n                                                    md={10}\r\n                                                    xl={10}\r\n                                                    container\r\n                                                >\r\n                                                    <Typography gutterBottom>\r\n                                                        Set Height\r\n                                                    </Typography>\r\n\r\n                                                    <Slider\r\n                                                        value={height}\r\n                                                        valueLabelDisplay=\"auto\"\r\n                                                        onChange={(\r\n                                                            event,\r\n                                                            value\r\n                                                        ) =>\r\n                                                            dispatch(\r\n                                                                listenToEditMenu(\r\n                                                                    {\r\n                                                                        ...selectedType,\r\n                                                                        height: value,\r\n                                                                    }\r\n                                                                )\r\n                                                            )\r\n                                                        }\r\n                                                        getAriaLabel={(index) =>\r\n                                                            index.toString()\r\n                                                        }\r\n                                                        min={marks[0].value}\r\n                                                        max={marks[1].value}\r\n                                                        marks={marks}\r\n                                                    />\r\n                                                </Grid>\r\n                                            </>\r\n                                        )}\r\n                                    </Grid>\r\n                                </CardContent>\r\n                            </Card>\r\n                        </Box>\r\n                    </Collapse>\r\n\r\n                    <Divider />\r\n                </div>\r\n            );\r\n        });\r\n        return <List>{iconsArr}</List>;\r\n    };\r\n\r\n    return <>{createTypesIcons(props.cityioData.GEOGRID.properties.types)}</>;\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n    return {\r\n        cityioData: state.CITYIO,\r\n    };\r\n};\r\n\r\nexport default connect(mapStateToProps, null)(EditMenu);\r\n","import { makeStyles } from \"@material-ui/core/styles\";\r\n\r\nexport const useStyles = makeStyles({\r\n    root: {\r\n        width: \"80%\",\r\n        marginLeft: 28,\r\n    },\r\n    subtitle1: {\r\n        marginTop: 12,\r\n    },\r\n    subtitle2: {\r\n        marginTop: 12,\r\n    },\r\n});\r\n","import React from \"react\";\r\nimport { DiscreteColorLegend } from \"react-vis\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\n\r\n// ! https://github.com/uber/react-vis/blob/premodern/showcase/legends/searchable-discrete-color.js\r\n\r\nexport default function ABMLegend(props) {\r\n    const tripsAttr = props.trips.tripsData;\r\n    const modes = tripsAttr.mode;\r\n    const profiles = tripsAttr.profile;\r\n\r\n    const prepareLegendData = (string) => {\r\n        let data = string === \"mode\" ? modes : profiles;\r\n\r\n        let legendData = [];\r\n        for (const key in data) {\r\n            legendData.push({ title: data[key].name, color: data[key].color });\r\n        }\r\n        return legendData;\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <Typography variant=\"h6\" gutterBottom>\r\n                {props.tripTypeValue === \"mode\" ? \"Mode Choise\" : \"Profiles \"}\r\n            </Typography>\r\n            <DiscreteColorLegend\r\n                height={300}\r\n                width={150}\r\n                items={prepareLegendData(props.tripTypeValue)}\r\n            />\r\n        </>\r\n    );\r\n}\r\n","import React from \"react\";\r\nimport { useStyles } from \"./styles\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport Slider from \"@material-ui/core/Slider\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport {\r\n    listenToSlidersEvents,\r\n    listenToABMmode,\r\n} from \"../../../../../redux/actions\";\r\nimport ABMLegend from \"./ABMLegend\";\r\n\r\nimport Radio from \"@material-ui/core/Radio\";\r\nimport RadioGroup from \"@material-ui/core/RadioGroup\";\r\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\n\r\nconst marks = [\r\n    {\r\n        value: 0,\r\n        label: \"12AM\",\r\n    },\r\n    {\r\n        value: 21600,\r\n        label: \"6AM\",\r\n    },\r\n    {\r\n        value: 43200,\r\n        label: \"12PM\",\r\n    },\r\n    {\r\n        value: 64800,\r\n        label: \"6PM\",\r\n    },\r\n    {\r\n        value: 86400,\r\n        label: \"12AM\",\r\n    },\r\n];\r\n\r\nfunction ABMSubmenu(props) {\r\n    const classes = useStyles();\r\n    const sliders = useSelector((state) => state.SLIDERS);\r\n    const dispatch = useDispatch();\r\n\r\n    const handleSetTimeValue = (e, newValue) => {\r\n        dispatch(\r\n            listenToSlidersEvents({\r\n                ...sliders,\r\n                time: newValue,\r\n            })\r\n        );\r\n    };\r\n\r\n    const handleSetSpeedValue = (e, newValue) => {\r\n        dispatch(\r\n            listenToSlidersEvents({\r\n                ...sliders,\r\n                speed: newValue,\r\n            })\r\n        );\r\n    };\r\n\r\n    const [tripTypeValue, settripTypeValue] = React.useState(\"mode\");\r\n\r\n    const handleABMmodeChange = (event) => {\r\n        dispatch(listenToABMmode(event.target.value));\r\n        settripTypeValue(event.target.value);\r\n    };\r\n\r\n    return (\r\n        <div className={classes.root}>\r\n            <FormControl component=\"fieldset\">\r\n                <RadioGroup\r\n                    aria-label=\"tripType\"\r\n                    name=\"tripType\"\r\n                    value={tripTypeValue}\r\n                    onChange={handleABMmodeChange}\r\n                >\r\n                    <FormControlLabel\r\n                        value=\"mode\"\r\n                        control={<Radio />}\r\n                        label=\"Mode Choice\"\r\n                    />\r\n                    <FormControlLabel\r\n                        value=\"profile\"\r\n                        control={<Radio />}\r\n                        label=\"Profile\"\r\n                    />\r\n                </RadioGroup>\r\n            </FormControl>\r\n\r\n            <ABMLegend trips={props} tripTypeValue={tripTypeValue} />\r\n            <Typography\r\n                className={classes.subtitle1}\r\n                variant=\"subtitle2\"\r\n                id=\"range-slider\"\r\n                gutterBottom\r\n            >\r\n                Simulation Range\r\n            </Typography>\r\n            <Slider\r\n                min={0}\r\n                max={86400}\r\n                marks={marks}\r\n                value={sliders.time}\r\n                onChange={handleSetTimeValue}\r\n                valueLabelDisplay=\"off\"\r\n                aria-labelledby=\"range-slider\"\r\n            />\r\n            <Typography\r\n                className={classes.subtitle2}\r\n                variant=\"subtitle2\"\r\n                id=\"continuous-slider\"\r\n                gutterBottom\r\n            >\r\n                Simulation Speed\r\n            </Typography>\r\n            <Slider\r\n                min={0}\r\n                max={100}\r\n                value={sliders.speed}\r\n                onChange={handleSetSpeedValue}\r\n                valueLabelDisplay=\"auto\"\r\n                aria-labelledby=\"continuous-slider\"\r\n            />\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default ABMSubmenu;\r\n","import { makeStyles } from \"@material-ui/core/styles\";\r\n\r\nexport const useStyles = makeStyles({\r\n    root: {\r\n        width: \"80%\",\r\n        marginLeft: 28,\r\n    },\r\n    subtitle1: {\r\n        marginTop: 12,\r\n    },\r\n    subtitle2: {\r\n        marginTop: 12,\r\n    },\r\n});\r\n","import React from \"react\";\r\nimport { useStyles } from \"./styles\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport Slider from \"@material-ui/core/Slider\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport { listenToSlidersEvents } from \"../../../../../redux/actions\";\r\n\r\nfunction ShadowSubmenu() {\r\n    const classes = useStyles();\r\n\r\n    const sliders = useSelector((state) => state.SLIDERS);\r\n\r\n    const dispatch = useDispatch();\r\n\r\n    const handleSetTimeValue = (e, newValue) => {\r\n        dispatch(\r\n            listenToSlidersEvents({\r\n                ...sliders,\r\n                time: newValue,\r\n            })\r\n        );\r\n    };\r\n\r\n    const marks = [\r\n        {\r\n            value: 0,\r\n            label: \"12AM\",\r\n        },\r\n        {\r\n            value: 21600,\r\n            label: \"6AM\",\r\n        },\r\n        {\r\n            value: 43200,\r\n            label: \"12PM\",\r\n        },\r\n        {\r\n            value: 64800,\r\n            label: \"6PM\",\r\n        },\r\n        {\r\n            value: 86400,\r\n            label: \"12AM\",\r\n        },\r\n    ];\r\n\r\n    return (\r\n        <div className={classes.root}>\r\n            <Typography\r\n                className={classes.subtitle1}\r\n                variant=\"subtitle2\"\r\n                id=\"range-slider\"\r\n                gutterBottom\r\n            >\r\n                Time of day\r\n            </Typography>\r\n            <Slider\r\n                min={0}\r\n                max={86400}\r\n                marks={marks}\r\n                value={sliders.time}\r\n                onChange={handleSetTimeValue}\r\n                valueLabelDisplay=\"off\"\r\n                aria-labelledby=\"range-slider\"\r\n            />\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default ShadowSubmenu;\r\n","import React from \"react\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport List from \"@material-ui/core/List\";\r\nimport ListItem from \"@material-ui/core/ListItem\";\r\nimport ListItemText from \"@material-ui/core/ListItemText\";\r\nimport ListItemSecondaryAction from \"@material-ui/core/ListItemSecondaryAction\";\r\nimport { listenToAccessToggle } from \"../../../../../redux/actions\";\r\nimport Switch from \"@material-ui/core/Switch\";\r\nimport { ContinuousColorLegend } from \"react-vis\";\r\n\r\nimport settings from \"../../../../../settings/settings.json\";\r\n\r\nfunction AccessSubmenu(props) {\r\n    const accessToggle = useSelector((state) => state.ACCESS_TOGGLE);\r\n\r\n    const { cityioData } = props;\r\n\r\n    const ACCESS_PROPERTIES =\r\n        cityioData && cityioData.access && cityioData.access.properties\r\n            ? cityioData.access.properties\r\n            : [];\r\n\r\n    const dispatch = useDispatch();\r\n    const c = settings.map.layers.heatmap.colors;\r\n    const l = c.length - 1;\r\n    return (\r\n        <List>\r\n            <ListItem>\r\n                <ContinuousColorLegend\r\n                    width={500}\r\n                    startColor={\r\n                        \"rgb(\" + c[0][0] + \",\" + c[0][1] + \",\" + c[0][2] + \")\"\r\n                    }\r\n                    endColor={\r\n                        \"rgb(\" + c[l][0] + \",\" + c[l][1] + \",\" + c[l][2] + \")\"\r\n                    }\r\n                    startTitle=\"No Access\"\r\n                    endTitle=\"Full Access\"\r\n                />\r\n            </ListItem>\r\n            {ACCESS_PROPERTIES.map((p, i) => (\r\n                <ListItem key={p}>\r\n                    <ListItemText\r\n                        primary={p}\r\n                        style={{ textTransform: \"capitalize\" }}\r\n                    />\r\n                    <ListItemSecondaryAction>\r\n                        <Switch\r\n                            edge=\"end\"\r\n                            checked={accessToggle === i}\r\n                            onChange={() => {\r\n                                dispatch(listenToAccessToggle(i));\r\n                            }}\r\n                        />\r\n                    </ListItemSecondaryAction>\r\n                </ListItem>\r\n            ))}\r\n        </List>\r\n    );\r\n}\r\n\r\nexport default AccessSubmenu;\r\n","import React from \"react\";\r\nimport { useSelector } from \"react-redux\";\r\nimport List from \"@material-ui/core/List\";\r\nimport ListItem from \"@material-ui/core/ListItem\";\r\nimport ListItemText from \"@material-ui/core/ListItemText\";\r\nimport settings from \"../../../../settings/settings.json\";\r\nimport Collapse from \"@material-ui/core/Collapse\";\r\nimport ABMSubmenu from \"./ABMSubmenu\";\r\nimport ShadowSubmenu from \"./ShadowSubmenu\";\r\nimport AccessSubmenu from \"./AccessSubmenu\";\r\nimport Switch from \"@material-ui/core/Switch\";\r\n\r\nfunction TogglesMenu(props) {\r\n    const { handleToggle } = props;\r\n        const { menuState, cityioData } = useSelector((state) => ({\r\n        menuState: state.MENU,\r\n        cityioData: state.CITYIO,\r\n    }));\r\n\r\n    const togglesMeta = settings.menu.toggles;\r\n    const listOfToggles = Object.keys(togglesMeta);\r\n    // console.log('listOfToggles',listOfToggles);\r\n    // console.log('menuState',menuState);\r\n    // console.log('cityioData',cityioData);\r\n    /**\r\n     * gets props with initial menu state\r\n     * and turn on the layer on init\r\n     */\r\n    let togglesCompsArray = [];\r\n    // array of loaded API modules\r\n    const loadedModules = Object.keys(cityioData);\r\n    // create each toggle\r\n    for (let i = 0; i < listOfToggles.length; i++) {\r\n        // check if the mdoule of this toggle\r\n        // was loaded on the API\r\n        let requireModule = togglesMeta[listOfToggles[i]].requireModule;\r\n\r\n        const checked = menuState.includes(listOfToggles[i]) ? true : false;\r\n\r\n        if (loadedModules.includes(requireModule) || requireModule === false) {\r\n            const thisToggle = (\r\n                <div key={listOfToggles[i]}>\r\n                    <ListItem>\r\n                        <Switch\r\n                            edge=\"start\"\r\n                            onChange={handleToggle(listOfToggles[i])}\r\n                            checked={checked}\r\n                        />\r\n                        <ListItemText\r\n                            primary={togglesMeta[listOfToggles[i]].displayName}\r\n                        />\r\n                    </ListItem>\r\n\r\n                    {\r\n                        // ! Handle submenus of ABM/ACCESS\r\n\r\n                        listOfToggles[i] === \"SHADOWS\" && (\r\n                            <Collapse in={checked}>\r\n                                <ShadowSubmenu />\r\n                            </Collapse>\r\n                        )\r\n                    }\r\n\r\n                    {\r\n                        // ! Handle submenus of ABM/ACCESS\r\n\r\n                        listOfToggles[i] === \"ABM\" && (\r\n                            <Collapse in={checked}>\r\n                                <ABMSubmenu tripsData={cityioData.ABM2.attr} />\r\n                            </Collapse>\r\n                        )\r\n                    }\r\n                    {listOfToggles[i] === \"ACCESS\" && (\r\n                        <Collapse\r\n                            in={checked}\r\n                            style={{\r\n                                marginLeft: 24,\r\n                            }}\r\n                        >\r\n                            <AccessSubmenu cityioData={cityioData} />\r\n                        </Collapse>\r\n                    )}\r\n                </div>\r\n            );\r\n            togglesCompsArray.push(thisToggle);\r\n        }\r\n    }\r\n\r\n    return <List>{togglesCompsArray}</List>;\r\n}\r\n\r\nexport default TogglesMenu;\r\n","import React, { useEffect } from \"react\";\r\nimport settings from \"../../../../settings/settings.json\";\r\nimport gridSetting from \"../../../../settings/GridEditorSettings.json\"\r\nimport { FormControl, FormLabel, FormControlLabel, RadioGroup, Radio, CircularProgress, Stepper, Step, StepLabel, StepButton } from \"@material-ui/core\";\r\nimport { useState } from \"react\";\r\nimport { useSelector, useDispatch } from 'react-redux'\r\nimport axios from 'axios'\r\nimport scenario1 from '../../../../settings/LandUse_0.json'\r\nimport scenario2 from '../../../../settings/LandUse_2.json'\r\nimport {\r\n    getCityioData,\r\n    setReadyState,\r\n    setLoadingState,\r\n    setScenarioNames,\r\n    addLoadingModules,\r\n    removeLoadingModules,\r\n} from \"../../../../redux/actions\";\r\n\r\nconst getAPICall = async (URL) => {\r\n    try {\r\n        // ! should add 'retry' here\r\n        // ! https://stackoverflow.com/questions/56074531/how-to-retry-5xx-requests-using-axios\r\n        const response = await axios.get(URL);\r\n        return response.data;\r\n    } catch (err) {\r\n        console.log(err);\r\n    }\r\n};\r\n\r\nconst makeGEOGRIDDATAobject = (geoJsonFeatures) => {\r\n    let GEOGRIDDATA_object = []\r\n    geoJsonFeatures.forEach((element) => {\r\n        GEOGRIDDATA_object.push(element.properties)\r\n    })\r\n    return GEOGRIDDATA_object\r\n}\r\n\r\nconst makeGEOGRIDobject = (struct, typesList, geoJsonFeatures, gridProps) => {\r\n    let GEOGRID_object = struct\r\n\r\n    // take types list and prepare to csJS format\r\n    let newTypesList = {}\r\n\r\n    typesList.forEach((oldType) => {\r\n        newTypesList[oldType.name] = oldType\r\n        //material-table creates strings for these items\r\n        // so in first \"Commit to cityIO\", these must be turned into\r\n        // Json objects. On Second commit, these are already objects,\r\n        // hence the two conditions below\r\n\r\n        newTypesList[oldType.name].LBCS =\r\n            typeof oldType.LBCS == 'string' ? JSON.parse(oldType.LBCS) : oldType.LBCS\r\n        newTypesList[oldType.name].NAICS =\r\n            typeof oldType.NAICS == 'string'\r\n                ? JSON.parse(oldType.NAICS)\r\n                : oldType.NAICS\r\n    })\r\n\r\n    GEOGRID_object.properties.types = newTypesList\r\n\r\n    // inject table props to grid\r\n    GEOGRID_object.properties.header = gridProps\r\n    GEOGRID_object.properties.header.longitude = parseFloat(\r\n        GEOGRID_object.properties.header.longitude,\r\n    )\r\n    GEOGRID_object.properties.header.latitude = parseFloat(\r\n        GEOGRID_object.properties.header.latitude,\r\n    )\r\n    GEOGRID_object.properties.header.rotation = parseFloat(\r\n        GEOGRID_object.properties.header.rotation,\r\n    )\r\n    GEOGRID_object.properties.header.nrows = parseFloat(\r\n        GEOGRID_object.properties.header.nrows,\r\n    )\r\n    GEOGRID_object.properties.header.ncols = parseFloat(\r\n        GEOGRID_object.properties.header.ncols,\r\n    )\r\n    GEOGRID_object.properties.header.cellSize = parseFloat(\r\n        GEOGRID_object.properties.header.cellSize,\r\n    )\r\n\r\n    // lastly get the grid features\r\n    GEOGRID_object.features = geoJsonFeatures\r\n    return GEOGRID_object\r\n}\r\n\r\nconst postGridToCityIO = async (myTypeList, myGeoJsonFeatures) => {\r\n    let GEOGRIDstruct = gridSetting.GEOGRID\r\n    let typesList = myTypeList;\r\n    // let geoJsonFeatures = reduxState.GRID_CREATED.features\r\n    let geoJsonFeatures = myGeoJsonFeatures\r\n    let gridProps = gridSetting.GEOGRID.properties.header\r\n    gridProps.tableName = gridSetting.map.projectName;\r\n\r\n    // take grid struct from settings\r\n    // console.log('GEOGRIDstruct', GEOGRIDstruct);\r\n    // console.log('typesList', typesList);\r\n    // console.log('geoJsonFeatures', geoJsonFeatures);\r\n    // console.log('gridProps', gridProps);\r\n    let GEOGRID_object = makeGEOGRIDobject(\r\n        GEOGRIDstruct,\r\n        typesList,\r\n        geoJsonFeatures,\r\n        gridProps,\r\n    )\r\n    console.log('GEOGRID_object', GEOGRID_object);\r\n\r\n    let GEOGRIDDATA_object = makeGEOGRIDDATAobject(geoJsonFeatures)\r\n    let tableName = GEOGRID_object.properties.header.tableName.toLowerCase()\r\n\r\n    const geoGridOptions = (URL, DATA) => {\r\n        return {\r\n            method: 'post',\r\n            url: URL,\r\n            data: DATA,\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n                Accept: 'application/json',\r\n            },\r\n        }\r\n    }\r\n\r\n    const table_url = `${settings.cityIO.baseURL}${tableName}/`\r\n    const new_table_grid = {\r\n        GEOGRID: GEOGRID_object,\r\n        GEOGRIDDATA: GEOGRIDDATA_object,\r\n    }\r\n    let response = await axios(geoGridOptions(table_url, new_table_grid));\r\n    return response.data;\r\n}\r\n\r\nconst createtypesArray = (LanduseTypesList) => {\r\n    let typesArray = []\r\n    Object.keys(LanduseTypesList).forEach((type) => {\r\n        typesArray.push({\r\n            name: type,\r\n            description: 'description for: ' + type,\r\n            color: LanduseTypesList[type].color,\r\n            height: LanduseTypesList[type].height\r\n                ? LanduseTypesList[type].height\r\n                : 0,\r\n\r\n            LBCS: LanduseTypesList[type].LBCS\r\n                ? JSON.stringify(LanduseTypesList[type].LBCS)\r\n                : null,\r\n            NAICS: LanduseTypesList[type].NAICS\r\n                ? JSON.stringify(LanduseTypesList[type].NAICS)\r\n                : null,\r\n            interactive: LanduseTypesList[type].interactive\r\n                ? LanduseTypesList[type].interactive\r\n                : \"web\",\r\n            TypeCode: LanduseTypesList[type].TypeCode\r\n                ? LanduseTypesList[type].TypeCode\r\n                : null,\r\n            IDSColor: LanduseTypesList[type].IDSColor\r\n                ? LanduseTypesList[type].IDSColor\r\n                : null,\r\n            RGB: LanduseTypesList[type].RGB\r\n                ? LanduseTypesList[type].RGB\r\n                : null,\r\n        })\r\n    })\r\n    return typesArray\r\n}\r\n\r\nfunction getSteps() {\r\n    return [\"2021\", \"2030\"];\r\n}\r\n\r\nfunction ChooseScenario(props) {\r\n    const chosenScenario = props.chosenScenario;\r\n    const displayUI = props.displayUI;\r\n    const [radioValue, setRadioValue] = useState('scenario1');\r\n    const [loading, setLoading] = useState(false);\r\n    // const reduxState = useSelector((state) => state)\r\n    // console.log(reduxState.TYPES_LIST);\r\n\r\n    useEffect(() => {\r\n        async function autoChangeScenario() {\r\n            await getModules(chosenScenario);\r\n        }\r\n        autoChangeScenario();\r\n    }, [chosenScenario]);\r\n\r\n    const handleRadioChange = async (event) => {\r\n        let myChosenScenario = event.target.value\r\n        let fileScenario = null;\r\n        setRadioValue(myChosenScenario);\r\n        switch (myChosenScenario) {\r\n            case 'scenario1':\r\n                fileScenario = scenario1;\r\n                break;\r\n            case 'scenario2':\r\n                fileScenario = scenario2;\r\n                break;\r\n        }\r\n        let geoJsonFeatures = fileScenario.features;\r\n        let typesList = createtypesArray(gridSetting.GEOGRID.properties.types);\r\n        setLoading(true);\r\n        await postGridToCityIO(typesList, geoJsonFeatures);\r\n        setLoading(false);\r\n    }\r\n\r\n    /* ONLY GETTING DATA */\r\n    const [hashes, setHashes] = useState({});\r\n    const cityioData = useSelector((state) => state.CITYIO);\r\n\r\n    const dispatch = useDispatch();\r\n\r\n    const [activeStep, setActiveStep] = useState(0);\r\n    const steps = getSteps();\r\n\r\n    async function getModules(tableName) {\r\n        let cityioURL = `${settings.cityIO.baseURL}${tableName}/`;\r\n        const newHashes = await getAPICall(cityioURL + \"meta/hashes/\");\r\n        const promises = [];\r\n        const loadingModules = [];\r\n        const pickedModules = settings.cityIO.cityIOmodules.map((x) => x.name);\r\n        // for each of the modules in settings, add api call to promises\r\n        pickedModules.forEach((module) => {\r\n            if (hashes[module] !== newHashes[module]) {\r\n                promises.push(getAPICall(`${cityioURL}${module}/`));\r\n                loadingModules.push(module);\r\n                // if(newHashes[module]){\r\n                // }\r\n            } else {\r\n                promises.push(null);\r\n            }\r\n        });\r\n        dispatch(addLoadingModules(loadingModules));\r\n        const modules = await Promise.all(promises);\r\n        setHashes(newHashes);\r\n        // console.log('modules', modules);\r\n\r\n        // update cityio object with modules data\r\n        const modulesData = pickedModules.reduce((obj, k, i) => {\r\n            if (modules[i]) {\r\n                console.log(`updating ${k}`);\r\n                return { ...obj, [k]: modules[i] };\r\n            } else {\r\n                return obj;\r\n            }\r\n        }, cityioData);\r\n        modulesData.tableName = tableName;\r\n        // console.log('modulesData', modulesData);\r\n\r\n        dispatch(removeLoadingModules(loadingModules));\r\n\r\n        // send to cityio\r\n        dispatch(getCityioData(modulesData));\r\n        console.log(\"done updating from cityIO\");\r\n\r\n        // initializes rendering of Menu and Map containers\r\n        dispatch(setReadyState(true));\r\n        dispatch(setLoadingState(false));\r\n    }\r\n\r\n    const handleStepByGetCityIOData = (step) => async () => {\r\n        setActiveStep(step);\r\n        let tableName = null;\r\n        switch (step) {\r\n            case 0:\r\n                tableName = 'hcm_test_v1';\r\n                break;\r\n            case 1:\r\n                tableName = 'hcm_test_v2';\r\n                break;\r\n        }\r\n        setLoading(true);\r\n        await getModules(tableName);\r\n        setLoading(false);\r\n    }\r\n\r\n\r\n\r\n    return (\r\n        <>\r\n            {/* <FormControl component=\"fieldset\">\r\n                <FormLabel component=\"legend\">Scenarios</FormLabel>\r\n                <RadioGroup aria-label=\"my-scenario\" name=\"my-scenario\" value={radioValue} onChange={handleRadioChange} >\r\n                    <FormControlLabel value=\"scenario1\" control={<Radio />} label=\"Scenario 1\" disabled={loading} />\r\n                    <FormControlLabel value=\"scenario2\" control={<Radio />} label=\"Scenario 2\" disabled={loading} />\r\n                </RadioGroup>\r\n                \r\n            </FormControl> */}\r\n            {displayUI && <Stepper alternativeLabel nonLinear activeStep={activeStep}>\r\n                {steps.map((label, index) => {\r\n                    return (\r\n                        <Step key={label}>\r\n                            <StepButton\r\n                                onClick={handleStepByGetCityIOData(index)}\r\n                                icon={''}\r\n                                disabled={loading}\r\n                            >\r\n                                <StepLabel>{label}</StepLabel>\r\n                            </StepButton>\r\n                        </Step>\r\n                    );\r\n                })}\r\n            </Stepper>}\r\n            {loading && <CircularProgress />}\r\n        </>\r\n    )\r\n}\r\n\r\nexport default ChooseScenario;","import React from \"react\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport { listenToMenuUI } from \"../../../redux/actions\";\r\nimport EditMenu from \"./EditMenu\";\r\nimport TogglesMenu from \"./TogglesMenu\";\r\nimport SaveMenu from \"./SaveMenu\";\r\nimport { Button, Typography, List, ListItem, FormControl, FormLabel, FormControlLabel, RadioGroup, Radio } from \"@material-ui/core\";\r\nimport EditIcon from \"@material-ui/icons/Edit\";\r\nimport CloudUploadIcon from \"@material-ui/icons/CloudUpload\";\r\nimport NavigationIcon from \"@material-ui/icons/Navigation\";\r\nimport axios from \"axios\";\r\nimport { useEffect, useState } from \"react\";\r\nimport settings from \"../../../settings/settings.json\";\r\nimport ChooseScenario from \"./ChooseScenario\";\r\n\r\nconst getAPICall = async (URL) => {\r\n    try {\r\n        const response = await axios.get(URL);\r\n        return response.data;\r\n    } catch (err) {\r\n        console.log(err);\r\n    }\r\n};\r\nfunction MenuContainer(props) {\r\n    const { tableName } = props;\r\n    const menuState = useSelector((state) => state.MENU);\r\n    const cityioData = useSelector((state) => state.CITYIO);\r\n\r\n    const loadedModules = Object.keys(cityioData);\r\n    const togglesMeta = settings.menu.toggles;\r\n\r\n    const dispatch = useDispatch();\r\n\r\n    const handleToggle = (value) => () => {\r\n        const i = menuState.indexOf(value);\r\n        const updatedMenuState = [...menuState];\r\n        if (i === -1) {\r\n            updatedMenuState.push(value);\r\n        } else {\r\n            updatedMenuState.splice(i, 1);\r\n        }\r\n        dispatch(listenToMenuUI(updatedMenuState));\r\n    };\r\n\r\n    let myMenuState = [...menuState];\r\n    const [chosenScenario, setChosenScenario] = useState(\"hcm_test_v1\");\r\n    let myChosenScenario = 'hcm_test_v1';\r\n\r\n    useEffect(() => {\r\n        // listenChangingOption();\r\n        const timer = setTimeout(listenChangingOption, 1000);\r\n        return () => clearTimeout(timer);\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, []);\r\n\r\n    // /* Listening View Option Change */\r\n    async function listenChangingOption() {\r\n        const options = await getAPICall(`${process.env.REACT_APP_EXPRESS_PUBLIC_URL}/get-option`);\r\n        const scenarioObject = await getAPICall(`${process.env.REACT_APP_EXPRESS_PUBLIC_URL}/get-scenario`);\r\n        if (options) {\r\n            console.log(options);\r\n            let table = options.table;\r\n            let option = options.option;\r\n            let mode = options.mode;\r\n            if (table == tableName) {\r\n                if (option) {\r\n                    let requireModule = togglesMeta[option].requireModule;\r\n                    if (loadedModules.includes(requireModule) || requireModule === false) {\r\n                        const i = myMenuState.indexOf(option);\r\n                        if (mode == \"ON\") {\r\n                            if (i === -1) {\r\n                                myMenuState.push(option);\r\n                            }\r\n                        }\r\n                        else {\r\n                            if (i !== -1) {\r\n                                myMenuState.splice(i, 1);\r\n                            }\r\n                        }\r\n                        dispatch(listenToMenuUI(myMenuState));\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (scenarioObject) {\r\n            console.log(scenarioObject);\r\n            let scenario = scenarioObject.scenario;\r\n            if (scenario && scenario != myChosenScenario) {\r\n                myChosenScenario = scenario;\r\n                setChosenScenario(scenario);\r\n            }\r\n        }\r\n        setTimeout(listenChangingOption, 1000);\r\n    }\r\n\r\n    /* END Listening */\r\n\r\n    return (\r\n        <>\r\n            <List>\r\n                {/* <ListItem>\r\n                    <Typography variant={\"h2\"}>Grid Edit</Typography>\r\n                </ListItem>\r\n                <ListItem>\r\n                    <Button\r\n                        startIcon={\r\n                            menuState.includes(\"EDIT\") ? (\r\n                                <>\r\n                                    <CloudUploadIcon />\r\n                                    Send to cityIO\r\n                                </>\r\n                            ) : (\r\n                                <>\r\n                                    <EditIcon />\r\n                                    Edit Mode\r\n                                </>\r\n                            )\r\n                        }\r\n                        color=\"default\"\r\n                        onClick={handleToggle(\"EDIT\")}\r\n                    ></Button>\r\n                </ListItem> */}\r\n\r\n                {/* <EditMenu />\r\n\r\n                <ListItem>\r\n                    <Typography variant={\"h2\"}>Scenarios</Typography>\r\n                </ListItem>\r\n                <ListItem>\r\n                    <SaveMenu\r\n                        tableName={tableName}\r\n                        handleToggle={handleToggle}\r\n                    />\r\n                </ListItem> */}\r\n\r\n                <ListItem>\r\n                    <Typography variant={\"h2\"}>View Options</Typography>\r\n                </ListItem>\r\n                <ListItem>\r\n                    <Button\r\n                        startIcon={\r\n                            <>\r\n                                <NavigationIcon />\r\n                                {'RESET VIEW'}\r\n                            </>\r\n                        }\r\n                        color=\"default\"\r\n                        onClick={handleToggle(\"RESET_VIEW\")}\r\n                    />\r\n                </ListItem>\r\n            </List>\r\n\r\n            <TogglesMenu handleToggle={handleToggle} />\r\n            <ChooseScenario chosenScenario={chosenScenario} displayUI={true}/>\r\n        </>\r\n    );\r\n}\r\n\r\nexport default MenuContainer;\r\n","import React from \"react\";\r\nimport { testHex, hexToRgb } from \"../../../../../utils/utils\";\r\nimport ErrorOutlineIcon from \"@material-ui/icons/ErrorOutline\";\r\n\r\n/**\r\n * cell selection\r\n * meta div\r\n * @param {*} props\r\n */\r\n\r\nexport const PaintBrush = (props) => {\r\n    if (!props.mousePos || !props.hoveredCells) return null;\r\n    const selectedType = props.selectedType;\r\n\r\n    const isInteractiveCell = props.hoveredCells.object.properties.interactive;\r\n    const mousePos = props.mousePos;\r\n    const divSize = props.divSize;\r\n    let col = selectedType.color;\r\n    if (testHex(col)) {\r\n        col = hexToRgb(col);\r\n    }\r\n    const color = \"rgb(\" + col[0] + \",\" + col[1] + \",\" + col[2] + \")\";\r\n    const colorTrans = \"rgba(\" + col[0] + \",\" + col[1] + \",\" + col[2] + \",0.6)\";\r\n    let mouseX = mousePos.clientX - divSize / 2;\r\n    let mouseY = mousePos.clientY - divSize / 2;\r\n\r\n    let msg = isInteractiveCell ? selectedType.name : \"Not-interactive\";\r\n    return (\r\n        <div\r\n            style={{\r\n                border: \"2px solid\",\r\n                backgroundColor: props.mouseDown ? colorTrans : \"rgba(0,0,0,0)\",\r\n                borderColor: color,\r\n                color: color,\r\n                borderRadius: \"15%\",\r\n                position: \"fixed\",\r\n                zIndex: 10,\r\n                pointerEvents: \"none\",\r\n                width: divSize,\r\n                height: divSize,\r\n                left: mouseX,\r\n                top: mouseY,\r\n            }}\r\n        >\r\n            <div\r\n                style={{\r\n                    position: \"relative\",\r\n                    left: divSize + 10,\r\n                    fontSize: \"0.8em\",\r\n                }}\r\n            >\r\n                {!isInteractiveCell && <ErrorOutlineIcon />}\r\n                {msg}:\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n","import React from \"react\";\r\n\r\n/**\r\n *\r\n * Cell meta comp\r\n */\r\n\r\nexport const CellMeta = (props) => {\r\n    if (!props.mousePos) return null;\r\n    const mousePos = props.mousePos;\r\n\r\n    return (\r\n        <div\r\n            style={{\r\n                borderRadius: \"10%\",\r\n                position: \"fixed\",\r\n                pointerEvents: \"none\",\r\n                backgroundColor: \"rgba(0,0,0,0.5)\",\r\n                padding: \"1vw\",\r\n                color: \"rgba(255,255,255,0.9)\",\r\n                zIndex: 10,\r\n                left: mousePos.clientX,\r\n                top: mousePos.clientY,\r\n                fontFamily:'monospace',\r\n                fontSize: \"0.65em\",\r\n                fontWeight: 500,\r\n            }}\r\n        >\r\n            <p>\r\n                Type:\r\n                {props.hoveredObj.object.properties.name}\r\n            </p>\r\n            <p>\r\n                Floors:\r\n                {props.hoveredObj.object.properties.height}\r\n            </p>\r\n            <p>\r\n                ID:\r\n                {props.hoveredObj.object.properties.id}\r\n            </p>\r\n        </div>\r\n    );\r\n};\r\n","import React from \"react\";\r\nimport { PaintBrush } from \"./PaintBrush\";\r\nimport { CellMeta } from \"../CellMeta\";\r\n\r\nexport default function PaintBrushContainer({\r\n    editOn,\r\n    mousePos,\r\n    selectedType,\r\n    pickingRadius,\r\n    mouseDown,\r\n    hoveredObj,\r\n}) {\r\n    if (editOn) {\r\n        return (\r\n            selectedType && (\r\n                <PaintBrush\r\n                    mousePos={mousePos}\r\n                    selectedType={selectedType}\r\n                    divSize={pickingRadius}\r\n                    mouseDown={mouseDown}\r\n                    hoveredCells={hoveredObj}\r\n                />\r\n            )\r\n        );\r\n    } else {\r\n        return (\r\n            hoveredObj && (\r\n                <CellMeta mousePos={mousePos} hoveredObj={hoveredObj} />\r\n            )\r\n        );\r\n    }\r\n}\r\n","import { Component } from \"react\";\r\n\r\nclass AnimationComponent extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.animationFrame = null;\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        if (this.animationFrame) {\r\n            window.cancelAnimationFrame(this.animationFrame);\r\n        }\r\n    }\r\n\r\n    componentDidMount() {\r\n        // start ainmation/sim/roate\r\n        this._animate();\r\n    }\r\n\r\n    _animate() {\r\n        const {\r\n            toggles: { rotateOn, ABMOn },\r\n            state: { viewState, sliders },\r\n            updaters: { listenToSlidersEvents, sunEffects, setViewState },\r\n            dispatch,\r\n        } = this.props;\r\n        if (rotateOn) {\r\n            let bearing = viewState.bearing ? viewState.bearing : 0;\r\n            bearing < 360 ? (bearing += 0.05) : (bearing = 0);\r\n            setViewState({\r\n                ...viewState,\r\n                bearing: bearing,\r\n            });\r\n        }\r\n\r\n        if (ABMOn) {\r\n            const time = sliders.time[1];\r\n            const speed = sliders.speed;\r\n            const startHour = sliders.time[0];\r\n            const endHour = sliders.time[2];\r\n\r\n            let t = parseInt(time) + parseInt(speed);\r\n            if (time < startHour || time > endHour) {\r\n                t = startHour;\r\n            }\r\n\r\n            dispatch(\r\n                listenToSlidersEvents({\r\n                    ...sliders,\r\n                    time: [sliders.time[0], t, sliders.time[2]],\r\n                })\r\n            );\r\n\r\n            // update sun position\r\n            if (sunEffects) {\r\n                sunEffects.updateSunDirection(t);\r\n            }\r\n        }\r\n        // ! start the req animation frame\r\n        this.animationFrame = window.requestAnimationFrame(\r\n            this._animate.bind(this)\r\n        );\r\n    }\r\n\r\n    render() {\r\n        return null;\r\n    }\r\n}\r\n\r\nexport default AnimationComponent;\r\n","import { ColumnLayer } from 'deck.gl'\r\nimport { HeatmapLayer } from 'deck.gl'\r\nimport settings from '../../../../settings/settings.json'\r\nimport { useSelector } from 'react-redux'\r\n\r\nexport default function AccessLayer({ data, cellSize }) {\r\n  const accessToggle = useSelector((state) => [state.ACCESS_TOGGLE])\r\n  return new HeatmapLayer({\r\n    id: 'ACCESS',\r\n    colorRange: settings.map.layers.heatmap.colors,\r\n    radiusPixels: 200,\r\n    opacity: 0.5,\r\n    threshold: 0.5,\r\n    data,\r\n    getPosition: (d) => d.coordinates,\r\n    getWeight: (d) => d.values[accessToggle],\r\n    updateTriggers: {\r\n      getWeight: [accessToggle],\r\n    },\r\n  })\r\n  // return new ColumnLayer({\r\n  //   id: 'column-layer',\r\n  //   data,\r\n  //   shadowEnabled: false,\r\n\r\n  //   material: false,\r\n  //   diskResolution: 12,\r\n  //   radius: cellSize,\r\n  //   extruded: true,\r\n  //   pickable: true,\r\n  //   elevationScale: 100,\r\n  //   getPosition: (d) => d.coordinates,\r\n  //   colorRange: settings.map.layers.heatmap.colors,\r\n  //   getFillColor: (d) => [255 * d.values[accessToggle], 82, 120, 200],\r\n  //   getLineColor: [0, 0, 0],\r\n  //   getElevation: (d) => d.values[accessToggle],\r\n  //   updateTriggers: {\r\n  //     getElevation: [accessToggle],\r\n  //     getFillColor: [accessToggle],\r\n  //   },\r\n  //   transitions: {\r\n  //     getFillColor: 500,\r\n  //     getElevation: 200,\r\n  //   },\r\n  // })\r\n}\r\n","import { PathLayer } from \"deck.gl\";\r\nimport { hexToRgb } from \"../../../../utils/utils\";\r\n\r\nexport default function AggregatedTripsLayer({ data, cityioData, ABMmode }) {\r\n    return new PathLayer({\r\n        id: \"AGGREGATED_TRIPS\",\r\n        shadowEnabled: false,\r\n        data,\r\n        getPath: (d) => {\r\n            const noisePath =\r\n                Math.random() < 0.5\r\n                    ? Math.random() * 0.00005\r\n                    : Math.random() * -0.00005;\r\n            for (let i in d.path) {\r\n                d.path[i][0] = d.path[i][0] + noisePath;\r\n                d.path[i][1] = d.path[i][1] + noisePath;\r\n                d.path[i][2] = d.mode[0] * 2;\r\n            }\r\n            return d.path;\r\n        },\r\n        getColor: (d) => {\r\n            let col = hexToRgb(cityioData.ABM2.attr[ABMmode][d[ABMmode]].color);\r\n            return col;\r\n        },\r\n        opacity: 0.2,\r\n        getWidth: 1.5,\r\n\r\n        updateTriggers: {\r\n            getColor: ABMmode,\r\n        },\r\n        transitions: {\r\n            getColor: 500,\r\n        },\r\n    });\r\n}\r\n","import { TripsLayer } from '@deck.gl/geo-layers'\r\nimport { hexToRgb } from '../../../../utils/utils'\r\n\r\n//  * remap line width\r\nconst _remapValues = (value) => {\r\n  let remap = value > 15 && value < 25 ? 3 : value < 15 && value > 10 ? 12 : 30\r\n  return remap\r\n}\r\n\r\nexport default function ABMLayer({\r\n  data,\r\n  cityioData,\r\n  ABMmode,\r\n  zoomLevel,\r\n  sliders,\r\n}) {\r\n  return new TripsLayer({\r\n    id: 'ABM',\r\n    data,\r\n    getPath: (d) => d.path,\r\n    getTimestamps: (d) => d.timestamps,\r\n    getColor: (d) => {\r\n      let col = hexToRgb(cityioData.ABM2.attr[ABMmode][d[ABMmode]].color)\r\n      return col\r\n    },\r\n    shadowEnabled: false,\r\n    getWidth: 1,\r\n    widthScale: _remapValues(zoomLevel),\r\n    opacity: 0.8,\r\n    rounded: true,\r\n    trailLength: 500,\r\n    currentTime: sliders.time[1],\r\n\r\n    updateTriggers: {\r\n      getColor: ABMmode,\r\n    },\r\n    transitions: {\r\n      getColor: 500,\r\n    },\r\n  })\r\n}\r\n","import { GeoJsonLayer } from \"deck.gl\";\r\nimport { _handleGridcellEditing } from \"../../../../utils/utils\";\r\n\r\nexport default function GridLayer({\r\n    data,\r\n    editOn,\r\n    state: { selectedType, keyDownState, selectedCellsState, pickingRadius },\r\n    updaters: { setSelectedCellsState, setDraggingWhileEditing, setHoveredObj },\r\n    deckGL,\r\n}) {\r\n    return new GeoJsonLayer({\r\n        id: \"GRID\",\r\n        data,\r\n        pickable: true,\r\n        extruded: true,\r\n        wireframe: true,\r\n        lineWidthScale: 1,\r\n        lineWidthMinPixels: 2,\r\n        getElevation: (d) => d.properties.height,\r\n        getFillColor: (d) => d.properties.color,\r\n\r\n        onClick: (event) => {\r\n            if (selectedType && editOn && keyDownState !== \"Shift\")\r\n                _handleGridcellEditing(\r\n                    event,\r\n                    selectedType,\r\n                    setSelectedCellsState,\r\n                    pickingRadius,\r\n                    deckGL\r\n                );\r\n        },\r\n\r\n        onDrag: (event) => {\r\n            if (selectedType && editOn && keyDownState !== \"Shift\")\r\n                _handleGridcellEditing(\r\n                    event,\r\n                    selectedType,\r\n                    setSelectedCellsState,\r\n                    pickingRadius,\r\n                    deckGL\r\n                );\r\n        },\r\n\r\n        onDragStart: () => {\r\n            if (selectedType && editOn && keyDownState !== \"Shift\") {\r\n                setDraggingWhileEditing(true);\r\n            }\r\n        },\r\n\r\n        onHover: (e) => {\r\n            if (e.object) {\r\n                setHoveredObj(e);\r\n            }\r\n        },\r\n\r\n        onDragEnd: () => {\r\n            setDraggingWhileEditing(false);\r\n        },\r\n        updateTriggers: {\r\n            getFillColor: selectedCellsState,\r\n            getElevation: selectedCellsState,\r\n        },\r\n        transitions: {\r\n            getFillColor: 500,\r\n            getElevation: 500,\r\n        },\r\n    });\r\n}\r\n","import { TextLayer } from \"@deck.gl/layers\";\r\n\r\nexport default function TextualLayer({ data, coordinates }) {\r\n    /*\r\n     * this layer takes textual layer procuded by a 3rd party\r\n     * module, and renders a text message near the grid cell\r\n     * defined in the data id attribute.\r\n     *\r\n     * data format:\r\n      [\r\n      {\"id\": 0, \"info\": \"yes!\" },   {\"id\": 10, \"info\": \"I'm on ID 10!\" }\r\n      ]\r\n     *\r\n     * coordinates format:\r\n     [\r\n       {\"info\": \"yes!\", coordinates: [-122.466233, 37.684638]},\r\n     ]\r\n     */\r\n\r\n    if (data && coordinates && coordinates.features) {\r\n        let textLayerData = [];\r\n\r\n        data.forEach((infoIteam) => {\r\n            textLayerData.push({\r\n                coordinates: [\r\n                    coordinates.features[infoIteam.id].geometry\r\n                        .coordinates[0][0][0],\r\n                    coordinates.features[infoIteam.id].geometry\r\n                        .coordinates[0][0][1],\r\n                    100,\r\n                ],\r\n                info: infoIteam.info,\r\n            });\r\n        });\r\n\r\n        return new TextLayer({\r\n            id: \"text-layer\",\r\n            data: textLayerData,\r\n            pickable: true,\r\n            getPosition: (d) => d.coordinates,\r\n            getText: (d) => d.info,\r\n            getColor: [255, 255, 255],\r\n            getSize: 30,\r\n            getAngle: 0,\r\n            getTextAnchor: \"middle\",\r\n            getAlignmentBaseline: \"center\",\r\n        });\r\n    }\r\n}\r\n","import { GeoJsonLayer } from 'deck.gl'\r\nimport { hexToRgb } from '../../../../utils/utils'\r\n\r\nexport default function GeojsonLayer({ data }) {\r\n  return new GeoJsonLayer({\r\n    id: 'GeojsonLayer',\r\n    data,\r\n    pickable: true,\r\n    wireframe: true,\r\n    stroked: false,\r\n    filled: true,\r\n    extruded: true,\r\n    lineWidthScale: 1,\r\n    getFillColor: (d) => hexToRgb(d.properties.fill),\r\n    getLineColor: (d) => hexToRgb(d.properties.stroke),\r\n    lineWidthMinPixels: 2,\r\n    getElevation: (d) => d.properties.height,\r\n  })\r\n}\r\n","import React, { useState, useEffect, useRef } from 'react'\r\nimport PaintBrush from './components/PaintBrush'\r\nimport { useSelector, useDispatch } from 'react-redux'\r\nimport { listenToSlidersEvents } from '../../../redux/actions'\r\nimport {\r\n  _proccessAccessData,\r\n  _proccessGridData,\r\n  _postMapEditsToCityIO,\r\n} from '../../../utils/utils'\r\nimport { StaticMap } from 'react-map-gl'\r\nimport DeckGL from '@deck.gl/react'\r\nimport 'mapbox-gl/dist/mapbox-gl.css'\r\nimport settings from '../../../settings/settings.json'\r\nimport AnimationComponent from './components/AnimationComponent'\r\nimport { updateSunDirection, _setupSunEffects } from '../../../utils/utils'\r\nimport {\r\n  AccessLayer,\r\n  AggregatedTripsLayer,\r\n  ABMLayer,\r\n  GridLayer,\r\n  TextualLayer,\r\n  GeojsonLayer,\r\n} from './deckglLayers'\r\n\r\nexport default function Map(props) {\r\n  const pitchMap = props.pitchMap\r\n  const zoomMap = props.zoomMap\r\n  const autoRotate = props.autoRotate\r\n  const onlyMap = props.onlyMap\r\n  const [draggingWhileEditing, setDraggingWhileEditing] = useState(false)\r\n  const [selectedCellsState, setSelectedCellsState] = useState(null)\r\n  const [viewState, setViewState] = useState(settings.map.initialViewState)\r\n  const [keyDownState, setKeyDownState] = useState(null)\r\n  const [mousePos, setMousePos] = useState(null)\r\n  const [mouseDown, setMouseDown] = useState(null)\r\n  const [hoveredObj, setHoveredObj] = useState(null)\r\n  const [access, setAccess] = useState(null)\r\n  const [textualData, setTextualData] = useState(null)\r\n\r\n  const [geojsonData, setGeojsonData] = useState(null)\r\n\r\n  const [GEOGRID, setGEOGRID] = useState(null)\r\n  const [ABM, setABM] = useState({})\r\n  const [loaded, setLoaded] = useState(false)\r\n  const effectsRef = useRef()\r\n  const deckGL = useRef()\r\n\r\n  const dispatch = useDispatch()\r\n\r\n  const pickingRadius = 40\r\n\r\n  const [\r\n    cityioData,\r\n    sliders,\r\n    menu,\r\n\r\n    selectedType,\r\n    ABMmode,\r\n  ] = useSelector((state) => [\r\n    state.CITYIO,\r\n    state.SLIDERS,\r\n    state.MENU,\r\n    state.SELECTED_TYPE,\r\n    state.ABM_MODE,\r\n  ])\r\n\r\n  var ABMOn = menu.includes('ABM')\r\n  if (autoRotate) {\r\n    var rotateOn = autoRotate;\r\n  } else {\r\n    var rotateOn = menu.includes('ROTATE')\r\n  }\r\n  var shadowsOn = menu.includes('SHADOWS')\r\n  var editOn = menu.includes('EDIT')\r\n  var resetViewOn = menu.includes('RESET_VIEW')\r\n\r\n  useEffect(() => {\r\n    // fix deck view rotate\r\n    _rightClickViewRotate()\r\n    // setup sun effects\r\n    _setupSunEffects(effectsRef, cityioData.GEOGRID.properties.header)\r\n    // zoom map on CS table location\r\n    _setViewStateToTableHeader()\r\n    setLoaded(true)\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    if (!loaded) return\r\n    updateSunDirection(sliders.time[1], effectsRef)\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [sliders.time])\r\n\r\n  useEffect(() => {\r\n    if (!loaded) return\r\n    let shadowColor = shadowsOn ? [0, 0, 0, 0.5] : [0, 0, 0, 0]\r\n    effectsRef.current[0].shadowColor = shadowColor\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [shadowsOn])\r\n\r\n  useEffect(() => {\r\n    setGEOGRID(_proccessGridData(cityioData))\r\n\r\n    if (cityioData.access) {\r\n      setAccess(_proccessAccessData(cityioData.access))\r\n    }\r\n\r\n    if (cityioData.textual) {\r\n      setTextualData(cityioData.textual)\r\n    }\r\n\r\n    if (cityioData.geojson) {\r\n      setGeojsonData(cityioData.geojson)\r\n    }\r\n\r\n    if (cityioData.ABM2) {\r\n      setABM(cityioData.ABM2)\r\n    }\r\n  }, [cityioData])\r\n\r\n  useEffect(() => {\r\n    if (!loaded) return\r\n    if (!editOn) {\r\n      let dataProps = []\r\n\r\n      for (let i = 0; i < GEOGRID.features.length; i++) {\r\n        dataProps[i] = GEOGRID.features[i].properties\r\n      }\r\n      _postMapEditsToCityIO(dataProps, cityioData.tableName, '/GEOGRIDDATA')\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [editOn])\r\n\r\n  useEffect(() => {\r\n    if (!loaded) return\r\n    _setViewStateToTableHeader()\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [resetViewOn])\r\n\r\n  const onViewStateChange = ({ viewState }) => {\r\n    setViewState(viewState)\r\n  }\r\n\r\n  // /**\r\n  //  * resets the camera viewport\r\n  //  * to cityIO header data\r\n  //  * https://github.com/uber/deck.gl/blob/master/test/apps/viewport-transitions-flyTo/src/app.js\r\n  //  */\r\n\r\n  const _setViewStateToTableHeader = () => {\r\n    const header = cityioData.GEOGRID.properties.header\r\n\r\n    setViewState({\r\n      ...viewState,\r\n      longitude: header.longitude,\r\n      latitude: header.latitude,\r\n      zoom: zoomMap ?? 14,\r\n      pitch: pitchMap ?? 0,\r\n      bearing: 360 - header.rotation,\r\n      orthographic: true,\r\n    })\r\n  }\r\n\r\n  // /**\r\n  //  * Description. fix deck issue\r\n  //  * with rotate right botton\r\n  //  */\r\n  const _rightClickViewRotate = () => {\r\n    document\r\n      .getElementById('deckgl-wrapper')\r\n      .addEventListener('contextmenu', (evt) => evt.preventDefault())\r\n  }\r\n\r\n  const layersKey = {\r\n    ABM: ABMLayer({\r\n      data: ABM.trips,\r\n      cityioData,\r\n      ABMmode,\r\n      zoomLevel: viewState.zoom,\r\n      sliders,\r\n    }),\r\n    AGGREGATED_TRIPS: AggregatedTripsLayer({\r\n      data: ABM.trips,\r\n      cityioData,\r\n      ABMmode,\r\n    }),\r\n    GRID: GridLayer({\r\n      data: GEOGRID,\r\n      editOn: menu.includes('EDIT'),\r\n      state: {\r\n        selectedType,\r\n        keyDownState,\r\n        selectedCellsState,\r\n        pickingRadius,\r\n      },\r\n      updaters: {\r\n        setSelectedCellsState,\r\n        setDraggingWhileEditing,\r\n        setHoveredObj,\r\n      },\r\n      deckGL,\r\n    }),\r\n    ACCESS: AccessLayer({\r\n      data: access,\r\n      cellSize: cityioData.GEOGRID?.properties?.header.cellSize,\r\n    }),\r\n    TEXTUAL: TextualLayer({\r\n      data: textualData && textualData,\r\n      coordinates: GEOGRID,\r\n    }),\r\n\r\n    GEOJSON: GeojsonLayer({\r\n      data: geojsonData && geojsonData,\r\n    }),\r\n  }\r\n\r\n  const layerOrder = [\r\n    'TEXTUAL',\r\n    'ABM',\r\n    'AGGREGATED_TRIPS',\r\n    'GEOJSON',\r\n    'GRID',\r\n    'ACCESS',\r\n  ]\r\n\r\n  const _renderLayers = () => {\r\n    let layers = []\r\n    for (var layer of layerOrder) {\r\n      if (menu.includes(layer)) {\r\n        layers.push(layersKey[layer])\r\n      }\r\n    }\r\n    return layers\r\n  }\r\n  return (\r\n    <div\r\n      className=\"baseMap\"\r\n      onKeyDown={(e) => {\r\n        setKeyDownState(e.nativeEvent.key)\r\n      }}\r\n      onKeyUp={() => setKeyDownState(null)}\r\n      onMouseMove={(e) => setMousePos(e.nativeEvent)}\r\n      onMouseUp={() => setMouseDown(false)}\r\n      onMouseDown={() => setMouseDown(true)}\r\n    >\r\n      <PaintBrush\r\n        editOn={editOn}\r\n        mousePos={mousePos}\r\n        selectedType={selectedType}\r\n        pickingRadius={pickingRadius}\r\n        mouseDown={mouseDown}\r\n        hoveredObj={hoveredObj}\r\n      />\r\n      <AnimationComponent\r\n        toggles={{ ABMOn, rotateOn }}\r\n        state={{ sliders, viewState }}\r\n        updaters={{\r\n          listenToSlidersEvents,\r\n          updateSunDirection,\r\n          setViewState,\r\n        }}\r\n        dispatch={dispatch}\r\n      />\r\n\r\n      <DeckGL\r\n        ref={deckGL}\r\n        viewState={viewState}\r\n        onViewStateChange={onViewStateChange}\r\n        layers={_renderLayers()}\r\n        effects={effectsRef.current}\r\n        controller={{\r\n          touchZoom: onlyMap ? false : true,\r\n          touchRotate: onlyMap ? false : true,\r\n          scrollZoom: onlyMap ? false : true,\r\n          dragPan: onlyMap ? false : !draggingWhileEditing,\r\n          dragRotate: onlyMap ? false : !draggingWhileEditing,\r\n          keyboard: false,\r\n        }}\r\n      >\r\n        <StaticMap\r\n          asyncRender={false}\r\n          dragRotate={true}\r\n          reuseMaps={true}\r\n          mapboxApiAccessToken={process.env.REACT_APP_MAPBOX_TOKEN}\r\n          mapStyle={autoRotate ? \"\" : settings.map.mapStyle.sat}\r\n          preventStyleDiffing={true}\r\n        />\r\n      </DeckGL>\r\n    </div>\r\n  )\r\n}\r\n","import React, { useState, useEffect } from \"react\";\r\nimport { CircularGridLines, RadarChart, DiscreteColorLegend } from \"react-vis\";\r\nimport \"react-vis/dist/style.css\";\r\nimport \"./Radar.css\";\r\n\r\nconst radarSize = 300;\r\nconst colorRange = [\"#ff5278\", \"#660016\"];\r\n\r\nexport default function Radar(props) {\r\n    const [radarData, setRadarData] = useState(null);\r\n\r\n    const createRadarData = (indicators) => {\r\n        let r = {};\r\n        let f = {};\r\n        let domains = [];\r\n        for (let i = 0; i < indicators.length; i++) {\r\n            if (indicators[i].viz_type === \"radar\") {\r\n                r[indicators[i].name] = [indicators[i].value];\r\n                f[indicators[i].name] = [indicators[i].ref_value];\r\n                indicators[i].domain = [0, 1];\r\n                domains.push(indicators[i]);\r\n            }\r\n        }\r\n        return { radarData: [r, f], domains: domains };\r\n    };\r\n\r\n    useEffect(() => {\r\n        console.log('props radar', props);\r\n        if (\r\n            props &&\r\n            props.cityioData &&\r\n            props.cityioData.indicators &&\r\n            props.cityioData.indicators.length > 0\r\n        ) {\r\n            const d = createRadarData(props.cityioData.indicators);\r\n            setRadarData(d);\r\n        }\r\n    }, [props]);\r\n\r\n    return (\r\n        <div>\r\n            {radarData && radarData.domains && (\r\n                <>\r\n                    <RadarChart\r\n                        className=\"Radar blur\"\r\n                        animation\r\n                        data={radarData.radarData}\r\n                        domains={radarData.domains}\r\n                        colorRange={colorRange}\r\n                        style={{\r\n                            polygons: {\r\n                                fillOpacity: 0.2,\r\n                                strokeWidth: 2,\r\n                            },\r\n                            axes: {\r\n                                text: {\r\n                                    opacity: 0,\r\n                                    fontWeight: 700,\r\n                                    fill: \"white\",\r\n                                    fontFamily: \"Roboto Mono\",\r\n                                },\r\n                                strokeWidth: 0,\r\n                            },\r\n                            labels: {\r\n                                fontFamily: \"Roboto Mono\",\r\n\r\n                                textAnchor: \"middle\",\r\n                                fontSize: 10,\r\n                                fill: \"white\",\r\n                            },\r\n                        }}\r\n                        margin={{\r\n                            left: radarSize / 6,\r\n                            top: radarSize / 6,\r\n                            bottom: radarSize / 6,\r\n                            right: radarSize / 6,\r\n                        }}\r\n                        width={radarSize}\r\n                        height={radarSize}\r\n                    >\r\n                        <CircularGridLines\r\n                            style={{\r\n                                fill: \"white\",\r\n                                fillOpacity: 0.1,\r\n                                backgroundColor: \"#FFF\",\r\n                                opacity: 0.5,\r\n                                stroke: \"white\",\r\n                                width: 0.1,\r\n                            }}\r\n                            tickValues={[...new Array(11)].map(\r\n                                (v, i) => i / 10 - 1\r\n                            )}\r\n                        />\r\n                    </RadarChart>\r\n                    <DiscreteColorLegend\r\n                        items={[\"Design\", \"Reference\"]}\r\n                        colors={colorRange}\r\n                        style={{\r\n                            fontFamily: \"Roboto Mono\",\r\n                        }}\r\n                    />\r\n                </>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","import React, { useState, useEffect } from \"react\";\r\nimport {\r\n    FlexibleWidthXYPlot,\r\n    XAxis,\r\n    YAxis,\r\n    VerticalBarSeries,\r\n} from \"react-vis\";\r\nimport \"react-vis/dist/style.css\";\r\nimport { Typography, Box } from \"@material-ui/core\";\r\n\r\nexport default function BarChart(props) {\r\n    const radarSize = 250;\r\n\r\n    /**\r\n   data format \r\n    [\r\n    { x: 2, y: 10 },\r\n    { x: 4, y: 5 },\r\n    { x: 12, y: 15 },\r\n    ]\r\n     */\r\n\r\n    const [barChartData, setBarChartData] = useState(null);\r\n    const [hoveredNode, setHoveredNode] = useState(null);\r\n\r\n    useEffect(() => {\r\n        if (\r\n            props &&\r\n            props.cityioData &&\r\n            props.cityioData.indicators &&\r\n            props.cityioData.indicators.length > 0\r\n        ) {\r\n            const d = generateData(props.cityioData.indicators);\r\n\r\n            setBarChartData(d.barChartData);\r\n        }\r\n    }, [props]);\r\n\r\n    const generateData = (indicators) => {\r\n        let dataArr = [];\r\n\r\n        for (let i = 0; i < indicators.length; i++) {\r\n            if (indicators[i].viz_type === \"bar\") {\r\n                dataArr.push({\r\n                    x: indicators[i].name,\r\n                    y: indicators[i].value,\r\n                });\r\n            }\r\n        }\r\n\r\n        return {\r\n            barChartData: dataArr,\r\n        };\r\n    };\r\n\r\n    return (\r\n        <>\r\n            {barChartData && (\r\n                <>\r\n                    <Box flexDirection=\"column\">\r\n                        <Box alignContent=\"center\" p={3}>\r\n                            <FlexibleWidthXYPlot\r\n                                opacity={0.2}\r\n                                xType=\"ordinal\"\r\n                                width={radarSize}\r\n                                height={radarSize}\r\n                                stackBy=\"y\"\r\n                                yDomain={[0, 1]}\r\n                            >\r\n                                <XAxis\r\n                                    style={{\r\n                                        text: {\r\n                                            fill: \"#FFF\",\r\n                                            fontFamily: \"Roboto Mono\",\r\n                                        },\r\n                                    }}\r\n                                    tickLabelAngle={90}\r\n                                />\r\n                                <YAxis style={{ text: { fill: \"#FFF\" } }} />\r\n                                <VerticalBarSeries\r\n                                    animation={true}\r\n                                    onValueMouseOver={(d) => {\r\n                                        setHoveredNode(d);\r\n                                    }}\r\n                                    data={barChartData}\r\n                                />\r\n                            </FlexibleWidthXYPlot>\r\n                        </Box>\r\n                        <Box alignContent=\"center\">\r\n                            {hoveredNode && (\r\n                                <>\r\n                                    <Typography variant=\"caption\" gutterBottom>\r\n                                        {hoveredNode.x}\r\n                                    </Typography>\r\n                                    <Box m={3} />\r\n                                    <Typography gutterBottom>\r\n                                        {hoveredNode.y}\r\n                                    </Typography>\r\n                                </>\r\n                            )}\r\n                        </Box>\r\n                    </Box>\r\n                </>\r\n            )}\r\n        </>\r\n    );\r\n}\r\n","import React, { useState, useEffect } from \"react\";\r\nimport { rgbToHex } from \"../../../../utils/utils\";\r\nimport { RadialChart, Hint } from \"react-vis\";\r\nimport List from \"@material-ui/core/List\";\r\nimport ListItem from \"@material-ui/core/ListItem\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport \"../../../../../node_modules/react-vis/dist/style.css\";\r\nimport scenario from \"../../../../settings/LandUse_0.json\";\r\n\r\nexport default function AreaCalc(props) {\r\n    const radialRadius = 250;\r\n    const [hoveredRadial, setHoveredRadial] = useState(false);\r\n    const [areaData, setAreaData] = useState(null);\r\n    const header = props.cityioData.GEOGRID?.properties?.header;\r\n    useEffect(() => {\r\n        const calcArea = () => {\r\n            let gridProps = props.cityioData.GEOGRID.properties;\r\n            let cellSize = gridProps.header.cellSize;\r\n            let geoGridData = props.cityioData.GEOGRIDDATA;\r\n\r\n            let calcAreaObj = {};\r\n            geoGridData.forEach((gridCellData) => {\r\n                let typeName = gridCellData.name;\r\n                if (\r\n                    //    if this type is not null\r\n                    gridCellData.name !== \"None\"\r\n                ) {\r\n                    if (calcAreaObj.hasOwnProperty(typeName)) {\r\n                        calcAreaObj[typeName].count =\r\n                            calcAreaObj[typeName].count + 1;\r\n                        // avoid landuse with no height\r\n                        let height =\r\n                            gridCellData.height < 1 ? 1 : gridCellData.height;\r\n                        calcAreaObj[typeName].area =\r\n                            calcAreaObj[typeName].area + height * cellSize;\r\n                    } else {\r\n                        calcAreaObj[typeName] = {};\r\n                        calcAreaObj[typeName].area = 0;\r\n                        calcAreaObj[typeName].count = 0;\r\n                        calcAreaObj[typeName].name = typeName;\r\n                        calcAreaObj[typeName].color = rgbToHex(\r\n                            gridCellData.color[0],\r\n                            gridCellData.color[1],\r\n                            gridCellData.color[2]\r\n                        );\r\n                    }\r\n                }\r\n            });\r\n            //  convert to react-vis happy data format\r\n            let radialData = [];\r\n            for (const k in calcAreaObj) {\r\n                radialData.push(calcAreaObj[k]);\r\n            }\r\n\r\n            let data = {\r\n                children: radialData,\r\n                color: 1,\r\n            };\r\n            console.log('radialData', radialData);\r\n\r\n            return data;\r\n        };\r\n        const calcAreaForHCM = () => {\r\n            let gridProps = props.cityioData.GEOGRID.properties;\r\n            let cellSize = gridProps.header.cellSize;\r\n            let geoGridData = props.cityioData.GEOGRIDDATA;\r\n            // console.log('geoGridData',geoGridData);\r\n\r\n            let calcAreaObj = {};\r\n            geoGridData.forEach((gridCellData) => {\r\n                let typeName = gridCellData.LandUseTyp;\r\n                let typeCode = gridCellData.TypeCode;\r\n                let color = (gridCellData.RGB).split(',');\r\n                let shapeArea = Math.round(gridCellData.ShapeArea * 100) / 100;\r\n                if (\r\n                    //    if this type is not null\r\n                    gridCellData.TypeCode !== \"None\"\r\n                ) {\r\n                    if (calcAreaObj.hasOwnProperty(typeCode)) {\r\n                        // calcAreaObj[typeCode].area = calcAreaObj[typeCode].area + gridCellData.Shape_Area;\r\n                        calcAreaObj[typeCode].area = calcAreaObj[typeCode].area + shapeArea;\r\n                    } else {\r\n                        calcAreaObj[typeCode] = {};\r\n                        // calcAreaObj[typeCode].area = gridCellData.Shape_Area;\r\n                        calcAreaObj[typeCode].area = shapeArea;\r\n                        calcAreaObj[typeCode].name = typeName;\r\n                        calcAreaObj[typeCode].color = rgbToHex(\r\n                            parseInt(color[0]),\r\n                            parseInt(color[1]),\r\n                            parseInt(color[2]),\r\n                        );\r\n                    }\r\n                }\r\n            });\r\n            //  convert to react-vis happy data format\r\n            let radialData = [];\r\n            for (const k in calcAreaObj) {\r\n                radialData.push(calcAreaObj[k]);\r\n            }\r\n\r\n            let data = {\r\n                children: radialData,\r\n                color: 1,\r\n            };\r\n            // console.log('radialData', radialData);\r\n\r\n            return data;\r\n        };\r\n        let d;\r\n        if (header.tableName && header.tableName.includes('hcm_')) {\r\n            d = calcAreaForHCM();\r\n        }\r\n        else {\r\n            d = calcArea();\r\n        }\r\n        setAreaData(d);\r\n    }, [props]);\r\n\r\n    return (\r\n        <List>\r\n            {areaData && areaData.children && (\r\n                <ListItem alignItems=\"center\">\r\n                    <RadialChart\r\n                        colorType=\"literal\"\r\n                        animation={true}\r\n                        className={\"donut-chart-example\"}\r\n                        innerRadius={radialRadius / 2 - radialRadius / 5}\r\n                        radius={radialRadius / 2}\r\n                        getLabel={(d) => d.name}\r\n                        labelsRadiusMultiplier={0.95}\r\n                        labelsStyle={{\r\n                            textAnchor: \"middle\",\r\n                            font: \"sans-serif\",\r\n                            fontSize: 11,\r\n                            fill: \"#FFF\",\r\n                            textShadow: \"2px 2px 2px #000\",\r\n                            fontFamily: \"Roboto Mono\",\r\n                        }}\r\n                        showLabels\r\n                        getAngle={(d) => d.area}\r\n                        data={areaData.children}\r\n                        onValueMouseOver={(evt) => setHoveredRadial(evt)}\r\n                        onSeriesMouseOut={() => setHoveredRadial(false)}\r\n                        width={radialRadius}\r\n                        height={radialRadius}\r\n                        padAngle={0.01}\r\n                    >\r\n                        {hoveredRadial !== false && (\r\n                            <Hint value={hoveredRadial}>\r\n                                <div\r\n                                    style={{\r\n                                        background: \"rgba(0,0,0,0.8)\",\r\n                                        fontSize: 14,\r\n                                    }}\r\n                                >\r\n                                    <Typography\r\n                                        variant={\"caption\"}\r\n                                        gutterBottom\r\n                                    >\r\n                                        Area: {hoveredRadial.area} sqm\r\n                                    </Typography>\r\n                                </div>\r\n                            </Hint>\r\n                        )}\r\n                    </RadialChart>\r\n                </ListItem>\r\n            )}\r\n\r\n            {hoveredRadial.name && (\r\n                <List>\r\n                    <ListItem>\r\n                        <Typography variant=\"caption\">\r\n                            {hoveredRadial.name}\r\n                        </Typography>\r\n                    </ListItem>\r\n                    <ListItem>\r\n                        <Typography>{hoveredRadial.area} sqm</Typography>\r\n                    </ListItem>\r\n                </List>\r\n            )}\r\n        </List>\r\n    );\r\n}\r\n","import React from \"react\";\r\nimport { List, ListItem, Divider } from \"@material-ui/core\";\r\nimport Radar from \"./Radar\";\r\nimport BarChart from \"./BarChart\";\r\nimport AreaCalc from \"./AreaCalc\";\r\n\r\nfunction VisContainer(props) {\r\n    console.log('vo viscontainer');\r\n    return (\r\n        <>\r\n            {props.cityIOdata && (\r\n                <List>\r\n                    <ListItem style={{justifyContent: \"center\"}}>\r\n                        <AreaCalc cityioData={props.cityIOdata} />\r\n                    </ListItem>\r\n\r\n                    <Divider />\r\n\r\n                    <ListItem style={{justifyContent: \"center\"}}>\r\n                        <Radar cityioData={props.cityIOdata} />\r\n                    </ListItem>\r\n\r\n                    <Divider />\r\n\r\n                    <ListItem style={{justifyContent: \"center\"}}>\r\n                        <BarChart cityioData={props.cityIOdata} />\r\n                    </ListItem>\r\n                </List>\r\n            )}\r\n        </>\r\n    );\r\n}\r\n\r\nexport default VisContainer;\r\n","import MenuContainer from './MenuContainer'\r\nimport MapContainer from './DeckglMap'\r\nimport LoadingSpinner from './CityIO/LoadingSpinner'\r\nimport VisContainer from './VisContainer'\r\nimport {\r\n  makeStyles,\r\n  Grid,\r\n  Card,\r\n  CardContent,\r\n  Container,\r\n} from '@material-ui/core'\r\nimport Page from '../../layouts/Page'\r\n\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    margin: 'auto',\r\n    height: '100%',\r\n    paddingBottom: theme.spacing(3),\r\n    paddingTop: theme.spacing(3),\r\n  },\r\n}))\r\n\r\n\r\nexport default function CSjsMain(props) {\r\n  const classes = useStyles()\r\n  const tableName = props.tableName\r\n  const cityIOdata = props.cityIOdata\r\n\r\n  return (\r\n    <Page className={classes.root} title=\"CitySCopeJS\">\r\n      <LoadingSpinner />\r\n      <Container maxWidth={null}>\r\n        <Grid container spacing={5}>\r\n          <Grid item xs={6} l={3} md={3} xl={2} container>\r\n            <Grid item container direction=\"column\" spacing={2}>\r\n              <Grid item xs={12} l={12} md={12} xl={12}>\r\n                <Card\r\n                  elevation={15}\r\n                  style={{\r\n                    maxHeight: '85vh',\r\n                    overflow: 'auto',\r\n                  }}\r\n                >\r\n                  <CardContent>\r\n                    <MenuContainer tableName={tableName} />\r\n                  </CardContent>\r\n                </Card>\r\n              </Grid>\r\n            </Grid>\r\n          </Grid>\r\n\r\n          <Grid item xs={6} l={6} md={6} xl={8}>\r\n            <Card\r\n              elevation={15}\r\n              style={{\r\n                height: '85vh',\r\n                width: '100%',\r\n                position: 'relative',\r\n              }}\r\n            >\r\n              {/* <Test/> */}\r\n              <MapContainer />\r\n            </Card>\r\n          </Grid>\r\n          <Grid item xs={6} l={3} md={3} xl={2}>\r\n            <Card\r\n              elevation={15}\r\n              style={{\r\n                maxHeight: '85vh',\r\n                overflow: 'auto',\r\n              }}\r\n            >\r\n              <VisContainer cityIOdata={cityIOdata} />\r\n            </Card>\r\n          </Grid>\r\n        </Grid>\r\n      </Container>\r\n    </Page>\r\n  )\r\n}\r\n","import { useState, useEffect } from 'react'\r\nimport { useSelector } from 'react-redux'\r\nimport CityIO from './CityIO/cityIO'\r\nimport CityIOviewer from '../CityIOviewer'\r\nimport LoadingSpinner from './CityIO/LoadingSpinner'\r\nimport CSjsMain from './CSjsMain'\r\n\r\nexport default function CityScopeJS() {\r\n  // get the table name for cityIO comp\r\n  const [tableName, setTableName] = useState()\r\n  const [isDone, setIsdone] = useState(false)\r\n  // on init, get the adress URL\r\n  // to search for  a table\r\n  useEffect(() => {\r\n    let url = window.location.toString()\r\n    let pre = 'cityscope='\r\n    let cityscopePrjName = url.substring(url.indexOf(pre) + pre.length).toLowerCase()\r\n\r\n    \r\n    // check URL for proper CS project link\r\n    if (url.indexOf(pre) !== -1 && cityscopePrjName.length > 0) {\r\n      setTableName(cityscopePrjName)\r\n    } else {\r\n      /** if failed to get table name from\r\n       * url location, resote to the\r\n       * CityIO viewer\r\n       *\r\n       */\r\n      setIsdone(true)\r\n    }\r\n  }, [])\r\n\r\n  // wait for 'ready' flag from cityIO when app is ready to start\r\n  const isReady = useSelector((state) => state.READY)\r\n  const cityIOdata = useSelector((state) => state.CITYIO)\r\n\r\n  return (\r\n    <>\r\n      {tableName && <CityIO tableName={tableName} />}\r\n      {isReady && <CSjsMain cityIOdata={cityIOdata} tableName={tableName}/>}\r\n      {isDone && <CityIOviewer />}\r\n      <LoadingSpinner />\r\n    </>\r\n  )\r\n}\r\n","import { useEffect, useState } from \"react\";\r\nimport axios from \"axios\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport {\r\n    getCityioData,\r\n    setReadyState,\r\n    setLoadingState,\r\n    addLoadingModules,\r\n    removeLoadingModules,\r\n} from \"../../../redux/actions\";\r\nimport settings from \"../../../settings/settings.json\";\r\n\r\nconst getAPICall = async (URL) => {\r\n    try {\r\n        // ! should add 'retry' here\r\n        // ! https://stackoverflow.com/questions/56074531/how-to-retry-5xx-requests-using-axios\r\n        const response = await axios.get(URL);\r\n        return response.data;\r\n    } catch (err) {\r\n        console.log(err);\r\n    }\r\n};\r\n\r\nexport default function CityIO(props) {\r\n    const { tableName } = props;\r\n    const [hashId, setHashId] = useState(null);\r\n    const [hashes, setHashes] = useState({});\r\n    const cityioURL = `${settings.cityIO.baseURL}${tableName}/`;\r\n    const cityioData = useSelector((state) => state.CITYIO);\r\n\r\n    const dispatch = useDispatch();\r\n\r\n    /**\r\n     * start fetching API hashes to check for new data\r\n     */\r\n    useEffect(() => {\r\n        const timer = setTimeout(update, settings.cityIO.interval);\r\n        console.log(\"reading cityIO every -> \" + settings.cityIO.interval + \"ms\");\r\n        return () => clearTimeout(timer);\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, []);\r\n\r\n    async function update() {\r\n        // recursively get hashes\r\n        const newHashId = await getAPICall(cityioURL + \"/meta/id/\");\r\n        if (hashId !== newHashId) {\r\n            setHashId(newHashId);\r\n        }\r\n        setTimeout(update, settings.cityIO.interval);\r\n    }\r\n\r\n    async function getModules() {\r\n        const newHashes = await getAPICall(cityioURL + \"/meta/hashes/\");\r\n        const promises = [];\r\n        const loadingModules = [];\r\n        const pickedModules = settings.cityIO.cityIOmodules.map((x) => x.name);\r\n        // for each of the modules in settings, add api call to promises\r\n        pickedModules.forEach((module) => {\r\n            if (hashes[module] !== newHashes[module]) {\r\n                promises.push(getAPICall(`${cityioURL}/${module}/`));\r\n                loadingModules.push(module);\r\n            } else {\r\n                promises.push(null);\r\n            }\r\n        });\r\n        dispatch(addLoadingModules(loadingModules));\r\n        const modules = await Promise.all(promises);\r\n        setHashes(newHashes);\r\n\r\n        // update cityio object with modules data\r\n        const modulesData = pickedModules.reduce((obj, k, i) => {\r\n            if (modules[i]) {\r\n                console.log(`updating ${k}`);\r\n                return { ...obj, [k]: modules[i] };\r\n            } else {\r\n                return obj;\r\n            }\r\n        }, cityioData);\r\n        modulesData.tableName = tableName;\r\n\r\n        dispatch(removeLoadingModules(loadingModules));\r\n\r\n        // send to cityio\r\n        dispatch(getCityioData(modulesData));\r\n        console.log(\"done updating from cityIO\");\r\n\r\n        // initializes rendering of Menu and Map containers\r\n        dispatch(setReadyState(true));\r\n        dispatch(setLoadingState(false));\r\n    }\r\n\r\n    useEffect(() => {\r\n        //! only update if hashId changes\r\n        if (!hashId) {\r\n            return;\r\n        }\r\n        // reset the state of loading flag\r\n        dispatch(setLoadingState(true));\r\n        \r\n        getModules();\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [hashId]);\r\n\r\n    return null;\r\n}\r\n","import { HeatmapLayer } from \"deck.gl\";\r\nimport settings from \"../../../../../settings/settings.json\";\r\n\r\nexport default function AccessLayer({ active, data, accessToggle }) {\r\n    return new HeatmapLayer({\r\n        visible: active,\r\n        id: \"ACCESS\",\r\n        colorRange: settings.map.layers.heatmap.colors,\r\n        radiusPixels: 200,\r\n        opacity: 0.5,\r\n        threshold: 0.5,\r\n        data,\r\n        getPosition: (d) => d.coordinates,\r\n        getWeight: (d) => d.values[accessToggle],\r\n        updateTriggers: {\r\n            getWeight: [accessToggle],\r\n        },\r\n    });\r\n}\r\n","import { PathLayer } from \"deck.gl\";\r\nimport { hexToRgb } from \"../../../../../utils/utils\";\r\n\r\nexport default function AggregatedTripsLayer({\r\n    active,\r\n    data,\r\n    cityioData,\r\n    ABMmode,\r\n}) {\r\n    return new PathLayer({\r\n        visible: active,\r\n        id: \"AGGREGATED_TRIPS\",\r\n        _shadow: false,\r\n        data,\r\n        getPath: (d) => {\r\n            const noisePath =\r\n                Math.random() < 0.5\r\n                    ? Math.random() * 0.00005\r\n                    : Math.random() * -0.00005;\r\n            for (let i in d.path) {\r\n                d.path[i][0] = d.path[i][0] + noisePath;\r\n                d.path[i][1] = d.path[i][1] + noisePath;\r\n                d.path[i][2] = d.mode[0] * 2;\r\n            }\r\n            return d.path;\r\n        },\r\n        getColor: (d) => {\r\n            let col = hexToRgb(cityioData.ABM2.attr[ABMmode][d[ABMmode]].color);\r\n            return col;\r\n        },\r\n        opacity: 0.2,\r\n        getWidth: 1.5,\r\n\r\n        updateTriggers: {\r\n            getColor: ABMmode,\r\n        },\r\n        transitions: {\r\n            getColor: 500,\r\n        },\r\n    });\r\n}\r\n","import { TripsLayer } from \"@deck.gl/geo-layers\";\r\nimport { hexToRgb } from \"../../../../../utils/utils\";\r\n\r\n//  * remap line width\r\nconst _remapValues = (value) => {\r\n    let remap =\r\n        value > 15 && value < 25 ? 3 : value < 15 && value > 10 ? 12 : 30;\r\n    return remap;\r\n};\r\n\r\nexport default function ABMLayer({\r\n    active,\r\n    data,\r\n    cityioData,\r\n    ABMmode,\r\n    zoomLevel,\r\n    time,\r\n}) {\r\n    return new TripsLayer({\r\n        id: \"ABM\",\r\n        data,\r\n        getPath: (d) => d.path,\r\n        getTimestamps: (d) => d.timestamps,\r\n        getColor: (d) => {\r\n            let col = hexToRgb(cityioData.ABM2.attr[ABMmode][d[ABMmode]].color);\r\n            return col;\r\n        },\r\n        visible: active,\r\n        getWidth: 1,\r\n        widthScale: _remapValues(zoomLevel),\r\n        opacity: 0.8,\r\n        rounded: true,\r\n        trailLength: 500,\r\n        currentTime: time,\r\n\r\n        updateTriggers: {\r\n            getColor: ABMmode,\r\n        },\r\n        transitions: {\r\n            getColor: 500,\r\n        },\r\n    });\r\n}\r\n","import { GeoJsonLayer } from \"deck.gl\";\r\n\r\nexport default function GridLayer({ active, data }) {\r\n    return new GeoJsonLayer({\r\n        visible: active,\r\n        id: \"GRID\",\r\n        data,\r\n        extruded: true,\r\n        wireframe: true,\r\n        lineWidthScale: 1,\r\n        lineWidthMinPixels: 2,\r\n        getElevation: (d) => d.properties.height,\r\n        getFillColor: (d) => d.properties.color,\r\n\r\n        transitions: {\r\n            getFillColor: 500,\r\n            getElevation: 500,\r\n        },\r\n    });\r\n}\r\n","import { useState, useEffect, useRef } from 'react'\r\nimport { useSelector } from 'react-redux'\r\nimport {\r\n  _proccessAccessData,\r\n  _proccessGridData,\r\n  _setupSunEffects,\r\n  updateSunDirection,\r\n} from '../../../../utils/utils'\r\nimport { StaticMap } from 'react-map-gl'\r\nimport DeckGL from '@deck.gl/react'\r\nimport 'mapbox-gl/dist/mapbox-gl.css'\r\nimport settings from '../../../../settings/settings.json'\r\nimport {\r\n  AccessLayer,\r\n  AggregatedTripsLayer,\r\n  ABMLayer,\r\n  GridLayer,\r\n} from './deckglLayers'\r\n\r\nexport default function PrjDeckGLMap(props) {\r\n  const [viewState, setViewState] = useState(settings.map.initialViewState)\r\n  const [access, setAccess] = useState(null)\r\n  const [GEOGRID, setGEOGRID] = useState(null)\r\n  const [ABM, setABM] = useState({})\r\n  const effectsRef = useRef()\r\n  const deckGL = useRef()\r\n  const [cityioData] = useSelector((state) => [state.CITYIO])\r\n  const viewSettings = useSelector((state) => state.UI_WEBSOCKET_DATA)\r\n\r\n  useEffect(() => {\r\n    if (!effectsRef.current) {\r\n      return\r\n    }\r\n    updateSunDirection(props.viewSettings.time, effectsRef)\r\n  }, [props.viewSettings])\r\n\r\n  const _setViewStateToTableHeader = () => {\r\n    const header = cityioData.GEOGRID.properties.header\r\n\r\n    setViewState({\r\n      ...viewState,\r\n      longitude: header.longitude,\r\n      latitude: header.latitude,\r\n      zoom: 15,\r\n      pitch: 0,\r\n      bearing: 360 - header.rotation,\r\n      orthographic: true,\r\n    })\r\n  }\r\n\r\n  useEffect(() => {\r\n    // fix deck view rotate\r\n    _rightClickViewRotate()\r\n    // setup sun effects\r\n    _setupSunEffects(effectsRef, cityioData.GEOGRID.properties.header)\r\n\r\n    // on init, check if prev. local storage with\r\n    // view state exist. If so, load it.\r\n    if (localStorage.getItem('deckGLviewState')) {\r\n      console.log('loading prev. deckGLviewState...')\r\n      let vs = localStorage.getItem('deckGLviewState')\r\n      setViewState(JSON.parse(vs))\r\n    } else {\r\n      // zoom map on CS table location\r\n      _setViewStateToTableHeader()\r\n    }\r\n\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    effectsRef.current[0].shadowColor = [0, 0, 0, 1]\r\n  }, [cityioData.GEOGRID.properties.header])\r\n\r\n  useEffect(() => {\r\n    setGEOGRID(_proccessGridData(cityioData))\r\n    if (cityioData.access) {\r\n      setAccess(_proccessAccessData(cityioData))\r\n    }\r\n    if (cityioData.ABM2) {\r\n      setABM(cityioData.ABM2)\r\n    }\r\n  }, [cityioData])\r\n\r\n  const onViewStateChange = ({ viewState }) => {\r\n    //    save current view state to local sotrage\r\n    localStorage.setItem('deckGLviewState', JSON.stringify(viewState))\r\n\r\n    setViewState(viewState)\r\n  }\r\n\r\n  const _rightClickViewRotate = () => {\r\n    document\r\n      .getElementById('deckgl-wrapper')\r\n      .addEventListener('contextmenu', (evt) => evt.preventDefault())\r\n  }\r\n\r\n  const layersKey = {\r\n    ABM: ABMLayer({\r\n      active: viewSettings.ABMLayer.active,\r\n      data: ABM.trips,\r\n      cityioData: cityioData,\r\n      ABMmode: viewSettings.ABMLayer.ABMmode,\r\n      zoomLevel: viewSettings.ABMLayer.zoomLevel,\r\n      time: viewSettings.time,\r\n    }),\r\n    AGGREGATED_TRIPS: AggregatedTripsLayer({\r\n      active: viewSettings.AggregatedTripsLayer.active,\r\n      data: ABM.trips,\r\n      cityioData: cityioData,\r\n      ABMmode: viewSettings.AggregatedTripsLayer.ABMmode,\r\n    }),\r\n    GRID: GridLayer({\r\n      active: viewSettings.GridLayer.active,\r\n      data: GEOGRID,\r\n    }),\r\n    ACCESS: AccessLayer({\r\n      active: viewSettings.AccessLayer.active,\r\n      data: access,\r\n      accessToggle: viewSettings.AccessLayer.accessToggle,\r\n    }),\r\n  }\r\n\r\n  const layerOrder = ['ABM', 'AGGREGATED_TRIPS', 'GRID', 'ACCESS']\r\n\r\n  const _renderLayers = () => {\r\n    let layers = []\r\n    for (var layer of layerOrder) {\r\n      layers.push(layersKey[layer])\r\n    }\r\n    return layers\r\n  }\r\n\r\n  return (\r\n    <DeckGL\r\n      ref={deckGL}\r\n      viewState={viewState}\r\n      onViewStateChange={onViewStateChange}\r\n      layers={_renderLayers()}\r\n      effects={effectsRef.current}\r\n      controller={{\r\n        keyboard: false,\r\n      }}\r\n    >\r\n      <StaticMap\r\n        asyncRender={false}\r\n        dragRotate={true}\r\n        reuseMaps={true}\r\n        mapboxApiAccessToken={process.env.REACT_APP_MAPBOX_TOKEN}\r\n        mapStyle={settings.map.mapStyle.sat}\r\n        preventStyleDiffing={true}\r\n      />\r\n    </DeckGL>\r\n  )\r\n}\r\n","import { Matrix3d, RectPoints, Vector } from \"./Keystoner\";\r\nconst { solve } = require(\"numeric\");\r\n\r\nexport const round = (num: number, precision: number) => {\r\n    var factor = Math.pow(10, precision);\r\n    var tempNumber = num * factor;\r\n    var roundedTempNumber = Math.round(tempNumber);\r\n    return roundedTempNumber / factor;\r\n};\r\n\r\n// tslint:disable-next-line:no-any\r\nexport const range = (num: number) =>\r\n    (Array as any)(num)\r\n        .fill()\r\n        .map((_: any, i: any) => i * i);\r\n\r\nexport const transformPointsToMatrix = (\r\n    sourcePoints: RectPoints,\r\n    targetPoints: RectPoints\r\n): Matrix3d => {\r\n    const a: number[][] = [];\r\n    const b: number[] = [];\r\n\r\n    for (let i = 0, n = sourcePoints.length; i < n; ++i) {\r\n        const [fromX, fromY] = sourcePoints[i];\r\n        const [toX, toY] = targetPoints[i];\r\n\r\n        a.push(\r\n            [fromX, fromY, 1, 0, 0, 0, -fromX * toX, -fromY * toX],\r\n            [0, 0, 0, fromX, fromY, 1, -fromX * toY, -fromY * toY]\r\n        );\r\n\r\n        b.push(toX, toY);\r\n    }\r\n\r\n    const h = solve(a, b, true);\r\n\r\n    return [\r\n        h[0],\r\n        h[3],\r\n        0,\r\n        h[6],\r\n        h[1],\r\n        h[4],\r\n        0,\r\n        h[7],\r\n        0,\r\n        0,\r\n        1,\r\n        0,\r\n        h[2],\r\n        h[5],\r\n        0,\r\n        1,\r\n    ].map((num) => round(num, 10)) as Matrix3d;\r\n};\r\n\r\nexport const matrixToTransform = (matrix: Matrix3d) =>\r\n    `matrix3d(${matrix.join(\", \")})`;\r\n\r\nexport const vectorToTransform = (vector: Vector) =>\r\n    `translate(${vector[0]}px, ${vector[1]}px)`;\r\n","import * as React from \"react\";\r\nimport { Anchor, Vector } from \"./Keystoner\";\r\nimport { vectorToTransform } from \"./util\";\r\n\r\nconst anchorSize = 20;\r\nconst halfAnchor = anchorSize / 1.5;\r\n\r\nconst styles = {\r\n    container: {\r\n        width: anchorSize,\r\n        height: anchorSize,\r\n        borderRadius: \"50%\",\r\n        position: \"absolute\" as \"absolute\",\r\n        border: \"1px solid white\",\r\n        cursor: \"move\",\r\n    },\r\n    \"top-left\": {\r\n        left: -halfAnchor,\r\n        top: -halfAnchor,\r\n    },\r\n    \"bottom-left\": {\r\n        left: -halfAnchor,\r\n        bottom: -halfAnchor,\r\n    },\r\n    \"top-right\": {\r\n        top: -halfAnchor,\r\n        right: -halfAnchor,\r\n    },\r\n    \"bottom-right\": {\r\n        bottom: -halfAnchor,\r\n        right: -halfAnchor,\r\n    },\r\n};\r\n\r\nexport interface Props {\r\n    position: Anchor;\r\n    onMouseEnter?: (position: Anchor) => void;\r\n    // tslint:disable-next-line:no-any\r\n    onMouseDown: (evt: any, position: Anchor) => void;\r\n    onMouseUp: (position: Anchor) => void;\r\n    translation: Vector;\r\n    style?: React.CSSProperties;\r\n    className?: string;\r\n}\r\n\r\nexport const AnchorComponent: React.StatelessComponent<Props> = ({\r\n    position,\r\n    translation,\r\n    onMouseEnter,\r\n    onMouseDown,\r\n    onMouseUp,\r\n    className = \"\",\r\n    style = {},\r\n}) => (\r\n    <div\r\n        onMouseEnter={() => onMouseEnter && onMouseEnter(position)}\r\n        onMouseDown={(evt) => onMouseDown(evt, position)}\r\n        onMouseUp={() => onMouseUp(position)}\r\n        className={className}\r\n        style={{\r\n            ...styles.container,\r\n            ...styles[position],\r\n            ...style,\r\n            transform: vectorToTransform(translation),\r\n        }}\r\n    />\r\n);\r\n","import * as React from \"react\";\r\nimport { AnchorComponent } from \"./anchor\";\r\nimport {\r\n    matrixToTransform,\r\n    transformPointsToMatrix,\r\n    vectorToTransform,\r\n} from \"./util\";\r\n\r\n\r\n// Component interfaces\r\nexport interface Props {\r\n    style?: React.CSSProperties;\r\n    className?: string;\r\n    isEditMode?: boolean;\r\n    x?: number;\r\n    y?: number;\r\n    anchorStyle?: React.CSSProperties;\r\n    anchorClassName?: string;\r\n}\r\n\r\nexport interface Context {\r\n    isEditMode: boolean;\r\n}\r\n\r\nexport interface State {\r\n    matrix: Matrix3d;\r\n    translateDelta: { [key: string]: Vector };\r\n    sourcePoints?: RectPoints;\r\n    transformOrigin: Vector;\r\n    containerTranslate: Vector;\r\n}\r\n\r\nconst styles = {\r\n    container: {\r\n        position: \"relative\" as \"relative\",\r\n    },\r\n};\r\n\r\n// Sorted\r\nexport type Anchor = \"top-left\" | \"top-right\" | \"bottom-right\" | \"bottom-left\";\r\nconst anchors: Anchor[] = [\r\n    \"top-left\",\r\n    \"top-right\",\r\n    \"bottom-right\",\r\n    \"bottom-left\",\r\n];\r\n\r\n// 4x4 matrix\r\nexport type Matrix3d = [\r\n    number,\r\n    number,\r\n    number,\r\n    number,\r\n    number,\r\n    number,\r\n    number,\r\n    number,\r\n    number,\r\n    number,\r\n    number,\r\n    number,\r\n    number,\r\n    number,\r\n    number,\r\n    number\r\n];\r\n\r\n// top-left, top-right, bottom-right, bottom-left\r\nexport type RectPoints = [Vector, Vector, Vector, Vector];\r\n\r\nexport type Vector = [number, number]; // [x, y]\r\n\r\nconst defaultMatrix: Matrix3d = [\r\n    1,\r\n    0,\r\n    0,\r\n    0,\r\n    0,\r\n    1,\r\n    0,\r\n    0,\r\n    0,\r\n    0,\r\n    1,\r\n    0,\r\n    0,\r\n    0,\r\n    0,\r\n    1, // second and third for x and y position of element\r\n];\r\n\r\nconst _setDeltaVal = () => {\r\n    let deltaInitVals: any = {};\r\n    anchors.forEach((e) => {\r\n        deltaInitVals[e] = [0, 0];\r\n    });\r\n    return deltaInitVals;\r\n};\r\n\r\nexport default class Keystoner extends React.Component<Props, State> {\r\n    container: HTMLElement | null;\r\n    layerTranslateDelta: Vector | undefined;\r\n    anchorTranslateDelta: Vector | undefined;\r\n    isAnchorDragging = false;\r\n    targetPoints: RectPoints;\r\n    anchorMoving: Anchor | undefined;\r\n    state: State = {\r\n        matrix: defaultMatrix,\r\n        translateDelta: _setDeltaVal(),\r\n        sourcePoints: undefined,\r\n        transformOrigin: [0, 0],\r\n        containerTranslate: [this.props.x || 0, this.props.y || 0],\r\n    };\r\n\r\n    componentDidMount() {\r\n        window.addEventListener(\"mousemove\", this.onAnchorMouseMove);\r\n        window.addEventListener(\"mousemove\", this.onMouseMove);\r\n        if (this.container) {\r\n            const { width, height } = this.container.getBoundingClientRect();\r\n            const sourcePoints = [\r\n                [0, 0],\r\n                [width, 0],\r\n                [width, height],\r\n                [0, height],\r\n            ] as RectPoints;\r\n            this.targetPoints = [...sourcePoints] as RectPoints;\r\n            this.setState({ sourcePoints });\r\n\r\n      if (localStorage.getItem(\"projMap\")) {\r\n                console.log(\"loading prev. projMap...\");\r\n                let ls: any = localStorage.getItem(\"projMap\");\r\n                this.setState(JSON.parse(ls));\r\n            }  \r\n\r\n\r\n        }\r\n    }\r\n    componentDidUpdate(prevProps: any, prevState: State) {\r\n\r\n            console.log(\"saving edited projMap...\", JSON.stringify(prevState));\r\n            // save whatever keystone was in state\r\n            localStorage.setItem(\"projMap\", JSON.stringify(prevState));\r\n      \r\n    }\r\n\r\n    componentWillUnmount() {\r\n        window.removeEventListener(\"mousemove\", this.onAnchorMouseMove);\r\n        window.removeEventListener(\"mousemove\", this.onMouseMove);\r\n    }\r\n\r\n    onAnchorMouseDown = (evt: any, position: any) => {\r\n        evt.stopPropagation();\r\n        this.anchorTranslateDelta = [\r\n            evt.pageX - this.state.translateDelta[position][0],\r\n            evt.pageY - this.state.translateDelta[position][1],\r\n        ];\r\n\r\n        this.anchorMoving = position;\r\n    };\r\n\r\n    onAnchorMouseMove = (evt: any) => {\r\n        if (\r\n            !this.anchorTranslateDelta ||\r\n            !this.state.sourcePoints ||\r\n            !this.anchorMoving\r\n        ) {\r\n            return;\r\n        }\r\n        evt.preventDefault();\r\n        evt.stopPropagation();\r\n        const vectorIndexToModify = anchors.indexOf(this.anchorMoving);\r\n\r\n        const deltaX = evt.pageX - this.anchorTranslateDelta[0];\r\n        const deltaY = evt.pageY - this.anchorTranslateDelta[1];\r\n\r\n        this.targetPoints[vectorIndexToModify] = [\r\n            this.state.sourcePoints[vectorIndexToModify][0] + deltaX,\r\n            this.state.sourcePoints[vectorIndexToModify][1] + deltaY,\r\n        ];\r\n\r\n        this.setState({\r\n            matrix: transformPointsToMatrix(\r\n                this.state.sourcePoints,\r\n                this.targetPoints!\r\n            ),\r\n            translateDelta: {\r\n                ...this.state.translateDelta,\r\n                [this.anchorMoving]: [deltaX, deltaY],\r\n            },\r\n        });\r\n    };\r\n\r\n    onAnchorMouseUp = (position: any) => {\r\n        this.anchorTranslateDelta = undefined;\r\n        this.anchorMoving = undefined;\r\n    };\r\n\r\n    onMouseUp = () => {\r\n        this.layerTranslateDelta = undefined;\r\n    };\r\n\r\n    onMouseMove = (evt: any) => {\r\n        if (!this.layerTranslateDelta || !this.props.isEditMode) {\r\n            return;\r\n        }\r\n\r\n        const newVector: Vector = [\r\n            evt.pageX - this.layerTranslateDelta[0],\r\n            evt.pageY - this.layerTranslateDelta[1],\r\n        ];\r\n\r\n        this.setState({\r\n            containerTranslate: newVector,\r\n        });\r\n    };\r\n\r\n    onMouseDown = (evt: any) => {\r\n        const { containerTranslate } = this.state;\r\n        this.layerTranslateDelta = [\r\n            evt.pageX - containerTranslate[0],\r\n            evt.pageY - containerTranslate[1],\r\n        ];\r\n    };\r\n\r\n\r\n\r\n\r\n    render() {\r\n        const {\r\n            style,\r\n            isEditMode,\r\n            className,\r\n            anchorStyle,\r\n            anchorClassName,\r\n        } = this.props;\r\n        const {\r\n            translateDelta,\r\n            matrix,\r\n            containerTranslate,\r\n            transformOrigin,\r\n        } = this.state;\r\n\r\n        return (\r\n            <>\r\n              \r\n         \r\n\r\n                <div\r\n          \r\n                    onMouseDown={this.onMouseDown}\r\n                    onMouseUp={this.onMouseUp}\r\n                    style={{\r\n                        cursor: isEditMode ? \"all-scroll\" : \"inherit\",\r\n                        position: \"relative\",\r\n                        display: \"inline-block\",\r\n                        transform: vectorToTransform(containerTranslate),\r\n                    }}\r\n                >\r\n                    <div\r\n                        ref={(ref) => {\r\n                            this.container = ref;\r\n                        }}\r\n                        style={{\r\n                            ...styles.container,\r\n                            ...style,\r\n                            pointerEvents: isEditMode ? \"none\" : \"all\",\r\n                            transform: matrixToTransform(matrix),\r\n                            transformOrigin: `${transformOrigin[0]}px ${transformOrigin[1]}px 0px`,\r\n                        }}\r\n                        className={className}\r\n                    >\r\n                        {this.props.children}\r\n                    </div>\r\n                    {isEditMode && (\r\n                        <div>\r\n                            {anchors.map((anchor, index) => (\r\n                                <AnchorComponent\r\n                                    style={anchorStyle}\r\n                                    className={anchorClassName}\r\n                                    key={anchor}\r\n                                    translation={translateDelta[anchor]}\r\n                                    position={anchor}\r\n                                    onMouseDown={this.onAnchorMouseDown}\r\n                                    onMouseUp={this.onAnchorMouseUp}\r\n                                />\r\n                            ))}\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </>\r\n        );\r\n    }\r\n}\r\n","import React from \"react\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\nimport DeleteIcon from \"@material-ui/icons/Delete\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    button: {\r\n        margin: theme.spacing(1),\r\n        position: \"fixed\",\r\n        bottom: \"1vh\",\r\n        zIndex: 1001,\r\n        maxWidth: \"50vw\",\r\n    },\r\n}));\r\n\r\nexport default function DeleteLocalStorage() {\r\n    const classes = useStyles();\r\n\r\n    return (\r\n        <Grid container alignItems=\"center\" justify=\"center\">\r\n            <Button\r\n                variant=\"contained\"\r\n                color=\"secondary\"\r\n                className={classes.button}\r\n                startIcon={<DeleteIcon />}\r\n            >\r\n                Reset Projection Mapping\r\n            </Button>\r\n        </Grid>\r\n    );\r\n}\r\n","import { useState, useEffect } from 'react'\r\nimport PrjDeckGLMap from './PrjDeckGLMap'\r\nimport Keystoner from './Components/Keystoner'\r\nimport DeleteLocalStorage from './Components/deleteLocalStorage'\r\n\r\nexport default function Keystone() {\r\n  const [editMode, setEditMode] = useState(false)\r\n\r\n  const clearLocalStraoge = () => {\r\n    if (localStorage.getItem('projMap')) {\r\n      localStorage.removeItem('projMap')\r\n    }\r\n    if (localStorage.getItem('deckGLviewState')) {\r\n      localStorage.removeItem('deckGLviewState')\r\n    }\r\n    window.location.reload()\r\n  }\r\n\r\n  useEffect(() => {\r\n    const onKeyDown = ({ key }) => {\r\n      if (key === ' ') {\r\n        setEditMode((editMode) => !editMode)\r\n        console.log(key, editMode)\r\n      }\r\n    }\r\n    document.addEventListener('keydown', onKeyDown)\r\n    return () => {\r\n      document.removeEventListener('keydown', onKeyDown)\r\n    }\r\n  }, [editMode])\r\n\r\n  return (\r\n    <>\r\n      {editMode && (\r\n        <div onClick={() => clearLocalStraoge()}>\r\n          <DeleteLocalStorage />\r\n        </div>\r\n      )}\r\n\r\n      <div\r\n        // ! this div's props are\r\n        // ! controling the projection z-index\r\n        // ! on top of the menus\r\n\r\n        style={{\r\n          height: '100%',\r\n          width: '100vw',\r\n          overflow: 'hidden',\r\n          position: 'fixed',\r\n          top: 0,\r\n          left: 0,\r\n          zIndex: 1000,\r\n        }}\r\n      >\r\n        <div>\r\n          <Keystoner\r\n            style={{\r\n              height: '100vh',\r\n              width: '100vw',\r\n            }}\r\n            isEditMode={editMode}\r\n          >\r\n            <PrjDeckGLMap />\r\n          </Keystoner>\r\n        </div>\r\n      </div>\r\n    </>\r\n  )\r\n}\r\n","import { useEffect, useState } from 'react'\r\nimport axios from 'axios'\r\nimport settings from '../settings/settings.json'\r\nimport { Button } from '@material-ui/core/'\r\nimport { makeStyles } from '@material-ui/core/styles'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    '& > *': {\r\n      margin: theme.spacing(1),\r\n    },\r\n  },\r\n}))\r\nexport default function TableNameInput({ setSelectedTable }) {\r\n  const classes = useStyles()\r\n  const [tableList, setTableList] = useState()\r\n\r\n  useEffect(() => {\r\n    /**\r\n     * Gets all tables on init\r\n     */\r\n    let buttonsArr = []\r\n    const cityIOlistURL = settings.cityIO.ListOfTables\r\n    const cityIOtableBaseUrl = settings.cityIO.baseURL\r\n\r\n    axios.get(cityIOlistURL).then((res) => {\r\n      res.data.forEach((tableName) => {\r\n        const geogridUrl = `${cityIOtableBaseUrl}${tableName}/GEOGRID/`\r\n        buttonsArr.push(\r\n          <Button\r\n            key={Math.random()}\r\n            variant=\"outlined\"\r\n            color=\"secondary\"\r\n            onClick={() => {\r\n              axios\r\n                .get(geogridUrl)\r\n                .then((res) => {\r\n                  if (res.status === 200) {\r\n                    setSelectedTable(tableName)\r\n                  }\r\n                })\r\n                .catch((err) => {\r\n                  console.log(err)\r\n                })\r\n            }}\r\n          >\r\n            {tableName}\r\n          </Button>,\r\n        )\r\n      })\r\n      setTableList(buttonsArr)\r\n    })\r\n  }, [setSelectedTable])\r\n\r\n  return <div className={classes.root}>{tableList}</div>\r\n}\r\n","import { useEffect } from 'react'\r\n\r\nimport { useDispatch } from 'react-redux'\r\nimport { setUIWebsocketData, setUIWebsocketReady } from '../../../redux/actions'\r\nimport settings from '../../../settings/settings.json'\r\n\r\n/*\r\nhttps://stackoverflow.com/questions/39728000/react-native-with-websocket-doesnt-work\r\n*/\r\n\r\nconst UIWebsocket = () => {\r\n  const dispatch = useDispatch()\r\n  useEffect(() => {\r\n    var socket = new WebSocket(settings.SOCKETS.URL)\r\n\r\n    socket.onopen = () => {\r\n      socket.send('CityScopeJS')\r\n      socket.onmessage = ({ data }) => {\r\n        dispatch(setUIWebsocketReady(true))\r\n        dispatch(setUIWebsocketData(JSON.parse(data)))\r\n      }\r\n    }\r\n  }, [dispatch])\r\n  return null\r\n}\r\n\r\nexport default UIWebsocket\r\n","import React, { useState } from 'react'\r\nimport { useSelector } from 'react-redux'\r\nimport CityIO from './CityIO/'\r\nimport Keystone from './Keystone'\r\nimport { Container, Typography, makeStyles, Box } from '@material-ui/core'\r\nimport TableNameInput from '../../Components/TableNameInput'\r\nimport Page from '../../layouts/Page'\r\nimport UIWebsocket from './UIWebsocket'\r\n\r\nexport default function CityScopeJS() {\r\n  // wait for 'ready' flag from cityIO when app is ready to start\r\n  const isCityIOready = useSelector((state) => state.READY)\r\n  const isSocketUIready = useSelector((state) => state.UI_WEBSOCKET_READY)\r\n\r\n  const useStyles = makeStyles((theme) => ({\r\n    root: {\r\n      '& > *': {\r\n        margin: 'auto',\r\n        height: '100%',\r\n        paddingBottom: theme.spacing(3),\r\n        paddingTop: theme.spacing(3),\r\n      },\r\n    },\r\n  }))\r\n\r\n  const [selectedTable, setSelectedTable] = useState(null)\r\n\r\n  const ListOfTables = () => {\r\n    return (\r\n      <Container maxWidth=\"md\">\r\n        <Typography color=\"textPrimary\" variant=\"h1\">\r\n          Projection tool\r\n        </Typography>\r\n        <Box mt={'3em'} />\r\n        <Typography color=\"textPrimary\">\r\n          This tool is used to project and display CityScopeJS tables in passive\r\n          mode, such as projectors, TVs, or other non-interactive displays.\r\n        </Typography>\r\n        <Box mt={'2em'} />\r\n        <Typography color=\"textPrimary\" variant=\"caption\">\r\n          start by selecting your CityScopeJS project. Press 'Spacebar' to\r\n          toggle keystone. Note: Not all CityScope projects below are ready for\r\n          CityScopeJS.\r\n        </Typography>\r\n        <Box mt={'2em'} />\r\n        <TableNameInput setSelectedTable={setSelectedTable} />\r\n      </Container>\r\n    )\r\n  }\r\n\r\n  const classes = useStyles()\r\n  return (\r\n    <>\r\n      <UIWebsocket />\r\n      <Page className={classes.root} title=\"Keystone\">\r\n        {!isCityIOready && <ListOfTables />}\r\n        {selectedTable && <CityIO tableName={selectedTable} />}\r\n\r\n        {isCityIOready && isSocketUIready && <Keystone />}\r\n      </Page>\r\n    </>\r\n  )\r\n}\r\n","import React from \"react\";\r\nimport { List, ListItem, Divider, Container, Box } from \"@material-ui/core\";\r\nimport Radar from \"./Radar\";\r\nimport BarChart from \"./BarChart\";\r\nimport AreaCalc from \"./AreaCalc\";\r\n\r\nfunction VisContainer(props) {\r\n    console.log('vo viscontainer');\r\n    return (\r\n        <>\r\n            {props.cityIOdata && (\r\n                <Container>\r\n                    <Box display=\"flex\" alignItems=\"center\" justifyContent=\"space-between\">\r\n                        <AreaCalc cityioData={props.cityIOdata} />\r\n                        <Radar cityioData={props.cityIOdata} />\r\n                    </Box>\r\n                    <Divider />\r\n                    <Box display=\"flex\" alignItems=\"center\" justifyContent=\"center\">\r\n                        <BarChart cityioData={props.cityIOdata} />\r\n                    </Box>\r\n                </Container>\r\n                // <List>\r\n                //     <ListItem style={{justifyContent: \"center\"}}>\r\n                //         <AreaCalc cityioData={props.cityIOdata} />\r\n                //     </ListItem>\r\n\r\n                //     <Divider />\r\n\r\n                //     <ListItem style={{justifyContent: \"center\"}}>\r\n                //         <Radar cityioData={props.cityIOdata} />\r\n                //     </ListItem>\r\n\r\n                //     <Divider />\r\n\r\n                //     <ListItem style={{justifyContent: \"center\"}}>\r\n                //         <BarChart cityioData={props.cityIOdata} />\r\n                //     </ListItem>\r\n                // </List>\r\n            )}\r\n        </>\r\n    );\r\n}\r\n\r\nexport default VisContainer;\r\n","import MenuContainer from './MenuContainer'\r\nimport MapContainer from './DeckglMap'\r\nimport LoadingSpinner from './CityIO/LoadingSpinner'\r\nimport VisContainer from './VisContainer/index_custom'\r\nimport {\r\n  makeStyles,\r\n  Grid,\r\n  Card,\r\n  CardContent,\r\n  Container,\r\n} from '@material-ui/core'\r\nimport Page from '../../layouts/Page'\r\n\r\nimport axios from \"axios\";\r\nimport { useEffect, useState } from \"react\";\r\nimport settings from \"../../settings/settings.json\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport { listenToMenuUI } from \"../../redux/actions\";\r\nimport ChooseScenario from \"./MenuContainer/ChooseScenario\"\r\n\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    margin: 'auto',\r\n    height: '100%',\r\n    paddingBottom: theme.spacing(3),\r\n    paddingTop: theme.spacing(3),\r\n  },\r\n}))\r\n\r\nconst getAPICall = async (URL) => {\r\n  try {\r\n    const response = await axios.get(URL);\r\n    return response.data;\r\n  } catch (err) {\r\n    console.log(err);\r\n  }\r\n};\r\n\r\nexport default function CSjsMainCustom(props) {\r\n  const classes = useStyles()\r\n  const tableName = props.tableName\r\n  const cityIOdata = props.cityIOdata\r\n  const onlyMap = props.onlyMap\r\n  const onlyOptionMenu = props.onlyOptionMenu\r\n  const onlyChartSidebar = props.onlyChartSidebar\r\n  const mapAndChartSidebar = props.mapAndChartSidebar\r\n\r\n  const menuState = useSelector((state) => state.MENU);\r\n  const loadedModules = Object.keys(cityIOdata);\r\n  const togglesMeta = settings.menu.toggles;\r\n\r\n  const dispatch = useDispatch();\r\n  let myMenuState = [...menuState];\r\n  const [chosenScenario, setChosenScenario] = useState(\"hcm_test_v1\");\r\n  let myChosenScenario = 'hcm_test_v1';\r\n\r\n  /* Listening View Option Change */\r\n  useEffect(() => {\r\n    const timer = setTimeout(listenChangingOption, 1000);\r\n    return () => clearTimeout(timer);\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  async function listenChangingOption() {\r\n    // recursively get hashes\r\n    const options = await getAPICall(`${process.env.REACT_APP_EXPRESS_PUBLIC_URL}/get-option`);\r\n    const scenarioObject = await getAPICall(`${process.env.REACT_APP_EXPRESS_PUBLIC_URL}/get-scenario`);\r\n    if (options) {\r\n      console.log(options);\r\n      let table = options.table;\r\n      let option = options.option;\r\n      let mode = options.mode;\r\n      if (table == tableName) {\r\n        if (option) {\r\n          let requireModule = togglesMeta[option].requireModule;\r\n          if (loadedModules.includes(requireModule) || requireModule === false) {\r\n            const i = myMenuState.indexOf(option);\r\n            if (mode == \"ON\") {\r\n              if (i === -1) {\r\n                myMenuState.push(option);\r\n              }\r\n            }\r\n            else {\r\n              if (i !== -1) {\r\n                myMenuState.splice(i, 1);\r\n              }\r\n            }\r\n            dispatch(listenToMenuUI(myMenuState));\r\n          }\r\n        }\r\n      }\r\n    }\r\n    if (scenarioObject) {\r\n      console.log(scenarioObject);\r\n      let scenario = scenarioObject.scenario;\r\n      if (scenario && scenario != myChosenScenario) {\r\n        console.log(111);\r\n        myChosenScenario = scenario;\r\n        setChosenScenario(scenario);\r\n      }\r\n    }\r\n    setTimeout(listenChangingOption, 1000);\r\n  }\r\n\r\n  /* END Listening */\r\n\r\n  return (\r\n    <Page className={classes.root} title=\"CitySCopeJS\">\r\n      <LoadingSpinner />\r\n      <Container maxWidth={null}>\r\n        <Grid container spacing={5}>\r\n          {onlyOptionMenu && <Grid item xs={12} l={12} md={12} xl={12} container>\r\n            <Grid item container direction=\"column\" spacing={2}>\r\n              <Grid item xs={12} l={12} md={12} xl={12}>\r\n                <Card\r\n                  elevation={15}\r\n                  style={{\r\n                    maxHeight: '90vh',\r\n                    overflow: 'auto',\r\n                  }}\r\n                >\r\n                  <CardContent>\r\n                    <MenuContainer tableName={tableName} />\r\n                  </CardContent>\r\n                </Card>\r\n              </Grid>\r\n            </Grid>\r\n          </Grid>}\r\n\r\n          {onlyMap && <Grid item xs={12} l={12} md={12} xl={12}>\r\n            <Card\r\n              elevation={15}\r\n              style={{\r\n                height: '90vh',\r\n                width: '100%',\r\n                position: 'relative',\r\n              }}\r\n            >\r\n              {/* <Test/> */}\r\n              <MapContainer onlyMap={true} />\r\n            </Card>\r\n          </Grid>}\r\n          {mapAndChartSidebar && <Grid item xs={6} l={6} md={6} xl={6}>\r\n            <Card\r\n              elevation={15}\r\n              style={{\r\n                maxHeight: '100%',\r\n                overflow: 'hidden',\r\n              }}\r\n            >\r\n              <VisContainer cityIOdata={cityIOdata} />\r\n            </Card>\r\n          </Grid>}\r\n          {mapAndChartSidebar && <Grid item xs={6} l={6} md={6} xl={6}>\r\n            <Card\r\n              elevation={15}\r\n              style={{\r\n                height: '90vh',\r\n                width: '100%',\r\n                overflow: 'hidden',\r\n                position: 'relative',\r\n              }}\r\n            >\r\n              {/* <Test/> */}\r\n              <iframe title=\"cityScience\" allowfullscreen=\"true\" width=\"100%\" height=\"100%\" frameborder=\"0\" scrolling=\"no\" marginheight=\"0\" marginwidth=\"0\" src=\"https://www.arcgis.com/apps/CEWebViewer/viewer.html?&3dWebScene=31d84c469a404bcbb13797d501286217&view=686441.41,11.16,-1189886.87,686778.3,2828.18,-1185381.71,0.95&lyr=1,1,1,1&wkid=32648&v=2\"></iframe>\r\n              {/* <MapContainer pitchMap={30} zoomMap={14} autoRotate={true}/> */}\r\n            </Card>\r\n          </Grid>}\r\n          {/* {onlyChartSidebar && <Grid item xs={12} l={12} md={12} xl={12}>\r\n            <Card\r\n              elevation={15}\r\n              style={{\r\n                maxHeight: '90vh',\r\n                overflow: 'auto',\r\n              }}\r\n            >\r\n              <VisContainer cityIOdata={cityIOdata} />\r\n            </Card>\r\n          </Grid>} */}\r\n          <Grid>\r\n            <ChooseScenario chosenScenario={chosenScenario} />\r\n          </Grid>\r\n        </Grid>\r\n      </Container>\r\n    </Page>\r\n  )\r\n}\r\n","import { useState, useEffect } from 'react'\r\nimport { useSelector } from 'react-redux'\r\nimport CityIO from './CityIO/cityIO'\r\nimport CityIOviewer from '../CityIOviewer'\r\nimport LoadingSpinner from './CityIO/LoadingSpinner'\r\n// import CSjsMain from './CSjsMain'\r\nimport CSjsMainCustom from './CSjsMainCustom'\r\n\r\nexport default function CityScopeJSMapCenter() {\r\n  // get the table name for cityIO comp\r\n  const [tableName, setTableName] = useState()\r\n  const [isDone, setIsdone] = useState(false)\r\n  // on init, get the adress URL\r\n  // to search for  a table\r\n  useEffect(() => {\r\n    let url = window.location.toString()\r\n    let pre = 'cityscope='\r\n    let cityscopePrjName = url.substring(url.indexOf(pre) + pre.length).toLowerCase()\r\n\r\n    \r\n    // check URL for proper CS project link\r\n    if (url.indexOf(pre) !== -1 && cityscopePrjName.length > 0) {\r\n      setTableName(cityscopePrjName)\r\n    } else {\r\n      /** if failed to get table name from\r\n       * url location, resote to the\r\n       * CityIO viewer\r\n       *\r\n       */\r\n      setIsdone(true)\r\n    }\r\n  }, [])\r\n\r\n  // wait for 'ready' flag from cityIO when app is ready to start\r\n  const isReady = useSelector((state) => state.READY)\r\n  const cityIOdata = useSelector((state) => state.CITYIO)\r\n\r\n  return (\r\n    <>\r\n      {tableName && <CityIO tableName={tableName} />}\r\n      {isReady && <CSjsMainCustom cityIOdata={cityIOdata} tableName={tableName} onlyMap={true} />}\r\n      {isDone && <CityIOviewer />}\r\n      <LoadingSpinner />\r\n    </>\r\n  )\r\n}\r\n","import { useState, useEffect } from 'react'\r\nimport { useSelector } from 'react-redux'\r\nimport CityIO from './CityIO/cityIO'\r\nimport CityIOviewer from '../CityIOviewer'\r\nimport LoadingSpinner from './CityIO/LoadingSpinner'\r\nimport CSjsMain from './CSjsMain'\r\nimport CSjsMainCustom from './CSjsMainCustom'\r\nimport MapContainer from './DeckglMap'\r\nimport {\r\n  makeStyles,\r\n  Grid,\r\n  Card,\r\n  CardContent,\r\n  Container,\r\n} from '@material-ui/core'\r\n\r\n\r\nexport default function CityScopeJSChartSidebar() {\r\n  // get the table name for cityIO comp\r\n  const [tableName, setTableName] = useState()\r\n  const [isDone, setIsdone] = useState(false)\r\n  // on init, get the adress URL\r\n  // to search for  a table\r\n  useEffect(() => {\r\n    let url = window.location.toString()\r\n    console.log(url);\r\n    let pre = 'cityscope='\r\n    let cityscopePrjName = url.substring(url.indexOf(pre) + pre.length).toLowerCase()\r\n\r\n\r\n    // check URL for proper CS project link\r\n    if (url.indexOf(pre) !== -1 && cityscopePrjName.length > 0) {\r\n      setTableName(cityscopePrjName)\r\n    } else {\r\n      /** if failed to get table name from\r\n       * url location, resote to the\r\n       * CityIO viewer\r\n       *\r\n       */\r\n      setIsdone(true)\r\n    }\r\n  }, [])\r\n\r\n  // wait for 'ready' flag from cityIO when app is ready to start\r\n  const isReady = useSelector((state) => state.READY)\r\n  const cityIOdata = useSelector((state) => state.CITYIO)\r\n\r\n  return (\r\n    <>\r\n      {tableName && <CityIO tableName={tableName} />}\r\n      {isReady && <CSjsMainCustom cityIOdata={cityIOdata} tableName={tableName} mapAndChartSidebar={true} />}\r\n      {isDone && <CityIOviewer />}\r\n      <LoadingSpinner />\r\n    </>\r\n  )\r\n}\r\n","import { useState, useEffect } from 'react'\r\nimport { useSelector } from 'react-redux'\r\nimport CityIO from './CityIO/cityIO'\r\nimport CityIOviewer from '../CityIOviewer'\r\nimport LoadingSpinner from './CityIO/LoadingSpinner'\r\nimport CSjsMain from './CSjsMain'\r\nimport CSjsMainCustom from './CSjsMainCustom'\r\n\r\nexport default function CityScopeJSOptionsMenu() {\r\n  // get the table name for cityIO comp\r\n  const [tableName, setTableName] = useState()\r\n  const [isDone, setIsdone] = useState(false)\r\n  // on init, get the adress URL\r\n  // to search for  a table\r\n  useEffect(() => {\r\n    let url = window.location.toString()\r\n    let pre = 'cityscope='\r\n    let cityscopePrjName = url.substring(url.indexOf(pre) + pre.length).toLowerCase()\r\n\r\n    \r\n    // check URL for proper CS project link\r\n    if (url.indexOf(pre) !== -1 && cityscopePrjName.length > 0) {\r\n      setTableName(cityscopePrjName)\r\n    } else {\r\n      /** if failed to get table name from\r\n       * url location, resote to the\r\n       * CityIO viewer\r\n       *\r\n       */\r\n      setIsdone(true)\r\n    }\r\n  }, [])\r\n\r\n  // wait for 'ready' flag from cityIO when app is ready to start\r\n  const isReady = useSelector((state) => state.READY)\r\n  const cityIOdata = useSelector((state) => state.CITYIO)\r\n\r\n  return (\r\n    <>\r\n      {tableName && <CityIO tableName={tableName} />}\r\n      {isReady && <CSjsMainCustom cityIOdata={cityIOdata} tableName={tableName} onlyOptionMenu={true}/>}\r\n      {isDone && <CityIOviewer />}\r\n      <LoadingSpinner />\r\n    </>\r\n  )\r\n}\r\n","import { Navigate } from 'react-router-dom'\r\nimport MainLayout from './layouts/MainLayout'\r\nimport NotFoundView from './views/Errors/NotFoundView'\r\nimport GridEditor from './views/GridEditor'\r\nimport CityScopeJS from './views/CityScopeJS'\r\nimport ProjectionMapping from './views/ProjectionMapping'\r\nimport CityScopeJSMapCenter from './views/CityScopeJS/indexMapCenter'\r\nimport CityScopeJSChartSidebar from './views/CityScopeJS/indexChartSidebar'\r\nimport CityScopeJSOptionsMenu from './views/CityScopeJS/indexOptionsMenu'\r\n\r\nconst routes = [\r\n  {\r\n    path: '/',\r\n    element: <MainLayout />,\r\n    children: [\r\n      { path: '/', element: <CityScopeJS /> },\r\n      { path: '/onlyMap', element: <CityScopeJSMapCenter /> },\r\n      { path: '/onlyChartSidebar', element: <CityScopeJSChartSidebar /> },\r\n      { path: '/onlyOptionsMenu', element: <CityScopeJSOptionsMenu /> },\r\n      { path: '/editor/', element: <GridEditor /> },\r\n      { path: '/projection', element: <ProjectionMapping /> },\r\n      { path: '/cityioviewer', element: <Navigate to=\"/\" /> },\r\n\r\n      { path: '*', element: <Navigate to=\"/404\" /> },\r\n      { path: '404', element: <NotFoundView /> },\r\n    ],\r\n  },\r\n  // { path: '/onlyMap', element: <CityScopeJSMapCenter /> },\r\n]\r\n\r\nexport default routes\r\n","import React from \"react\";\r\nimport { useRoutes } from \"react-router-dom\";\r\nimport { ThemeProvider } from \"@material-ui/core\";\r\nimport GlobalStyles from \"./theme/GlobalStyles\";\r\nimport theme from \"./theme\";\r\nimport routes from \"./routes\";\r\n\r\nconst App = () => {\r\n    const routing = useRoutes(routes);\r\n    return (\r\n        <ThemeProvider theme={theme}>\r\n            <GlobalStyles />\r\n            {routing}\r\n        </ThemeProvider>\r\n    );\r\n};\r\n\r\nexport default App;\r\n","import React from \"react\";\r\nimport { Provider } from \"react-redux\";\r\n\r\nconst ProviderWrapper = ({ children, store }) => (\r\n    <Provider store={store}>{children}</Provider>\r\n);\r\n\r\nexport default ProviderWrapper;\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport { HashRouter, BrowserRouter } from \"react-router-dom\";\r\n\r\nimport App from \"./App\";\r\nimport Provider from \"./redux/Provider\";\r\nimport store from \"./redux/store\";\r\n// console.log(require('./Express/index'));\r\n\r\n// console.log(require('express'));\r\n\r\n// ! basename={process.env.PUBLIC_URL}\r\n\r\nReactDOM.render(\r\n    <Provider store={store}>\r\n        {/* https://github.com/facebook/create-react-app/issues/1765 */}\r\n        <BrowserRouter basename={process.env.PUBLIC_URL}>\r\n            <App />\r\n        </BrowserRouter>\r\n    </Provider>,\r\n    document.getElementById(\"root\")\r\n);\r\n"],"sourceRoot":""}